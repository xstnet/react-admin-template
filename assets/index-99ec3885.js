import{j as Le,r as i,C as Ye,z as bt,t as E,u as kt,d as vt,a as J,m as _,b as H,c as q,R as Y,e as T,T as N,F as f,I as M,f as qe,B as S,S as Ae,n as We,g as A,h as Ct,i as G,k as ee,L as O,G as xt,l as St,o as It,p as Tt,q as Mt,s as Je,v as ne,A as $e,U as Ge,w as Qe,D as ie,x as ce,P as Pt,y as Nt,E as Lt,H as At,J as X,K as se,M as $t,N as wt,O as Ft,Q as we,V as Ut,W as ae,X as Xe,Y as V,Z as W,_ as Ze,$ as de,a0 as j,a1 as Fe,a2 as ue,a3 as Ue,a4 as et,a5 as Ot,a6 as Rt,a7 as Dt,a8 as Bt,a9 as tt,aa as Kt,ab as pe,ac as Se,ad as _t,ae as Ht,af as zt,ag as nt,ah as Et,ai as Re,aj as Ie,ak as rt,al as jt,am as Vt,an as at,ao as Yt,ap as ot,aq as lt,ar as qt,as as Wt,at as Jt,au as Gt,av as Qt,aw as De,ax as P,ay as te,az as Be,aA as Xt,aB as Zt}from"./vendor-d6df2b13.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();const R=Le.Fragment,e=Le.jsx,u=Le.jsxs,Ke=[{label:"控制台",type:"group",children:[{label:"控制台",icon:"icon-dashboard",path:"/dashboard"}]},{label:"示例页面",type:"group",children:[{label:"列表页",icon:"icon-list",path:"/example/userList"},{label:"多级菜单",icon:"icon-list",path:"/multilevel/menu",children:[{label:"二级菜单",icon:"icon-list",path:"/multilevel/menu/2",children:[{label:"三级菜单",icon:"icon-list",path:"/multilevel/menu/2/3"}]}]},{label:"空白页",icon:"icon-example",path:"/blank"},{label:"404",icon:"icon-example",path:"/404"}]},{label:"徽标示例",type:"group",children:[{label:"红点徽标",icon:"icon-list",badge:"dot",path:"/blank"},{label:"数字徽标",icon:"icon-example",badge:98,path:"/blank"}]},{type:"divider"},{path:"/article",label:"文章管理",icon:"icon-article",children:[{path:"/article/list",label:"文章列表",icon:"icon-article"},{path:"/article/create",label:"发布文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/update",label:"更新文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/category",label:"分类管理",icon:"icon-list"}]},{path:"/iframe",label:"外部页面",icon:"icon-href",children:[{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(外链)",icon:"icon-document",key:"webpage-antd-document",type:"url"},{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(内嵌)",icon:"icon-document",type:"iframe"},{path:"https://www.xstnet.com",label:"博客主页(内嵌)",icon:"icon-document",type:"iframe"}]},{path:"/document",label:"文档",icon:"icon-document",children:[{path:"/document/start",label:"开始使用",icon:"icon-document"},{path:"/document/package.json",label:"Package文件说明",icon:"icon-document"}]},{type:"divider"},{path:"/user/center",label:"个人中心",icon:"icon-user-permissions",children:[{path:"/user/center/index",label:"个人中心",icon:"icon-example"},{path:"/user/center/update",label:"修改信息",icon:"icon-document"}]}];function be(t){return!!(typeof t.children>"u"||Array.isArray(t.children)&&t.children.length===0)}function Z(t){return oe(t)?!1:!!(typeof t.children<"u"&&Array.isArray(t.children)&&t.children.length>0)}function me(t){return typeof t.path=="string"&&typeof t.label=="string"}function oe(t){return typeof t.type<"u"&&t.type==="group"}function st(t){return typeof t.type<"u"&&t.type==="divider"}const en=void 0,B=i.createContext(en),tn=({children:t})=>{let n=0;const r=i.useMemo(()=>Ke,[Ke]),[a,s]=i.useState(r),[l,m]=i.useState(!1),{mapPathToMenu:o,mapKeyToMenu:d,processedMenuList:c}=i.useMemo(()=>(()=>{const C=new Map,y=new Map,g=I=>(I.key||(I.key=String(++n)),{...I}),v=I=>I.map(h=>{const k=g(h);return(Z(k)||oe(k))&&(k.children=v(k.children||[])),me(k)&&y.set(k.path,k),k!=null&&k.key&&C.set(k.key,k),k});return{processedMenuList:v(a),mapKeyToMenu:C,mapPathToMenu:y}})(),[a]),p=i.useMemo(()=>({menuList:c,setMenuList:s,menuCollapsed:l,setMenuCollapsed:m,mapPathToMenu:o,mapKeyToMenu:d}),[a,l]);return e(B.Provider,{value:p,children:t})},D={pageTitle:"后台管理系统模板",pageTitlePrefix:"后台管理",tokenKey:"Authorization",apiBaseUrl:"https://xstnet.github.io/react-admin-template/api",iconFontUrl:"//at.alicdn.com/t/c/font_3917407_68ll5mr3jkf.js"};function nn(t,n){localStorage.setItem(t,typeof n=="object"?JSON.stringify(n):n)}function rn(t){localStorage.setItem(D.tokenKey,typeof t=="object"?JSON.stringify(t):t)}function it(t){return localStorage.getItem(t)}function an(t){const n=localStorage.getItem(t);if(n!==null)return Number(n)}function on(t){const n=localStorage.getItem(t);if(n!==null)return n==="true"}function ln(t){const n=localStorage.getItem(t);if(n!==null)return JSON.parse(n)}function sn(t){return it(t)!==null}function cn(t){localStorage.removeItem(t)}function dn(){localStorage.removeItem(D.tokenKey)}function un(){localStorage.clear()}const $={set:nn,setToken:rn,has:sn,getString:it,getObject:ln,getBoolean:on,getNumber:an,remove:cn,removeToken:dn,clear:un},ct=()=>{const[t,n]=i.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);return i.useEffect(()=>{const a=s=>{console.log("chage",s.matches),s.matches?n(!0):n(!1)};return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",a)}},[]),[t?"dark":"light"]},mn=void 0,hn=i.createContext(mn),pn=({children:t})=>{const{settings:{primaryColor:n,theme:r,compactMode:a,followSystemTheme:s}}=i.useContext(Q),[l]=ct(),m={},o=()=>{const d=[];return s?d.push(l==="light"?E.defaultAlgorithm:E.darkAlgorithm):d.push(r==="light"?E.defaultAlgorithm:E.darkAlgorithm),console.log("algorighm",r,d),a&&d.push(E.compactAlgorithm),d};return e(hn.Provider,{value:m,children:e(Ye,{locale:bt,theme:{algorithm:o(),token:{colorPrimary:n},components:{Button:{borderRadius:4,borderRadiusSM:2},Modal:{borderRadius:4,borderRadiusOuter:2}}},children:t})})},gn=void 0,Q=i.createContext(gn),fn=({children:t})=>{const n=i.useMemo(()=>{const m=$.getObject("settings")||{};return console.log("settingsCache",m),{theme:"light",compactMode:!1,followSystemTheme:!1,fixedHeader:!0,fixedMenu:!0,showFooter:!0,multitabMode:!1,primaryColor:"#00b96b",...m}},[]),[r,a]=i.useState(n),s=i.useCallback(m=>{const o={...r,...m};a(o),$.set("settings",o)},[r]),l={settings:r,setSetting:s};return e(Q.Provider,{value:l,children:e(pn,{children:t})})},yn=void 0,ke=i.createContext(yn),bn=({children:t})=>{const[n,r]=i.useState(!1),[a,{toggleFullscreen:s}]=kt(document.body),[l,m]=i.useState(null),o=i.useMemo(()=>({isLogin:n,setIsLogin:r,userInfo:l,setUserInfo:m,fullScreen:a,setFullScreen:s}),[n,l,a]);return e(ke.Provider,{value:o,children:e(fn,{children:e(tn,{children:t})})})};function kn(t){const n=t.split(".")[1];if(n)try{return JSON.parse(vt(n))}catch(r){console.warn("Parse Token Error: ",r);return}}function Te(){var r;const t=$.getString(D.tokenKey);if(!t)return!1;const n=kn(t);return n!==void 0&&((r=n==null?void 0:n.data)==null?void 0:r.uid)>0&&n.exp>new Date().getTime()/1e3}var Me=(t=>(t[t.success=0]="success",t[t.noLogin=-10001]="noLogin",t[t.loginExpired=-10002]="loginExpired",t))(Me||{}),dt=(t=>(t[t.male=1]="male",t[t.female=2]="female",t))(dt||{}),z=(t=>(t[t.incomplete=1]="incomplete",t[t.completed=2]="completed",t[t.deleted=10]="deleted",t))(z||{}),Oe=(t=>(t.day="YYYY-MM-DD",t.second="YYYY-MM-DD HH:mm:ss",t.minute="YYYY-MM-DD HH:mm",t.hour="YYYY-MM-DD HH",t))(Oe||{});function ut(){}function re(t,n){return Math.floor(Math.random()*(n-t+1))+t}const vn=10*1e3;J.defaults.baseURL=D.apiBaseUrl;J.defaults.headers.post["Content-Type"]="application/json; charset=utf-8";J.defaults.timeout=vn;J.interceptors.request.use(t=>(console.group(`${t.method}${t.url}${JSON.stringify(t.params)}`),t.headers.Authorization=`Bearer ${$.getString(D.tokenKey)}`,t),t=>Promise.reject(t));J.interceptors.response.use(t=>{const n=t.data;return typeof n.code!="number"?(_.error("系统错误",2),console.warn("api调用失败, 未正常返回数据, url:",t.config.url,"data:",n,"response:",t),console.groupEnd(),Promise.reject(t)):(console.log("Request log: ",t.config.url,t.data,t),console.groupEnd(),n.code===0?(t.config.method==="post"&&_.success(t.data.message),t):n.code===Me.noLogin?(_.error("您还没有登录, 即将跳转到登录页面, 请稍后..."),$.remove(D.tokenKey),location.reload(),Promise.reject(n)):n.code===Me.loginExpired?(_.error("登录已失效, 即将跳转到登录页面..."),$.remove(D.tokenKey),location.reload(),Promise.reject(n)):(_.error(n.message),Promise.reject(t)))},t=>(typeof t.message=="string"&&t.message==="Network Error"?_.error("网络错误, 请稍后再试!"):_.error("请求失败, 请稍后再试"),console.log("Request error",t),console.groupEnd(),Promise.reject(t)));const Cn=(t,n,r)=>{const a=r||{};return a.params=n,J.get(t,a)},xn=(t,n,r)=>J.post(t,n,r),Sn=t=>J.request(t),F={get:Cn,post:xn,request:Sn},U=t=>t.then(n=>Promise.resolve(n.data.data)).catch(n=>Promise.reject(n)),In=t=>{const n=F.post("/login",t);return U(n)},Tn=t=>U(F.get("/user/info",t)),Mn=t=>U(F.post("/user/logout",t)),Pn=(t,n)=>U(F.get("/user/list",{...t,...n})),Nn=t=>U(F.post("/user/create",t)),Ln=t=>U(F.post("/user/update",t)),An=t=>U(F.post("/user/delete",t)),$n=(t,n)=>U(F.get("/article/list",{...t,...n})),wn=t=>U(F.get("/article/detail",t)),Fn=t=>U(F.post("/article/create",t)),Un=t=>U(F.post("/article/update",t)),On=t=>U(F.post("/article/delete",t));const Rn=()=>{const t=H(),{loading:n,run:r}=q(In,{manual:!0,debounceWait:300,onSuccess:l=>{$.setToken(l.token),t("/dashboard")}});document.title=D.pageTitle;const a=l=>{r(l)};i.useEffect(()=>{Te()&&t("/dashboard")},[]);const s={remember:!0,username:"admin",password:"123456"};return e(R,{children:u(Ye,{theme:{algorithm:[E.defaultAlgorithm]},children:[e("div",{className:"bg-wrap"}),u(Y,{className:"login-wrap",children:[e(T,{span:15,className:"login-banner"}),u(T,{span:9,className:"login-form-wrap",children:[e(N.Title,{style:{textAlign:"center"},children:"后台管理系统"}),e("br",{}),u(f,{name:"loginForm",labelCol:{span:5},wrapperCol:{span:19},style:{maxWidth:600},initialValues:s,onFinish:a,autoComplete:"off",children:[e(f.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名!"}],children:e(M,{placeholder:"admin"})}),e(f.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码!"}],children:e(M.Password,{placeholder:"123456"})}),e(f.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:5},children:e(qe,{children:"记住我"})}),e(f.Item,{wrapperCol:{offset:5,span:16},children:e(S,{loading:n,type:"primary",htmlType:"submit",children:"登录"})})]})]})]})]})})};const Dn=({loading:t,title:n})=>{const{settings:{theme:r}}=i.useContext(Q);return e(Ae,{size:"large",spinning:t,tip:n,wrapperClassName:`page-loading-spin-${r}`,children:e("div",{style:{height:"100vh",width:"100vw"}})})};const Bn=()=>{const[t,n]=We.useNotification(),r=$.getBoolean("dontShowCompactModeNotify"),{setSetting:a,settings:{compactMode:s}}=i.useContext(Q),l=()=>{const m=`open${Date.now()}`,o=u(A,{children:[e(S,{type:"link",size:"small",onClick:()=>t.destroy(),children:"不再提示"}),e(S,{type:"primary",size:"small",onClick:()=>{a({compactMode:!0}),t.destroy(m)},children:"开启"})]});t.info({message:"开启紧凑布局模式",description:"检测到您的屏幕尺寸过小, 是否开启紧凑布局模式? 或者您也可以选择在设置中手动开启",btn:o,key:m,onClose:()=>$.set("dontShowCompactModeNotify",!0)})};return i.useEffect(()=>{!r&&!s&&window.innerWidth<=1440&&l()},[]),n},Kn=void 0,ve=i.createContext(Kn),_n=({children:t})=>{const[n,r]=i.useState([]),[a,s]=i.useState(""),l=i.useMemo(()=>Ct(),[]),m=i.useCallback(()=>{console.log("getabactions");const c=y=>{y&&s(y)},p=y=>n.findIndex(g=>g.key===y)>-1;return{openTab:c,addTab:(y,g=!0)=>{console.log("ddddddddd",n),p(y.key)||r(v=>[...v,{...y}]),g&&a!==y.key&&c(y.key)},removeTab:()=>{},hasTab:p}},[n]),o=i.useMemo(()=>m(),[m]),d=i.useMemo(()=>({tabs:n,setTabs:r,activeTab:a,event:l,...o}),[n,a]);return e(ve.Provider,{value:d,children:t})};const Hn=({children:t})=>{console.log("Content render..."),console.log("childdddddddd",t);const n=ee(),{addTab:r,activeTab:a,hasTab:s,openTab:l}=i.useContext(ve),{mapPathToMenu:m}=i.useContext(B),{pathname:o}=n,d=()=>{console.log("handleAddTab");const c=m.get(o);if(!(!c||!c.path)){if(s(c.key)&&a!==c.key){l(c.key);return}r({label:c.label,key:c.key,children:t})}};return i.useEffect(()=>(console.log("locationxxxxx"),d(),()=>{console.log("content destory")}),[n]),null},zn=G.memo(Hn),mt=()=>{const{settings:{showFooter:t}}=i.useContext(Q),{Text:n,Link:r}=N;return t?u(O.Footer,{style:{textAlign:"center",paddingBottom:4},children:[u(n,{type:"secondary",children:["React Admin Template",e(r,{href:"https://github.com/xstnet/react-admin-template",target:"_blank",style:{color:"inherit",marginLeft:5},children:e(xt,{})})]}),e("br",{}),e(r,{href:"https://github.com/xstnet",target:"_blank",children:e(n,{type:"secondary",children:"醉丶春风"})}),u(n,{type:"secondary",children:["©2023 Created by",e(r,{target:"_blank",href:"https://ant-design.antgroup.com/index-cn",style:{margin:"0 6px",color:"inherit"},children:"Ant Design"}),"V5"]})]}):null};const w=St({scriptUrl:D.iconFontUrl,extraCommonProps:{}}),En=()=>{const{fullScreen:t,setFullScreen:n}=i.useContext(ke),r=()=>{_.success(t?"已退出全屏模式":"进入全屏模式"),n(!t)};return t?e(It,{title:"退出全屏模式",className:"action-icon",onClick:r}):e(Tt,{title:"进入全屏模式",className:"action-icon",onClick:r})},jn=()=>e(N.Link,{className:"action-icon",target:"_blank",style:{color:"inherit"},href:"https://github.com/xstnet/react-admin-template",children:e(Mt,{})}),Vn=[[2,1,"刚刚"],[60,1,"%d秒前"],[3600,60,"%d分钟前"],[86400,3600,"%d小时前"],[86400*30,3600*24,"%d天前"],[86400*30*12,3600*24*30,"%d月前"],[1/0,3600*24*30*12,"%d年前"]],Yn=[[-60,1,"%d秒后"],[-3600,60,"%d分钟后"],[-86400,3600,"%d小时后"],[-(86400*30),3600*24,"%d天后"],[-(86400*30*12),3600*24*30,"%d月后"],[-1/0,3600*24*30*12,"%d年后"]],ht=({time:t,...n})=>{const r=Math.floor(new Date().getTime()/1e3),a=Math.floor(new Date(t).getTime()/1e3),s=r-a;if(isNaN(a))return e(R,{children:"time"});const l=s<-1?Yn:Vn;let m="";for(const[o,d,c]of l)if(Math.abs(s)<Math.abs(o)){const p=Math.floor(Math.abs(s)/d);m=c.replace("%d",String(p));break}return e(Je,{title:t,children:e("span",{...n,children:m})})},qn=()=>e(ne,{size:"small",itemLayout:"horizontal",dataSource:[{title:"张三 评论了你",desc:"评论内容评论内容评论内容",createTime:"2023-04-06 15:39:00"},{title:"您有3个订单待支付",desc:"订单1,订单2,订单3",createTime:"2023-04-05 15:39:00"},{title:"张三 的请假申请需要您的审批",desc:"",createTime:"2023-04-01 12:08:00"},{title:"本周周报待填写",createTime:"2023-03-02 10:55:00",desc:"说明"}],renderItem:n=>e(ne.Item,{children:e(ne.Item.Meta,{avatar:e($e,{size:48,icon:e(Ge,{})}),title:e("a",{href:"https://ant.design",children:n.title}),description:u("div",{children:[n.desc,n.desc&&e("br",{}),e(N.Text,{children:e(ht,{style:{fontSize:12},time:n.createTime})})]})})})}),Wn=()=>e(ne,{size:"small",itemLayout:"horizontal",dataSource:[{title:"您有一封新的邮件",type:"mail"},{title:"您有3个订单待支付",type:"payment"},{title:"张三 的请假申请需要您的审批",type:"workflow"},{title:"本周周报待填写",type:"common"}],renderItem:n=>e(ne.Item,{children:e(ne.Item.Meta,{avatar:e(w,{style:{fontSize:30},type:`icon-${n.type}`}),title:e("a",{href:"https://ant.design",children:n.title}),description:"3天前"})})}),Jn=()=>u(R,{children:[e(Qe,{centered:!0,style:{width:300},defaultActiveKey:"notify",items:[{key:"notify",label:"通知(3)",children:e(Wn,{})},{key:"message",label:"消息(4)",children:e(qn,{})}],onChange:void 0,tabBarExtraContent:e(S,{type:"link",style:{marginRight:10},children:"清空"})}),e(ie,{style:{margin:"8px 0"}}),u(A,{split:e(ie,{type:"vertical"}),style:{width:"100%",justifyContent:"center",marginBottom:0},children:[e(S,{type:"link",children:"全部已读"}),e(S,{type:"link",children:"查看更多"})]})]}),Gn=t=>e(ce,{count:98,children:e(Pt,{arrow:!1,content:e(Jn,{}),placement:"bottomRight",trigger:"click",children:e(w,{title:"通知提醒",type:"icon-notify",className:"action-icon"})})}),Qn=()=>e(w,{title:"搜索",type:"icon-search",className:"action-icon"}),Xn=()=>{const{settings:{theme:t},setSetting:n}=i.useContext(Q),r=()=>{n({followSystemTheme:!1,theme:t==="light"?"dark":"light"})};return t==="dark"?e(w,{onClick:r,title:"主题-深色模式",type:"icon-theme-dark",className:"action-icon"}):e(w,{onClick:r,title:"主题-明亮模式",type:"icon-theme-light",className:"action-icon"})};const Zn=t=>{const n=["#1890ff","#722ed1","#eb2f96","#00b96b","#52c41a","#13c2c2","#1677ff","#f5222d","#fa8c16","#faad14"],{onChange:r,presetColors:a=n,defaultSelectedColor:s=""}=t,{value:l=s}=t,[m,o]=i.useState(l),d=c=>{o(c),r==null||r(c)};return e("div",{className:"theme-color-wrap",children:a.map(c=>e("div",{onClick:()=>d(c),className:"theme-color-item",style:{backgroundColor:c},title:c,children:m===c&&e(Nt,{className:"checked-icon"})},c))})},er=t=>{const{open:n,onClose:r=ut}=t,{settings:a,setSetting:s}=i.useContext(Q),[l]=f.useForm(),[m]=ct(),o=i.useMemo(()=>({...a,theme:a.followSystemTheme?"followSystem":a.theme}),[a]),d=(c,p)=>{const b={...c},{theme:C,fixedMenu:y,fixedHeader:g}=b;C&&(console.log("themeee",C),b.followSystemTheme=!1,C==="followSystem"&&(b.followSystemTheme=!0,b.theme=m)),y&&(b.fixedHeader=!0),g===!1&&(b.fixedMenu=!1),s(b),console.log("chage",c,p)};return Lt(()=>{l==null||l.setFieldsValue(o)},[o]),e(At,{title:"偏好设置",onClose:r,open:n,children:u(f,{name:"basic",labelCol:{span:5},wrapperCol:{span:19},initialValues:{...o},autoComplete:"off",onValuesChange:d,form:l,children:[e(f.Item,{label:"外观",name:"theme",children:u(X.Group,{buttonStyle:"solid",children:[u(X.Button,{value:"light",children:[e(w,{type:"icon-theme-light"})," 浅色"]}),u(X.Button,{value:"dark",children:[e(w,{type:"icon-theme-dark"})," 深色"]}),u(X.Button,{value:"followSystem",children:[e(w,{type:"icon-followSystem"})," 跟随系统"]})]})}),e(f.Item,{label:"紧凑模式",valuePropName:"checked",name:"compactMode",children:e(se,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(f.Item,{label:"主题色",name:"primaryColor",children:e(Zn,{defaultSelectedColor:a.primaryColor})}),e(ie,{children:"布局"}),e(f.Item,{help:"功能正在开发中",label:"多标签页",valuePropName:"checked",name:"multitabMode",children:e(se,{checkedChildren:"启用",unCheckedChildren:"关闭"})}),e(f.Item,{label:"固定头部",valuePropName:"checked",name:"fixedHeader",children:e(se,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(f.Item,{help:"固定菜单启用时, 头部也会同步固定",label:"固定菜单",valuePropName:"checked",name:"fixedMenu",children:e(se,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(f.Item,{valuePropName:"checked",label:"显示底部",name:"showFooter",children:e(se,{checkedChildren:"开启",unCheckedChildren:"关闭"})})]})})},tr=t=>{const[n,r]=i.useState(!1);return u("div",{children:[e(er,{open:n,onClose:()=>{r(!1)}}),e(w,{onClick:()=>{r(!0)},title:"设置",type:"icon-setting",className:"action-icon"})]})},nr=()=>{const{userInfo:t,setUserInfo:n,setIsLogin:r}=i.useContext(ke),{menuCollapsed:a,setMenuCollapsed:s}=i.useContext(B),{token:{colorBgContainer:l}}=E.useToken(),m=H(),o=()=>u("div",{className:"left",children:[u("div",{className:"logo",children:[e(w,{type:"icon-react",className:"logo-img"}),e("span",{className:"logo-text",children:"React Admin Template"})]}),e("div",{children:G.createElement(a?$t:wt,{onClick:()=>s(!a)})})]}),d=()=>{const c=()=>u(R,{children:[e(Qn,{}),e(Gn,{}),e(En,{}),e(jn,{}),e(Xn,{}),e(tr,{})]}),p=[{label:e("a",{children:"个人中心"}),icon:e(Ge,{}),key:"userCenter"},{label:e("a",{children:"修改资料"}),key:"update",icon:e(we,{})},{type:"divider"},{label:"退出",icon:e(Ut,{}),key:"logout",onClick:()=>{Mn().then(()=>{$.removeToken(),r(!1),n(null),m("/login")})}}];return e("div",{className:"right",children:u(A,{size:"middle",children:[c(),e(Ft,{menu:{items:p},children:u(A,{className:"pointer",children:[e("span",{children:t==null?void 0:t.nickname}),e($e,{src:t==null?void 0:t.avatar})]})})]})})};return e(O.Header,{className:"header",style:{background:l},children:u(R,{children:[o(),d()]})})},pt=G.memo(nr),Ce="/iframe",xe=t=>`${Ce}?url=${t}`,rr=()=>{var C;const t=H(),n=ee(),{menuList:r,mapKeyToMenu:a,mapPathToMenu:s}=i.useContext(B);let l=((C=s.get("/dashboard"))==null?void 0:C.key)||"",m=[],o=!1;const{pathname:d}=n,[c]=ae();i.useContext(ve);const p=y=>{const g=a.get(y.key);if(console.log("clicked menu",y,g),!g){console.warn("未获取到菜单信息");return}if((g==null?void 0:g.type)==="url"){window.open(g.path,"_blank");return}if(document.title=`${D.pageTitlePrefix} - ${g.label}`,(g==null?void 0:g.type)==="iframe"){console.log("打开iframe页面"),t(xe(g.path));return}t(g.path)},b=i.useMemo(()=>{const y=v=>v.badge?v.badge==="dot"?e(ce,{className:"menu-item-badge",offset:[6,0],dot:!0,children:v.label}):e(ce,{className:"menu-item-badge",offset:[15,0],count:v.badge,children:v.label}):v.label,g=(v,x)=>{const I=[];return!o&&x&&m.push(x.key),v.map(h=>{var le;if(me(h)&&(h.parent&&d.indexOf(h.path)===0&&(l=((le=s.get(h.parent))==null?void 0:le.key)||"",o=!0),h.type==="iframe"&&(c.get("url")||"")===h.path&&(o=!0,l=h.key),h.hideInMenu))return;let k;if(st(h))k={...h};else if(oe(h))k={...h},h.children&&h.children.length>0&&(k.children=g(h.children));else if(Z(h)||be(h)){let{icon:L}=h;typeof L=="string"&&L.includes("icon-")&&(L=e(w,{type:L})),k={key:"",...h,icon:L,label:y(h),children:Z(h)?g(h.children,h):void 0},!o&&h.path===d&&(l=h.key,o=!0)}k&&(k.key=k.key,I.push(k))}),!o&&m.pop(),I};return g(r)},[r]);return e(Xe,{style:{height:"100%"},onClick:p,mode:"inline",defaultSelectedKeys:[l],items:b,defaultOpenKeys:m})},ar=G.memo(rr),he=()=>{const{token:t}=E.useToken();return t},or=()=>{const{menuCollapsed:t}=i.useContext(B),{colorBgContainer:n}=he();return e(O.Sider,{style:{background:n},trigger:null,className:"left-sider",collapsible:!0,collapsed:t,children:e(ar,{})})};const fe=new Map,Pe=t=>{t.map(n=>{me(n)&&(n==null?void 0:n.type)==="url"||(oe(n)&&Pe(n.children||[]),(Z(n)||be(n))&&(n.path&&fe.set(n.path,n.label),n.children&&Pe(n.children||[])))})},lr=()=>{const{menuList:t}=i.useContext(B),n=i.useMemo(()=>(fe.clear(),Pe(t),fe),[t]),r=ee(),[a]=ae(),s=()=>{if(r.pathname===Ce){const o=a.get("url");if(o&&fe.has(o))return[e(V.Item,{children:e(W,{style:{color:"inherit"},to:xe(o),children:n.get(o)})},o)]}return[]},l=i.useMemo(()=>{const o=r.pathname.split("/").filter(d=>d);return o.map((d,c)=>{const p=`/${o.slice(0,c+1).join("/")}`;return n.has(p)?e(V.Item,{children:c===o.length-1?e(W,{style:{color:"inherit"},to:p,children:n.get(p)}):n.get(p)},p):null})},[r]),m=[e(V.Item,{children:e(Ze,{})},"home"),...l,...s()];return e(V,{className:"breadcrumb",children:m})},sr=G.memo(lr);const ir=()=>{const t=H(),n=ee(),{mapKeyToMenu:r}=i.useContext(B),{tabs:a,activeTab:s,openTab:l}=i.useContext(ve);return e(Qe,{activeKey:s,items:a,onChange:o=>{console.log("tabclick, tabKey",o,typeof o);const{path:d}=r.has(o)&&r.get(o)||{path:void 0};d&&d!==n.pathname&&t(d)}})},cr=()=>{const t=[{title:"昵称",dataIndex:"nickname",key:"nickname"},{title:"登录IP",dataIndex:"loginIp",key:"loginIp"},{title:"登录时间",dataIndex:"create_time",key:"create_time",render:r=>e(ht,{time:r})}],n=Array(5).fill({id:re(10,1e5),userId:1,loginIp:"127.0.0.1",nickname:"admin",create_time:de().subtract(3,"second").format(Oe.second)});return e(j,{title:"登录历史",extra:e(W,{to:"/",children:"查看更多"}),children:e(Fe,{rowKey:()=>re(10,1e5),pagination:!1,size:"small",columns:t,dataSource:n})})},dr=N.Text,ge=()=>de().format(Oe.second),ur=()=>{const[t,n]=i.useState(0),{colorError:r}=he(),[a,s]=i.useState([{id:re(100,1e9),name:"多tab布局支持",status:z.incomplete,create_time:ge(),update_time:ge()},{id:1,name:"这是一个todo例子",status:z.completed,create_time:ge(),update_time:ge()}]),[l,m]=i.useState(""),o=()=>{l&&(s([{name:l,status:z.incomplete,id:re(100,1e9),create_time:de().format("YYYY-MM-DD HH:MM:SS"),update_time:de().format("YYYY-MM-DD HH:MM:SS")},...a]),m(""))},d=(b,C)=>{s(a.map(y=>y.id!==b?y:{...y,status:C?z.completed:z.incomplete}))},c=(b,C)=>{console.log("iii",b,C),s(a.map(y=>y.id!==b?y:{...y,name:C}))},p=b=>{s(a.filter(C=>C.id!==b))};return e(j,{title:"待办事项",children:u(A,{direction:"vertical",style:{width:"100%"},children:[u(A.Compact,{style:{width:"100%",marginBottom:"16px"},children:[e(M,{value:l,onChange:b=>m(b.target.value),placeholder:"添加新事项",onPressEnter:o}),e(S,{onClick:o,type:"primary",icon:e(ue,{})})]}),a.map(({id:b,status:C,name:y})=>{const g=C===z.completed,v=t===b&&C===z.incomplete;return e(qe,{onChange:({target:{checked:x}})=>d(b,x),checked:g,children:e(dr,{type:g?"secondary":void 0,delete:g,onMouseEnter:()=>n(b),onMouseLeave:()=>n(0),editable:v?{onChange:x=>c(b,x)}:!1,children:u(A,{children:[y,v&&e(Je,{title:"删除",children:e(Ue,{onClick:()=>p(b),style:{color:r}})})]})})},b)})]})})},mr=()=>{const[t,n]=i.useState("pv"),r=[{tab:"访问量",key:"pv"},{tab:"IP",key:"ip"}],a={pv:{stroke:"#8884d8",fill:"#b5b1e6"},ip:{stroke:"#00b96b",fill:"#82ca9d"}},s=Array.from({length:7}).map((l,m)=>({name:de().subtract(m+1,"day").format("MM-DD"),pv:re(1e3,1e4),ip:re(100,1e3)})).reverse();return e(j,{activeTabKey:t,onTabChange:l=>n(l),tabList:r,children:e(et,{width:"100%",height:300,children:u(Ot,{data:s,children:[e(Rt,{strokeDasharray:"3 3"}),e(Dt,{dataKey:"name"}),e(Bt,{}),e(tt,{wrapperStyle:{outline:"none"}}),e(Kt,{type:"monotone",strokeWidth:2,dataKey:t,stroke:a[t].stroke,fill:a[t].fill})]})})})},_e=[{name:"视频类",value:400},{name:"图文类",value:300},{name:"资讯类",value:300}],He=()=>e(R,{children:u("div",{children:[u(Y,{gutter:24,children:[e(T,{span:6,children:e(j,{bordered:!1,children:e(pe,{title:"今日销售额",value:126560,precision:2,prefix:"$"})})}),e(T,{span:6,children:e(j,{bordered:!1,children:e(pe,{title:"示例指标",value:11.28,precision:2,prefix:e(Se,{}),suffix:"%"})})}),e(T,{span:6,children:e(j,{bordered:!1,children:e(pe,{title:"示例指标",value:11.28,precision:2,prefix:e(Se,{}),suffix:"%"})})}),e(T,{span:6,children:e(j,{bordered:!1,children:e(pe,{title:"示例指标",value:11.28,precision:2,valueStyle:{color:"#3f8600"},prefix:e(Se,{}),suffix:"%"})})})]}),e("br",{}),u(Y,{gutter:16,children:[e(T,{span:18,style:{height:300},children:e(mr,{})}),e(T,{span:6,children:e(j,{title:"内容占比",children:e(et,{width:"100%",height:300,children:u(_t,{width:400,height:400,children:[e(Ht,{data:_e,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:90,label:!0,children:_e.map((t,n)=>e(zt,{fill:["#0088FE","#00C49F","#FFBB28"][n%3]},`cell-${n}`))}),e(tt,{wrapperStyle:{outline:"none"}})]})})})})]}),e("br",{}),u(Y,{gutter:16,children:[e(T,{span:12,children:e(ur,{})}),e(T,{span:12,children:e(cr,{})})]})]})}),ze=()=>e("span",{children:"UserCenterPage"}),hr=()=>e("span",{children:"UserCenterUpdatePage"});const gt=i.forwardRef(({state:t},n)=>{const[r]=f.useForm(),a=i.useRef(null);return i.useImperativeHandle(n,()=>({form:r,input:a.current}),[r,a]),e("div",{children:u(f,{form:r,labelCol:{span:3},name:"userForm",initialValues:t||void 0,children:[e(f.Item,{name:"username",label:"账号",rules:[{required:!0,message:"请输入账号"}],children:e(M,{placeholder:"请输入账号",ref:a})}),e(f.Item,{name:"password",label:"密码",rules:[{required:!t,message:"请输入密码"}],children:e(M.Password,{placeholder:t?"不修改密码请留空!":"请输入密码"})}),e(f.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入昵称"}],children:e(M,{placeholder:"请输入昵称"})}),e(f.Item,{name:"gender",label:"性别",children:u(X.Group,{children:[e(X,{value:1,children:"男"}),e(X,{value:2,children:"女"})]})}),e(f.Item,{name:"mobile",label:"手机号",children:e(M,{placeholder:"请输入手机号"})}),e(f.Item,{name:"email",label:"邮箱",children:e(M,{placeholder:"请输入邮箱"})})]})})}),pr=({refreshList:t})=>{const[n,r]=i.useState(!1),{run:a,loading:s}=q(Nn,{manual:!0,debounceWait:100,onSuccess:()=>{var o;r(!1),(o=l.current)==null||o.form.resetFields(),t==null||t()}}),l=i.useRef(null);return u("div",{children:[e(S,{type:"primary",icon:e(ue,{}),onClick:()=>{r(!0),setTimeout(()=>{var o,d;(d=(o=l.current)==null?void 0:o.input)==null||d.focus()},100)},children:"新增用户"}),e(nt,{open:n,title:"添加用户",okText:"添加",cancelText:"取消",confirmLoading:s,onCancel:()=>r(!1),onOk:()=>{var o;(o=l.current)==null||o.form.validateFields().then(d=>{a(d)}).catch(d=>console.log(d))},children:e(gt,{ref:l})})]})},gr=({search:t,form:n})=>e(f,{form:n,name:"advanced_search",style:{paddingTop:16},onFinish:a=>{console.log("Received values of form: ",a)},children:u(Y,{gutter:24,children:[e(T,{span:6,children:e(f.Item,{name:"username",label:"账号",children:e(M,{placeholder:"账号"})})}),e(T,{span:6,children:e(f.Item,{name:"mobile",label:"手机号",children:e(M,{placeholder:"手机号"})})}),e(T,{span:6,children:e(f.Item,{name:"email",label:"邮箱",children:e(M,{placeholder:"邮箱"})})}),u(T,{span:6,style:{textAlign:"right"},children:[e(S,{onClick:t.reset,children:"重置"}),e(S,{style:{margin:"0 8px"},type:"primary",onClick:t.submit,children:"查询"})]})]})}),ft=(t,n)=>{const r=Et(t,n),{tableProps:a}=r,s={...a.pagination,showTotal:(o,d)=>`第${d[0]}-${d[1]} 条/共 ${o} 条`,hideOnSinglePage:!0};a.pagination=s;const l=a.onChange,m=(...o)=>{var v;let[d,c,p,b]=o,C=d,y,g;Object.keys(p).length>0&&(Array.isArray(p)?(g={},p.map(x=>{var I;g[(I=x.column)==null?void 0:I.dataIndex]=x.order})):g={[(v=p.column)==null?void 0:v.dataIndex]:p.order}),Object.keys(c).length>0&&(y=c,console.log("filterrrrrrrrrrrrr",c)),l(C,y,g)};return a.onChange=m,r.tableProps.size="small",r},fr=({state:t,refreshList:n})=>{const[r,a]=i.useState(!1),{runAsync:s,loading:l}=q(Ln,{manual:!0,debounceWait:100}),m=i.useRef(null);return u(R,{children:[e(S,{icon:e(we,{}),size:"small",onClick:()=>{a(!0),setTimeout(()=>{var d,c;(c=(d=m.current)==null?void 0:d.input)==null||c.focus()},100)},children:"编辑"}),e(nt,{open:r,title:"更新用户信息",okText:"保存",cancelText:"取消",confirmLoading:l,onCancel:()=>a(!1),onOk:()=>{var d;(d=m.current)==null||d.form.validateFields().then(c=>{s({...c,id:t.id}).then(()=>{var p;a(!1),(p=m.current)==null||p.form.resetFields(),n==null||n()}).catch(ut)}).catch(c=>console.log(c))},children:e(gt,{ref:m,state:t})})]})};const K=t=>{const{children:n,className:r="",style:a={},...s}=t,{colorBgContainer:l}=he(),m="content-box",o={backgroundColor:l};return e("div",{className:`${m} ${r}`,style:{...o,...a},...s,children:n})},yr=()=>{var v;console.log("render ExampleUserListPage");const[t]=f.useForm(),[n,r]=i.useState([]),a=i.useRef();i.useEffect(()=>{a.current=new Map},[]);const{runAsync:s,loading:l}=q(An,{manual:!0,debounceWait:100}),{refresh:m,tableProps:o,search:d}=ft(Pn,{form:t}),c=()=>{d.reset(),d.submit()},p=x=>{var I;typeof x=="number"&&((I=a==null?void 0:a.current)==null||I.set(x,!0)),s({id:x}).then(()=>{typeof x=="object"&&r([]),m()}).finally(()=>{var h;return typeof x=="number"&&((h=a==null?void 0:a.current)==null?void 0:h.delete(x))})},b=i.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"账号",dataIndex:"username",render:(x,{avatar:I,username:h})=>u(R,{children:[" ",e($e,{src:I})," ",h]})},{title:"昵称",dataIndex:"nickname"},{title:"性别",dataIndex:"gender",render:x=>x===dt.male?e(Re,{color:"blue",children:"男"}):e(Re,{color:"error",children:"女"})},{title:"邮箱",dataIndex:"email"},{title:"手机号",dataIndex:"mobile",sorter:!0},{title:"注册时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(x,I)=>{var k;const{id:h}=I;return u(A,{children:[e(Ie,{title:"确认要删除这条数据吗?",onConfirm:()=>p(h),children:e(S,{loading:(k=a==null?void 0:a.current)==null?void 0:k.has(h),icon:e(Ue,{}),size:"small",danger:!0,children:"删除"})}),e(fr,{state:I,refreshList:m})]})}}],[]),y={selectedRowKeys:n,onChange:x=>{console.log("selectedRowKeys changed: ",x),r(x)}},g=n.length>0;return u(R,{children:[u(K,{children:[e("div",{children:e(N.Title,{level:5,children:"搜索"})}),e(gr,{search:d,form:t})]}),e("br",{}),u(K,{children:[u("div",{className:"table-header",children:[e("div",{className:"left",children:e(N.Title,{level:5,children:"用户列表"})}),e("div",{className:"right",children:u(A,{size:"middle",children:[e(Ie,{title:`确定要删除这${n.length}条数据吗?`,onConfirm:()=>p(n),children:e(S,{type:"primary",danger:!0,disabled:!g,loading:l&&((v=a.current)==null?void 0:v.size)===0,children:"批量删除"})}),e(pr,{refreshList:c}),e(S,{type:"link",title:"点击刷新",onClick:m,icon:e(rt,{})})]})})]}),e(Fe,{rowKey:"id",rowSelection:y,columns:b,...o})]})]})},Ee=({title:t="空白页"})=>e(K,{style:{height:"500px"},children:e(N.Title,{level:4,children:t})}),br=({search:t,form:n})=>e(f,{form:n,name:"advanced_search",style:{paddingTop:16},onFinish:a=>{console.log("Received values of form: ",a)},children:u(Y,{gutter:24,children:[e(T,{span:6,children:e(f.Item,{name:"title",label:"主题",children:e(M,{placeholder:"标题"})})}),e(T,{span:6,children:e(f.Item,{name:"ahthor",label:"作者",children:e(M,{placeholder:"作者"})})}),e(T,{span:6,children:e(f.Item,{name:"create_time",label:"发布时间",children:e(jt.RangePicker,{})})}),u(T,{span:6,style:{textAlign:"right"},children:[e(S,{onClick:t.reset,children:"重置"}),e(S,{style:{margin:"0 8px"},type:"primary",onClick:t.submit,children:"查询"})]})]})});const je=()=>{console.log("render ArticleIndexPage");const[t]=f.useForm(),n=i.useRef();H(),i.useEffect(()=>{n.current=new Map},[]);const{runAsync:r}=q(On,{manual:!0,debounceWait:100}),{refresh:a,tableProps:s,search:l}=ft($n,{form:t}),m=d=>{var c;(c=n==null?void 0:n.current)==null||c.set(d,!0),r({id:d}).then(a).finally(()=>{var p;return(p=n==null?void 0:n.current)==null?void 0:p.delete(d)})},o=i.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"封面",dataIndex:"cover",render:d=>e(Vt,{width:80,height:45,style:{borderRadius:4},src:d})},{title:"标题",dataIndex:"title"},{title:"简介",dataIndex:"description"},{title:"作者",dataIndex:"author"},{title:"发布时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(d,c)=>{var b;const{id:p}=c;return u(A,{children:[e(Ie,{title:"确认要删除这条数据吗?",onConfirm:()=>m(p),children:e(S,{loading:(b=n==null?void 0:n.current)==null?void 0:b.has(p),icon:e(Ue,{}),size:"small",danger:!0,children:"删除"})}),e(W,{to:`/article/update/${p}`,children:e(S,{icon:e(we,{}),size:"small",children:"编辑"})})]})}}],[]);return u(R,{children:[u(K,{children:[e("div",{children:e(N.Title,{level:5,children:"搜索"})}),e(br,{search:l,form:t})]}),e("br",{}),u(K,{children:[u("div",{className:"table-header",children:[e("div",{className:"left",children:e(N.Title,{level:5,children:"文章列表"})}),e("div",{className:"right",children:u(A,{size:"middle",children:[e(W,{to:"/article/create",children:e(S,{type:"primary",icon:e(ue,{}),children:"发布文章"})}),e(S,{type:"link",title:"点击刷新",onClick:a,icon:e(rt,{})})]})})]}),e(Fe,{rowKey:"id",columns:o,...s})]})]})},kr=()=>{const[t]=f.useForm(),n=H(),r="articleDraft",{loading:a,run:s}=q(Fn,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{$.remove(r),n("/article/list")},200)}),l=$.getObject(r)||{},m=async()=>{const c=await t.validateFields();s(c)},o=()=>{const{cover:c,...p}=t.getFieldsValue();$.set(r,p),_.success("已保存到草稿箱")},d=c=>(console.log("Upload event:",c),Array.isArray(c)?c:c&&c.fileList);return u(K,{children:[e(N.Title,{level:3,children:"发布文章"}),e(ie,{}),e(f,{form:t,name:"createForm",labelCol:{span:3},initialValues:l,children:u(Y,{gutter:36,children:[u(T,{span:16,children:[e(f.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(M,{})}),e(f.Item,{label:"简介",name:"description",children:e(M,{})}),e(f.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:e(M.TextArea,{rows:20})}),e(f.Item,{wrapperCol:{offset:3},children:u(A,{children:[e(S,{icon:e(at,{}),onClick:m,loading:a,type:"primary",children:"发布文章"}),e(S,{icon:e(Yt,{}),onClick:o,children:"保存为草稿"})]})})]}),u(T,{span:8,children:[e(f.Item,{label:"封面",name:"cover",getValueFromEvent:d,valuePropName:"fileList",children:e(ot,{maxCount:1,listType:"picture-card",children:u("div",{children:[e(ue,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(f.Item,{label:"标签",name:"tags",children:e(lt,{mode:"tags",placeholder:"文章标签"})}),e(f.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(M,{})})]})]})})]})},vr=()=>{const[t]=f.useForm(),n=H(),r=qt(),{loading:a,run:s}=q(wn,{manual:!0,debounceWait:10,onSuccess:c=>t.setFieldsValue(c)});i.useEffect(()=>{s({id:r.id})},[r.id]);const{loading:l,run:m}=q(Un,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{n("/article/list")},200)}),o=async()=>{const c=await t.validateFields();m(c)},d=c=>(console.log("Upload event:",c),Array.isArray(c)?c:c&&c.fileList);return u(K,{children:[e(N.Title,{level:3,children:"更新文章"}),e(ie,{}),e(Ae,{spinning:a,children:e(f,{form:t,name:"createForm",labelCol:{span:3},children:u(Y,{gutter:36,children:[u(T,{span:16,children:[e(f.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(M,{})}),e(f.Item,{label:"简介",name:"description",children:e(M,{})}),e(f.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:e(M.TextArea,{rows:20})}),e(f.Item,{wrapperCol:{offset:3},children:e(A,{children:e(S,{icon:e(at,{}),onClick:o,loading:l,type:"primary",children:"保存"})})})]}),u(T,{span:8,children:[e(f.Item,{label:"封面",name:"cover",getValueFromEvent:d,valuePropName:"fileList",children:e(ot,{maxCount:1,listType:"picture-card",children:u("div",{children:[e(ue,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(f.Item,{label:"标签",name:"tags",children:e(lt,{mode:"tags",placeholder:"文章标签"})}),e(f.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(M,{})})]})]})})})]})},Cr=()=>{const t=ee();return u(K,{style:{},children:[e(N.Title,{children:"404"}),e(N.Paragraph,{children:"页面不存在"}),u(N.Paragraph,{children:["路由: ",t.pathname]}),e(W,{to:"/",children:"回到首页"})]})};const xr=t=>{const{title:n="Iframe Page",name:r="internal-iframe"}=t,a=i.useRef(null),[s,l]=i.useState(!0),[m]=ae();i.useEffect(()=>{l(!0)},[m]);const o=m.get("url"),d=()=>{l(!1)};return o?e(R,{children:e(K,{style:{height:"100%",padding:0},children:e(Ae,{wrapperClassName:"iframeSpin",spinning:s,tip:"正在加载第三方页面, 请稍后...",children:e("iframe",{ref:a,width:"100%",height:"100%",onLoad:d,title:n,name:r,src:o})})})}):e(K,{children:e(Wt,{message:"无效的url地址",type:"error"})})};function yt(){return console.log("routerrrrrrrrrrr"),Jt([{path:"/",element:e(He,{})},{path:"/dashboard",element:e(He,{})},{path:"/user",children:[{index:!0,element:e(ze,{})},{path:"/user/center/index",element:e(ze,{})},{path:"/user/center/update",element:e(hr,{})}]},{path:"/example/userList",element:e(yr,{})},{path:"/article",children:[{index:!0,element:e(je,{})},{path:"/article/list",element:e(je,{})},{path:"/article/create",element:e(kr,{})},{path:"/article/update/:id",element:e(vr,{})}]},{path:"/blank",element:e(Ee,{})},{path:Ce,element:e(xr,{})},{path:"/multilevel/menu/2/3",element:e(Ee,{title:"三级菜单"})},{path:"*",element:e(Cr,{})}])}const Sr=()=>(console.log("MultitabLayout render..."),e(_n,{children:u(O,{className:"multitab-layout",children:[e(pt,{}),u(O,{children:[e(or,{}),u(O,{className:"content-layout",children:[e(ir,{}),u(zn,{children:[e(sr,{}),e(yt,{})]}),e(mt,{})]})]})]})}));const ye=new Map,Ne=t=>{t.map(n=>{me(n)&&(n==null?void 0:n.type)==="url"||(oe(n)&&Ne(n.children||[]),(Z(n)||be(n))&&(n.path&&ye.set(n.path,n.label),n.children&&Ne(n.children||[])))})},Ir=()=>{const{menuList:t}=i.useContext(B),n=i.useMemo(()=>(ye.clear(),Ne(t),ye),[t]),r=ee(),[a]=ae(),s=()=>{if(r.pathname===Ce){const o=a.get("url");if(o&&ye.has(o))return[e(V.Item,{children:e(W,{style:{color:"inherit"},to:xe(o),children:n.get(o)})},o)]}return[]},l=i.useMemo(()=>{const o=r.pathname.split("/").filter(d=>d);return o.map((d,c)=>{const p=`/${o.slice(0,c+1).join("/")}`;return n.has(p)?e(V.Item,{children:c===o.length-1?e(W,{style:{color:"inherit"},to:p,children:n.get(p)}):n.get(p)},p):null})},[r]),m=[e(V.Item,{children:e(Ze,{})},"home"),...l,...s()];return e(V,{className:"breadcrumb",children:m})},Tr=G.memo(Ir);const Mr=({children:t})=>(console.log("Content render..."),console.log("childdddddddd",t),e(O.Content,{className:"content",children:t})),Pr=G.memo(Mr),Nr=()=>{var C;const t=H(),n=ee(),{menuList:r,mapKeyToMenu:a,mapPathToMenu:s}=i.useContext(B);let l=((C=s.get("/dashboard"))==null?void 0:C.key)||"",m=[],o=!1;const{pathname:d}=n,[c]=ae(),p=y=>{const g=a.get(y.key);if(console.log("mapKeyToMenu",a),console.log("clicked menu",y,g),!g){console.warn("未获取到菜单信息");return}if(g.path!==d){if((g==null?void 0:g.type)==="url"){window.open(g.path,"_blank");return}if(document.title=`${D.pageTitlePrefix} - ${g.label}`,(g==null?void 0:g.type)==="iframe"){console.log("打开iframe页面"),t(xe(g.path));return}t(g.path)}},b=i.useMemo(()=>{const y=v=>v.badge?v.badge==="dot"?e(ce,{className:"menu-item-badge",offset:[6,0],dot:!0,children:v.label}):e(ce,{className:"menu-item-badge",offset:[15,0],count:v.badge,children:v.label}):v.label,g=(v,x)=>{const I=[];return!o&&x&&m.push(x.key),v.map(h=>{var le;if(me(h)&&(h.parent&&d.indexOf(h.path)===0&&(l=((le=s.get(h.parent))==null?void 0:le.key)||"",o=!0),h.type==="iframe"&&(c.get("url")||"")===h.path&&(o=!0,l=h.key),h.hideInMenu))return;let k;if(st(h))k={...h};else if(oe(h))k={...h},h.children&&h.children.length>0&&(k.children=g(h.children));else if(Z(h)||be(h)){let{icon:L}=h;typeof L=="string"&&L.includes("icon-")&&(L=e(w,{type:L})),k={key:"",...h,icon:L,label:y(h),children:Z(h)?g(h.children,h):void 0},!o&&h.path===d&&(l=h.key,o=!0)}k&&(k.key=k.key,I.push(k))}),!o&&m.pop(),I};return g(r)},[r]);return e(Xe,{style:{height:"100%"},onClick:p,mode:"inline",defaultSelectedKeys:[l],items:b,defaultOpenKeys:m})},Lr=G.memo(Nr),Ar=()=>{const{menuCollapsed:t}=i.useContext(B),{colorBgContainer:n}=he();return e(O.Sider,{style:{background:n},trigger:null,className:"left-sider",collapsible:!0,collapsed:t,children:e(Lr,{})})},$r=()=>(console.log("SingleLaylut render..."),u(O,{className:"single-tab-layout",children:[e(pt,{}),u(O,{children:[e(Ar,{}),u(O,{className:"content-layout",children:[e(Tr,{}),e(Pr,{children:e(yt,{})}),e(mt,{})]})]})]})),wr=()=>{const[t,n]=i.useState(!0),{setIsLogin:r,setUserInfo:a}=i.useContext(ke),{colorBgContainer:s}=he(),{settings:{multitabMode:l,fixedMenu:m,fixedHeader:o,theme:d}}=i.useContext(Q),{menuCollapsed:c}=i.useContext(B),p=H(),[b]=ae();return console.log("global layout render..."),i.useEffect(()=>{if(!Te()){p("/login");return}Tn().then(C=>{if(n(!1),r(!0),a(C),b.has("ghpage")){const y=decodeURIComponent(b.get("ghpage"));p(y);return}}).catch(C=>{C instanceof Gt&&We.error({message:"网络错误",description:"获取用户信息失败, 无法打开页面",duration:null,closeIcon:null})})},[]),Te()?t?e(Dn,{title:"页面加载中",loading:t}):u("div",{"data-fixed-menu":m?1:0,"data-menu-collapsed":c?1:0,"data-fixed-header":o?1:0,style:{background:s},className:`global-layout theme-${d}`,children:[l?e(Sr,{}):e($r,{}),e(Bn,{})]}):(p("/login"),null)};function Fr(){return i.useEffect(()=>{},[]),e(bn,{children:e("div",{className:"App",children:u(Qt,{children:[e(De,{element:e(Rn,{}),path:"/login"}),e(De,{path:"*",element:e(wr,{})})]})})})}function Ve(t){const n=JSON.stringify({type:"JWT",alg:"HS256"}),r=Number((new Date().getTime()/1e3).toFixed(0)),a=JSON.stringify({iss:"github.com/xstnet",sub:"react-admin",iat:r,exp:r+86400*14,data:t}),s="H_97UyQUOmURnZdDwI0khuAt4Cmg";return`${Be(n)}.${Be(a)}.${s}`}P.mock(/api\/login/,"post",({body:t})=>{const{username:n,password:r}=JSON.parse(t);return n==="admin"?r!=="123456"?{code:-1,message:"密码错误"}:{code:0,message:"登录成功",data:{token:Ve({uid:1})}}:{code:0,message:"登录成功",data:{token:Ve({uid:te.Random.natural(2,1e4)})}}});P.setup({timeout:100});P.mock(/api\/user\/info/,"get",t=>({code:0,message:"ok",data:{id:1,username:"admin",nickname:"醉丶春风",avatar:"https://www.xstnet.com/static/images/head.gif",password:"",gender:te.Random.natural(1,2),email:"shantongxu@qq.com",mobile:"133xxxx3333"}}));P.mock(/api\/user\/logout/,"post",t=>({code:0,message:"退出成功"}));P.mock(/api\/user\/list/,"get",t=>{const n=new URLSearchParams(t.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,username:"@first@last",nickname:"@cname",avatar:()=>te.Random.dataImage("200x200"),email:"@email",mobile:()=>P.mock(/^1[3456789]\d{9}$/).replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"),"gender|1-2":0,create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return P.mock(a)});P.mock(/api\/user\/create/,"post",t=>({code:0,message:"创建成功",data:{id:te.Random.natural(100,9999)}}));P.mock(/api\/user\/update/,"post",t=>({code:0,message:"更新成功"}));P.mock(/api\/user\/delete/,"post",t=>({code:0,message:"删除成功"}));P.setup({timeout:100});P.mock(/api\/article\/detail/,"get",t=>(console.log("🚀 ~ file: article.ts:7 ~ Mock.mock ~ options:",t),{code:0,message:"ok",data:{id:1,title:"主题",description:"醉丶春风",author:"醉丶春风",tags:[1,2],content:"content",create_time:te.Random.datetime()}}));P.mock(/api\/article\/list/,"get",t=>{const n=new URLSearchParams(t.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,author:"@first@last",title:()=>P.Random.ctitle(5,20),description:"@cname",cover:()=>te.Random.dataImage("480x270","封面"),content:"@email",create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return P.mock(a)});P.mock(/api\/article\/create/,"post",t=>({code:0,message:"创建成功",data:{id:te.Random.natural(100,9999)}}));P.mock(/api\/article\/update/,"post",t=>({code:0,message:"更新成功"}));P.mock(/api\/article\/delete/,"post",t=>({code:0,message:"删除成功"}));Xt.createRoot(document.getElementById("root")).render(e(Zt,{basename:"/react-admin-template/",children:e(Fr,{})}));
