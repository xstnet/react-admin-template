import{a as e,j as l,F as S,p as N,u as R,C as I,g as z}from"./index-3b862715.js";import{r as b,J as g,a4 as B,a5 as C,B as u,ap as j,aq as q,ar as L,as as _,at as $,au as k,N as E,ag as M,av as U,a0 as J,a1 as K,aw as W,b as F,a8 as X,a9 as G,L as P,X as H,v as A,a2 as Q,aa as V,ab as Y}from"./vendor-6e5b4772.js";const Z=t=>{const{search:a,form:i,onSearch:o,onReset:h,fields:m,...p}=t;b.useState(!1);const f=async()=>{await i.validateFields().catch(r=>console.warn(r)),o==null||o(i),a.submit()},y=()=>{h==null||h(i),a.reset()},s={labelCol:{span:5},style:{paddingTop:16}},d=({type:r,name:x,label:v,fieldProps:T={},itemProps:D={}})=>{const O=(w,n)=>{switch(w){case"input":return e(J,{...n});case"number":return e(U,{width:"100%",...n});case"select":return e(M,{...n});case"radio":return e(E,{...n});case"date":return e(k,{...n});case"dateRange":return e(k.RangePicker,{...n});case"checkbox":return e($,{...n});case"cascader":return e(_,{...n});case"treeSelect":return e(L,{...n});default:return e(S,{})}};return e(C,{span:6,children:e(g.Item,{name:x,label:v,...D,children:O(r,T)})},`${x}-${v}`)},c=()=>{const r=a.type==="simple"?0:18-m.length%4*6;return console.log("offffff",r),l(C,{span:6,offset:r,style:{textAlign:"right"},children:[e(u,{onClick:y,children:"重置"}),e(u,{style:{margin:"0 8px"},type:"primary",onClick:f,children:"查询"}),l("a",{style:{fontSize:12},onClick:a.changeType,children:[a.type==="advance"?e(j,{}):e(q,{}),a.type==="advance"?"收起":"展开"]})]})};return e(g,{form:i,...s,...p,children:l(B,{gutter:24,children:[a.type==="advance"?m.map(d):m.slice(0,3).map(d),c()]})})},ae=()=>{console.log("render ArticleIndexPage");const t=b.useRef(new Map),{runAsync:a}=K(N,{manual:!0,debounceWait:100}),[i]=g.useForm(),{refresh:o,tableProps:h,search:m}=R(z,{form:i}),p=s=>{var d;(d=t==null?void 0:t.current)==null||d.set(s,!0),a({id:s}).then(o).finally(()=>{var c;return(c=t==null?void 0:t.current)==null?void 0:c.delete(s)})},f=b.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"封面",dataIndex:"cover",render:s=>e(W,{width:80,height:45,style:{borderRadius:4},src:s})},{title:"标题",dataIndex:"title"},{title:"简介",dataIndex:"description"},{title:"作者",dataIndex:"author"},{title:"发布时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(s,d)=>{var r;const{id:c}=d;return l(F,{children:[e(X,{title:"确认要删除这条数据吗?",onConfirm:()=>p(c),children:e(u,{loading:(r=t==null?void 0:t.current)==null?void 0:r.has(c),icon:e(G,{}),size:"small",danger:!0,children:"删除"})}),e(P,{to:`/article/update/${c}`,children:e(u,{icon:e(H,{}),size:"small",children:"编辑"})})]})}}],[]),y=[{type:"input",label:"标题",name:"title"},{type:"input",label:"作者",name:"author"},{type:"input",label:"简介",name:"desc"},{type:"select",label:"状态",name:"status",fieldProps:{options:[{label:"已发布",value:"published"},{label:"草稿",value:"draft"}]}},{type:"dateRange",label:"发布时间",name:"create_time"}];return l(S,{children:[l(I,{children:[e("div",{children:e(A.Title,{level:5,children:"搜索"})}),e(Z,{search:m,form:i,fields:y})]}),e("br",{}),l(I,{children:[l("div",{className:"table-header",children:[e("div",{className:"left",children:e(A.Title,{level:5,children:"文章列表"})}),e("div",{className:"right",children:l(F,{size:"middle",children:[e(P,{to:"/article/create",children:e(u,{type:"primary",icon:e(Q,{}),children:"发布文章"})}),e(u,{type:"link",title:"点击刷新",onClick:o,icon:e(V,{})})]})})]}),e(Y,{rowKey:"id",columns:f,...h})]})]})};export{ae as default};
