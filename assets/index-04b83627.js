import{j as Ce,r as s,C as ut,z as mt,t as W,u as Be,a as Q,b as G,m as B,d as ht,S as De,n as He,c as O,B as S,e as ze,R as V,f as ne,g as se,h as ce,L as ye,H as pt,i as gt,k as ft,T as Ve,l as de,o as yt,F as je,p as qe,q as bt,s as R,G as kt,v as E,w as vt,x as Ct,y as ee,A as xe,U as Ke,D as K,E as be,P as xt,I as St,J as C,K as oe,M as Tt,N as A,O as re,Q as It,V as Mt,W as Pt,X as Ge,Y as wt,Z as Lt,_ as Nt,$ as At,a0 as P,a1 as J,a2 as Se,a3 as Ye,a4 as Rt,a5 as We,a6 as $t,a7 as Je,a8 as Pe,a9 as Te,aa as Et,ab as Qe,ac as me,ad as Ft,ae as Ot,af as we,ag as Le,ah as Ut,ai as _t,aj as Bt,ak as Dt,al as Ht,am as zt,an as Ze,ao as Xe,ap as Vt,aq as jt,ar as qt,as as Kt,at as T,au as F,av as Ne,aw as Gt}from"./vendor-53b41d67.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();const U=Ce.Fragment,t=Ce.jsx,f=Ce.jsxs,H={pageTitle:"后台管理系统模板",pageTitlePrefix:"后台管理",tokenKey:"Authorization",apiBaseUrl:"https://xstnet.github.io/react-admin-template/api",iconFontUrl:"//at.alicdn.com/t/c/font_3917407_68ll5mr3jkf.js"};function Yt(e,n){localStorage.setItem(e,typeof n=="object"?JSON.stringify(n):n)}function Wt(e){localStorage.setItem(H.tokenKey,typeof e=="object"?JSON.stringify(e):e)}function et(e){return localStorage.getItem(e)}function Jt(e){const n=localStorage.getItem(e);if(n!==null)return Number(n)}function Qt(e){const n=localStorage.getItem(e);if(n!==null)return n==="true"}function Zt(e){const n=localStorage.getItem(e);if(n!==null)return JSON.parse(n)}function Xt(e){return et(e)!==null}function en(e){localStorage.removeItem(e)}function tn(){localStorage.removeItem(H.tokenKey)}function nn(){localStorage.clear()}const _={set:Yt,setToken:Wt,has:Xt,getString:et,getObject:Zt,getBoolean:Qt,getNumber:Jt,remove:en,removeToken:tn,clear:nn},tt=()=>{const[e,n]=s.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);return s.useEffect(()=>{const a=o=>{console.log("chage",o.matches),o.matches?n(!0):n(!1)};return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",a)}},[]),[e?"dark":"light"]},rn=void 0,an=s.createContext(rn),on=({children:e})=>{const{settings:{primaryColor:n,theme:r,compactMode:a,followSystemTheme:o}}=s.useContext(j),[l]=tt(),c={},i=()=>{const m=[];return o?m.push(l==="light"?W.defaultAlgorithm:W.darkAlgorithm):m.push(r==="light"?W.defaultAlgorithm:W.darkAlgorithm),a&&m.push(W.compactAlgorithm),m};return t(an.Provider,{value:c,children:t(ut,{locale:mt,theme:{algorithm:i(),token:{colorPrimary:n},components:{Button:{borderRadius:4,borderRadiusSM:2},Modal:{borderRadius:4,borderRadiusOuter:2}}},children:e})})},sn=void 0,j=s.createContext(sn),ln=({children:e})=>{const n=s.useMemo(()=>({theme:"light",compactMode:!1,followSystemTheme:!0,fixedHeader:!0,fixedMenu:!0,showFooter:!0,multitabMode:!1,primaryColor:"#00b96b",..._.getObject("settings")||{}}),[]),[r,a]=s.useState(n),o=s.useCallback(c=>{const i={...r,...c};a(i),_.set("settings",i)},[r]),l={settings:r,setSetting:o};return t(j.Provider,{value:l,children:t(on,{children:e})})},cn=void 0,Y=s.createContext(cn),dn=({children:e})=>{const[n,r]=s.useState(!1),[a,{toggleFullscreen:o}]=Be(document.body),[l,c]=s.useState(null),i=s.useMemo(()=>({isLogin:n,setIsLogin:r,userInfo:l,setUserInfo:c,fullScreen:a,setFullScreen:o}),[n,l,a]);return t(Y.Provider,{value:i,children:t(ln,{children:e})})},un="modulepreload",mn=function(e){return"/react-admin-template/"+e},Ae={},le=function(n,r,a){if(!r||r.length===0)return n();const o=document.getElementsByTagName("link");return Promise.all(r.map(l=>{if(l=mn(l),l in Ae)return;Ae[l]=!0;const c=l.endsWith(".css"),i=c?'[rel="stylesheet"]':"";if(!!a)for(let u=o.length-1;u>=0;u--){const p=o[u];if(p.href===l&&(!c||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${i}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":un,c||(d.as="script",d.crossOrigin=""),d.href=l,document.head.appendChild(d),c)return new Promise((u,p)=>{d.addEventListener("load",u),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>n())},hn=({to:e})=>{const n=Q();return s.useEffect(()=>{n(e)},[]),null};var ke=(e=>(e[e.success=0]="success",e[e.noLogin=-10001]="noLogin",e[e.loginExpired=-10002]="loginExpired",e))(ke||{}),nt=(e=>(e[e.male=1]="male",e[e.female=2]="female",e))(nt||{}),ae=(e=>(e[e.incomplete=1]="incomplete",e[e.completed=2]="completed",e[e.deleted=10]="deleted",e))(ae||{}),pn=(e=>(e.day="YYYY-MM-DD",e.second="YYYY-MM-DD HH:mm:ss",e.minute="YYYY-MM-DD HH:mm",e.hour="YYYY-MM-DD HH",e))(pn||{});function q(){}function Re(e,n){return Math.floor(Math.random()*(n-e+1))+e}function rt(e,n){const{roles:r=[]}=n||{};return e?typeof e=="string"||typeof e=="number"?r.includes(e):Array.isArray(e)?e.some(a=>r.includes(a)):typeof e=="function"?e(n):!1:!0}function gn(e){var r;const{config:n}=e;console.group(`${(r=n.method)==null?void 0:r.toLocaleUpperCase()} ${n.url}`),console.log("Path:",n.url),console.log("Method:",n.method),console.log("Params:",n.params),console.log("Body:",n.data),console.log("StatusCode:",e.status),console.log("Response:",typeof e.data=="object"?Object.assign(Object.create(null),e.data):e.data),console.groupEnd()}const fn=10*1e3;G.defaults.baseURL=H.apiBaseUrl;G.defaults.headers.post["Content-Type"]="application/json; charset=utf-8";G.defaults.timeout=fn;G.interceptors.request.use(e=>(e.headers.Authorization=`Bearer ${_.getString(H.tokenKey)}`,e),e=>Promise.reject(e));G.interceptors.response.use(e=>{gn(e);const n=e.data;return typeof n.code!="number"?(B.error("系统错误",2),console.warn("api调用失败, 未正常返回数据, url:",e.config.url,"data:",n,"response:",e),Promise.reject(e)):n.code===0?(e.config.method==="post"&&typeof e.data.message=="string"&&e.data.message.length>0&&B.success(e.data.message),e):n.code===ke.noLogin?(B.error("您还没有登录, 即将跳转到登录页面, 请稍后..."),_.remove(H.tokenKey),location.reload(),Promise.reject(n)):n.code===ke.loginExpired?(B.error("登录已失效, 即将跳转到登录页面..."),_.remove(H.tokenKey),location.reload(),Promise.reject(n)):(B.error(n.message),Promise.reject(e))},e=>(typeof e.message=="string"&&e.message==="Network Error"?B.error("网络错误, 请稍后再试!"):B.error("请求失败, 请稍后再试"),console.log("Request error",e),Promise.reject(e)));const yn=(e,n,r)=>{const a=r||{};return a.params=n,G.get(e,a).then(o=>o.data.data).catch(o=>Promise.reject(o))},bn=(e,n,r)=>G.post(e,n,r).then(a=>a.data.data).catch(a=>Promise.reject(a)),kn=e=>G.request(e),M={get:yn,post:bn,request:kn},_r=e=>M.post("/login",e),vn=e=>M.get("/user/info",e),Cn=()=>M.post("/user/logout"),xn=(e,n)=>M.get("/user/list",{...e,...n}),Sn=e=>M.post("/user/create",e),Tn=e=>M.post("/user/update",e),In=e=>M.post("/user/delete",e),Br=(e,n)=>M.get("/article/list",{...e,...n}),Mn=e=>M.get("/article/detail",e),Pn=e=>M.post("/article/create",e),wn=e=>M.post("/article/update",e),Dr=e=>M.post("/article/delete",e),Hr=e=>M.get("/todo/list",e),zr=e=>M.post("/todo/changeStatus",e),Vr=e=>M.post("/todo/delete",e),jr=e=>M.post("/todo/update",e),qr=e=>M.post("/todo/create",e),Ln=()=>M.get("/category/treeList");function Nn(e){const n=e.split(".")[1];if(n)try{return JSON.parse(ht(n))}catch(r){console.warn("Parse Token Error: ",r);return}}function $e(){var r;const e=_.getString(H.tokenKey);if(!e)return!1;const n=Nn(e);return n!==void 0&&((r=n==null?void 0:n.data)==null?void 0:r.uid)>0&&n.exp>new Date().getTime()/1e3}const Ie=({loading:e=!0,title:n="页面加载中",delay:r=50})=>{const{settings:{theme:a}}=s.useContext(j);return t(De,{size:"large",spinning:e,tip:n,delay:r,wrapperClassName:`page-loading-spin-${a}`,children:t("div",{style:{height:"100%",width:"100%"}})})},An=()=>{const[e,n]=He.useNotification(),r=_.getBoolean("dontShowCompactModeNotify"),{setSetting:a,settings:{compactMode:o}}=s.useContext(j),l=()=>{const c=`open${Date.now()}`,i=f(O,{children:[t(S,{type:"link",size:"small",onClick:()=>e.destroy(),children:"不再提示"}),t(S,{type:"primary",size:"small",onClick:()=>{a({compactMode:!0}),e.destroy(c)},children:"开启"})]});e.info({message:"开启紧凑布局模式",description:"检测到您的屏幕尺寸过小, 是否开启紧凑布局模式? 或者您也可以选择在设置中手动开启",btn:i,key:c,onClose:()=>_.set("dontShowCompactModeNotify",!0)})};return s.useEffect(()=>{!r&&!o&&window.innerWidth<=1440&&l()},[]),n},Rn=[{label:"控制台",icon:"icon-dashboard",path:"/dashboard",permission:"admin"},{label:"示例页面",path:"/example",icon:"icon-example",children:[{label:"列表页",icon:"icon-list",path:"/example/userList",permission:["admin","guest"]},{label:"权限测试页",icon:"icon-list",path:"/example/permission",children:[{label:"菜单权限",icon:"icon-list",path:"/example/permission/menu"},{label:"按钮权限",icon:"icon-list",path:"/example/permission/button"}]},{label:"多级菜单",icon:"icon-list",path:"/multilevel/menu",children:[{label:"二级菜单",icon:"icon-list",path:"/multilevel/menu/2",children:[{label:"三级菜单",icon:"icon-list",path:"/multilevel/menu/2/3"}]}]},{label:"Tabs标签页",icon:"icon-list",path:"/example/tabs",children:[{label:"标签管理",icon:"icon-list",path:"/example/tabs/manage"}]},{label:"空白页",icon:"icon-example",path:"/blank"},{label:"404",icon:"icon-example",path:"/404"}]},{label:"徽标示例",path:"/badge",icon:"icon-example",children:[{label:"红点徽标",icon:"icon-list",badge:"dot",path:"/badge/dot"},{label:"数字徽标",icon:"icon-example",badge:98,path:"/badge/count"}]},{path:"/article",label:"文章管理",icon:"icon-article",permission:"admin",children:[{path:"/article/list",label:"文章列表",icon:"icon-article"},{path:"/article/create",label:"发布文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/update",label:"更新文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/category",label:"分类管理",icon:"icon-list"}]},{path:"/iframe",label:"外部页面",icon:"icon-href",permission:"admin",children:[{path:"https://ant-design.antgroup.com/components/overview-cn",label:"antd文档(外链)",icon:"icon-document",type:"url"},{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(内嵌)",icon:"icon-document",type:"iframe"},{path:"https://www.xstnet.com",label:"博客主页(内嵌)",icon:"icon-document",type:"iframe"},{path:"https://baidu.com",label:"百度",icon:"icon-document",type:"iframe"}]},{path:"/document",label:"文档",hideInMenu:!0,icon:"icon-document",children:[{path:"/document/start",label:"开始使用",icon:"icon-document"},{path:"/document/package.json",label:"Package文件说明",icon:"icon-document"}]},{path:"/user/center",label:"个人中心",icon:"icon-user-permissions",permission:e=>e.roles.includes("admin"),children:[{path:"/user/center/index",label:"个人中心",icon:"icon-example"},{path:"/user/center/update",label:"修改信息",icon:"icon-document"}]}],$n=async e=>Rn;function at(e){return!!(typeof e.children>"u"||Array.isArray(e.children)&&e.children.length===0)}function he(e){return ge(e)?!1:!!(typeof e.children<"u"&&Array.isArray(e.children)&&e.children.length>0)}function pe(e){return typeof e.path=="string"&&typeof e.label=="string"}function ge(e){return typeof e.type<"u"&&e.type==="group"}function En(e){return typeof e.type<"u"&&e.type==="divider"}const Fn=void 0,z=s.createContext(Fn),On=({children:e})=>{const{userInfo:n}=s.useContext(Y),[r,a]=s.useState([]),[o,l]=s.useState(!1);s.useEffect(()=>{async function d(){try{const u=await $n(n);a([...u])}catch(u){console.warn("获取菜单数据失败",u)}}d()},[n]);const{mapPathToMenu:c,processedMenuList:i}=s.useMemo(()=>(()=>{const u=new Map,p=b=>{pe(b)&&(b.key=(b==null?void 0:b.key)||b.path);const{permission:I,...g}=b;return g},y=b=>b.map(g=>{var x;const{permission:h=void 0}=g;if(!rt(h,n))return null;const v=p(g);return(he(v)||ge(v))&&(v.children=y(v.children||[]),!v.children||!((x=v.children)!=null&&x.length))?null:(pe(v)&&u.set(v.path,v),v)}).filter(g=>g);return{processedMenuList:y(r),mapPathToMenu:u}})(),[r]),m=s.useMemo(()=>({menuList:i,setMenuList:a,menuCollapsed:o,setMenuCollapsed:l,mapPathToMenu:c}),[r,o]);return r.length===0?t(z.Provider,{value:m,children:t(Ie,{})}):t(z.Provider,{value:m,children:e})},Un={addTab:q,removeTab:q,tabs:[],openTab:q,hasTab:()=>!1,setTabs:q,activeTab:"",whiteList:[],tabEvent:ze(),addTabWithNavigate:q},fe=s.createContext(Un),_n=({children:e})=>{const[n,r]=s.useState([]),[a,o]=s.useState(""),l=s.useMemo(()=>ze(),[]),c=Q(),i=s.useCallback(()=>{const p=g=>{g&&g!==a&&o(g)},y=g=>n.findIndex(h=>h.key===g)>-1,k=(g,h=!0)=>{y(g.key)||r(v=>[...v,{...g}]),h&&a!==g.key&&p(g.key)};return{openTab:p,addTab:k,removeTab:g=>{const h=n.findIndex(x=>x.key===g);if(h===-1)return;const v=n[h===0?1:h-1];r(x=>x.filter(w=>w.key!==g)),a===g&&v&&c(v.key),console.log("tabs",n)},hasTab:y,addTabWithNavigate:g=>{k(g,!0);const h=n.find(x=>x.key===g.key)||g;if(!h){console.log("标签页不存在");return}const v=h.key+(h.queryString||"");c(v)}}},[n,a]),m=s.useMemo(()=>i(),[i]),d=["/"],u=s.useMemo(()=>({tabs:n,setTabs:r,activeTab:a,tabEvent:l,whiteList:d,...m}),[n,a]);return t(fe.Provider,{value:u,children:e})},te=()=>{const{token:e}=W.useToken();return e},D="/iframe",ot=e=>`${D}?url=${e}`;const ue=new Map,ve=e=>{e.map(n=>{pe(n)&&(n==null?void 0:n.type)==="url"||(ge(n)&&ve(n.children||[]),(he(n)||at(n))&&(n.path&&ue.set(n.path,n.label),n.children&&ve(n.children||[])))})},Bn=()=>{const{menuList:e}=s.useContext(z),n=s.useMemo(()=>(ue.clear(),ve(e),ue),[e]),r=ne(),[a]=se(),o=()=>{if(r.pathname===D){const i=a.get("url");if(i&&ue.has(i))return[t(ce.Item,{children:t(ye,{style:{color:"inherit"},to:ot(i),children:n.get(i)})},i)]}return[]},l=s.useMemo(()=>{const i=r.pathname.split("/").filter(m=>m);return i.map((m,d)=>{const u=`/${i.slice(0,d+1).join("/")}`;return n.has(u)?t(ce.Item,{children:d===i.length-1?t(ye,{style:{color:"inherit"},to:u,children:n.get(u)}):n.get(u)},u):null})},[r]),c=[t(ce.Item,{children:t(pt,{})},"home"),...l,...o()];return t(ce,{className:"breadcrumb",children:c})},st=V.memo(Bn);function Dn({freeze:e,children:n}){const r=s.useRef({}).current;if(e&&!r.promise)throw r.promise=new Promise(a=>{r.resolve=a}),r.promise;if(e)throw r.promise;return r.promise&&(r.resolve(),r.promise=void 0),t(s.Fragment,{children:n})}function Hn({freeze:e,children:n,placeholder:r=null}){return t(s.Suspense,{fallback:r,children:t(Dn,{freeze:e,children:n})})}const zn=({active:e,children:n,id:r,parentRef:a})=>{const[o]=s.useState(()=>document.createElement("div")),l=s.useRef(!0),c=r.indexOf(D)===0,i=s.useMemo(()=>gt.createPortal(n,o),[]);return s.useEffect(()=>{const m=()=>{var u,p;if(e&&o.setAttribute("id",r),c)return d();if(e)(u=a.current)==null||u.appendChild(o);else try{(p=a.current)==null||p.removeChild(o)}catch{}},d=()=>{var u;l.current&&((u=a.current)==null||u.appendChild(o)),o.style.display=e?"block":"none",l.current=!1};m()},[e,o,l.current]),s.useEffect(()=>()=>{var m;try{(m=a.current)==null||m.removeChild(o)}catch{}},[]),c?t(Hn,{freeze:!e,children:i}):i};let Ee=1;const Vn=()=>{const e=ft(),{pathname:n,search:r}=ne(),a=n===D?n+r:n,{tabs:o,tabEvent:l,whiteList:c}=s.useContext(fe),i=s.useRef(null),[m,d]=s.useState([]);return s.useEffect(()=>{const u=l.on("reload",p=>{console.log("刷新页面:",p),d(m.map(y=>y.id!==p?y:{...y,key:++Ee}))});return()=>{u()}},[m]),s.useEffect(()=>{if(!a||c.includes(a))return;const u=o.map(p=>p.key);d(p=>(p.find(k=>k.id===a)||p.push({id:a,element:e,key:++Ee}),p.filter(k=>u.includes(k.id))))},[o]),c.includes(a)?e:f(U,{children:[t("div",{ref:i,className:"keep-alive"}),m.map(({id:u,element:p,key:y})=>t(zn,{active:u===a,parentRef:i,id:u,children:p},y))]})};const jn=()=>{const{pathname:e}=ne(),{tabs:n,activeTab:r,removeTab:a,tabEvent:o,addTabWithNavigate:l}=s.useContext(fe),{colorPrimary:c}=te(),[i,m]=s.useState(!1),{colorBgLayout:d}=te(),u=g=>{g&&g!==e&&l({key:g,label:""})},p=(g,h)=>{h==="remove"&&a(g)},y=()=>{o.emit("reload",e)},k=g=>{const h=g;m(h),o.emit("fullScreen",h)},b=()=>f(O,{size:0,children:[t(de,{title:"刷新当前页面",children:t(S,{onClick:y,type:"link",style:{color:c},icon:t(yt,{})})}),(()=>i?t(de,{title:"退出全屏",children:t(S,{onClick:()=>k(!1),type:"link",style:{color:c},icon:t(je,{})})}):t(de,{title:"全屏",children:t(S,{onClick:()=>k(!0),type:"link",style:{color:c},icon:t(qe,{})})}))()]}),I={backgroundColor:d,left:i?0:void 0};return t(Ve,{className:"tabs-wrapper",type:"editable-card",hideAdd:!0,activeKey:r,items:[...n],onChange:u,onEdit:p,tabBarExtraContent:t(b,{}),style:I})};const qn=({children:e})=>{const{pathname:n,search:r}=ne(),{addTab:a,hasTab:o,openTab:l,tabs:c,tabEvent:i,whiteList:m}=s.useContext(fe),{mapPathToMenu:d}=s.useContext(z),u=s.useRef(null),[p,{toggleFullscreen:y}]=Be(u),{colorBgLayout:k}=te(),[b]=se(),I=bt(),g=v=>{var L;let x="";const w=v.split("/").filter(N=>N);for(let N=0;N<w.length;N++){const Me=`/${w.slice(0,N+1).join("/")}`;d.has(Me)&&(x=((L=d.get(Me))==null?void 0:L.label)||x)}return x},h=()=>{if(m.includes(n))return;let v=n;n===D&&(v=b.get("url")||"");const x=d.get(v),w=x?n===D?n+r:x.key:n;if(o(w)){l(w);return}if(!x||!x.path){let L=g(v);if(!L)L="404",n===D&&(L="Iframe 页面");else{const{params:{id:N=void 0}}=I.pop()||{params:{id:void 0}};N&&(L+=": "+N)}a({label:L,key:w,queryString:r,children:null});return}a({label:x.label,key:w,queryString:n===D?"":r,children:null})};return s.useEffect(()=>{h()},[n,r]),s.useEffect(()=>{},[r]),s.useEffect(()=>{const v=i.on("fullScreen",x=>{y()});return()=>{v()}},[]),f(R.Content,{className:"content",ref:u,style:{backgroundColor:k},children:[c.length?t(jn,{}):null,c.length?t(st,{}):null,t(Vn,{})]})},Kn=V.memo(qn),lt=()=>{const{settings:{showFooter:e}}=s.useContext(j),{Text:n,Link:r}=E;return e?f(R.Footer,{style:{textAlign:"center",paddingBottom:4},children:[f(n,{type:"secondary",children:["React Admin Template",t(r,{href:"https://github.com/xstnet/react-admin-template",target:"_blank",style:{color:"inherit",marginLeft:5},children:t(kt,{})})]}),t("br",{}),t(r,{href:"https://github.com/xstnet",target:"_blank",children:t(n,{type:"secondary",children:"醉丶春风"})}),f(n,{type:"secondary",children:["©2023 Created by",t(r,{target:"_blank",href:"https://ant-design.antgroup.com/index-cn",style:{margin:"0 6px",color:"inherit"},children:"Ant Design"}),"V5"]})]}):null};const $=vt({scriptUrl:H.iconFontUrl,extraCommonProps:{}}),Gn=()=>{const{fullScreen:e,setFullScreen:n}=s.useContext(Y),r=()=>{B.success(e?"已退出全屏模式":"进入全屏模式"),n(!e)};return e?t(je,{title:"退出全屏模式",className:"action-icon",onClick:r}):t(qe,{title:"进入全屏模式",className:"action-icon",onClick:r})},Yn=()=>t(E.Link,{className:"action-icon",target:"_blank",style:{color:"inherit"},href:"https://github.com/xstnet/react-admin-template",children:t(Ct,{})}),Wn=[[2,1,"刚刚"],[60,1,"%d秒前"],[3600,60,"%d分钟前"],[86400,3600,"%d小时前"],[86400*30,3600*24,"%d天前"],[86400*30*12,3600*24*30,"%d月前"],[1/0,3600*24*30*12,"%d年前"]],Jn=[[-60,1,"%d秒后"],[-3600,60,"%d分钟后"],[-86400,3600,"%d小时后"],[-(86400*30),3600*24,"%d天后"],[-(86400*30*12),3600*24*30,"%d月后"],[-1/0,3600*24*30*12,"%d年后"]],Qn=({time:e,...n})=>{const r=Math.floor(new Date().getTime()/1e3),a=Math.floor(new Date(e).getTime()/1e3),o=r-a;if(isNaN(a))return t(U,{children:"time"});const l=o<-1?Jn:Wn;let c="";for(const[i,m,d]of l)if(Math.abs(o)<Math.abs(i)){const u=Math.floor(Math.abs(o)/m);c=d.replace("%d",String(u));break}return t(de,{title:e,children:t("span",{...n,children:c})})},Zn=()=>t(ee,{size:"small",itemLayout:"horizontal",dataSource:[{title:"张三 评论了你",desc:"评论内容评论内容评论内容",createTime:"2023-04-06 15:39:00"},{title:"您有3个订单待支付",desc:"订单1,订单2,订单3",createTime:"2023-04-05 15:39:00"},{title:"张三 的请假申请需要您的审批",desc:"",createTime:"2023-04-01 12:08:00"},{title:"本周周报待填写",createTime:"2023-03-02 10:55:00",desc:"说明"}],renderItem:n=>t(ee.Item,{children:t(ee.Item.Meta,{avatar:t(xe,{size:48,icon:t(Ke,{})}),title:t("a",{href:"https://ant.design",children:n.title}),description:f("div",{children:[n.desc,n.desc&&t("br",{}),t(E.Text,{children:t(Qn,{style:{fontSize:12},time:n.createTime})})]})})})}),Xn=()=>t(ee,{size:"small",itemLayout:"horizontal",dataSource:[{title:"您有一封新的邮件",type:"mail"},{title:"您有3个订单待支付",type:"payment"},{title:"张三 的请假申请需要您的审批",type:"workflow"},{title:"本周周报待填写",type:"common"}],renderItem:n=>t(ee.Item,{children:t(ee.Item.Meta,{avatar:t($,{style:{fontSize:30},type:`icon-${n.type}`}),title:t("a",{href:"https://ant.design",children:n.title}),description:"3天前"})})}),er=()=>f(U,{children:[t(Ve,{centered:!0,style:{width:300},defaultActiveKey:"notify",items:[{key:"notify",label:"通知(3)",children:t(Xn,{})},{key:"message",label:"消息(4)",children:t(Zn,{})}],onChange:void 0,tabBarExtraContent:t(S,{type:"link",style:{marginRight:10},children:"清空"})}),t(K,{style:{margin:"8px 0"}}),f(O,{split:t(K,{type:"vertical"}),style:{width:"100%",justifyContent:"center",marginBottom:0},children:[t(S,{type:"link",children:"全部已读"}),t(S,{type:"link",children:"查看更多"})]})]}),tr=e=>t(be,{count:98,children:t(xt,{arrow:!1,content:t(er,{}),placement:"bottomRight",trigger:"click",children:t($,{title:"通知提醒",type:"icon-notify",className:"action-icon"})})}),nr=()=>t($,{title:"搜索",type:"icon-search",className:"action-icon"}),rr=()=>{const{settings:{theme:e},setSetting:n}=s.useContext(j),r=()=>{n({followSystemTheme:!1,theme:e==="light"?"dark":"light"})};return e==="dark"?t($,{onClick:r,title:"主题-深色模式",type:"icon-theme-dark",className:"action-icon"}):t($,{onClick:r,title:"主题-明亮模式",type:"icon-theme-light",className:"action-icon"})};const ar=e=>{const n=["#1890ff","#722ed1","#eb2f96","#00b96b","#52c41a","#13c2c2","#1677ff","#f5222d","#fa8c16","#faad14"],{onChange:r,presetColors:a=n,defaultSelectedColor:o=""}=e,{value:l=o}=e,[c,i]=s.useState(l),m=d=>{i(d),r==null||r(d)};return t("div",{className:"theme-color-wrap",children:a.map(d=>t("div",{onClick:()=>m(d),className:"theme-color-item",style:{backgroundColor:d},title:d,children:c===d&&t(St,{className:"checked-icon"})},d))})},or=e=>{const{open:n,onClose:r=q}=e,{settings:a,setSetting:o}=s.useContext(j),[l]=C.useForm(),[c]=tt(),i=s.useMemo(()=>({...a,theme:a.followSystemTheme?"followSystem":a.theme}),[a]),m=(d,u)=>{const p={...d},{theme:y,fixedMenu:k,fixedHeader:b}=p;y&&(console.log("themeee",y),p.followSystemTheme=!1,y==="followSystem"&&(p.followSystemTheme=!0,p.theme=c)),k&&(p.fixedHeader=!0),b===!1&&(p.fixedMenu=!1),o(p),console.log("chage",d,u)};return oe(()=>{l==null||l.setFieldsValue(i)},[i]),t(Tt,{title:"偏好设置",onClose:r,open:n,children:f(C,{name:"basic",labelCol:{span:5},wrapperCol:{span:19},initialValues:{...i},autoComplete:"off",onValuesChange:m,form:l,children:[t(C.Item,{label:"外观",name:"theme",children:f(A.Group,{buttonStyle:"solid",children:[f(A.Button,{value:"light",children:[t($,{type:"icon-theme-light"})," 浅色"]}),f(A.Button,{value:"dark",children:[t($,{type:"icon-theme-dark"})," 深色"]}),f(A.Button,{value:"followSystem",children:[t($,{type:"icon-followSystem"})," 跟随系统"]})]})}),t(C.Item,{label:"紧凑模式",valuePropName:"checked",name:"compactMode",children:t(re,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),t(C.Item,{label:"主题色",name:"primaryColor",children:t(ar,{defaultSelectedColor:a.primaryColor})}),t(K,{children:"布局"}),t(C.Item,{label:"多标签页",valuePropName:"checked",name:"multitabMode",children:t(re,{checkedChildren:"启用",unCheckedChildren:"关闭"})}),t(C.Item,{label:"固定头部",valuePropName:"checked",name:"fixedHeader",children:t(re,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),t(C.Item,{help:"固定菜单启用时, 头部也会同步固定",label:"固定菜单",valuePropName:"checked",name:"fixedMenu",children:t(re,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),t(C.Item,{valuePropName:"checked",label:"显示底部",name:"showFooter",children:t(re,{checkedChildren:"开启",unCheckedChildren:"关闭"})})]})})},sr=e=>{const[n,r]=s.useState(!1);return f("div",{children:[t(or,{open:n,onClose:()=>{r(!1)}}),t($,{onClick:()=>{r(!0)},title:"设置",type:"icon-setting",className:"action-icon"})]})},lr=()=>{const{userInfo:e,setUserInfo:n,setIsLogin:r}=s.useContext(Y),{menuCollapsed:a,setMenuCollapsed:o}=s.useContext(z),{token:{colorBgContainer:l}}=W.useToken(),c=Q(),i=()=>f("div",{className:"left",children:[f("div",{className:"logo",children:[t($,{type:"icon-react",className:"logo-img"}),t("span",{className:"logo-text",children:"React Admin Template"})]}),t("div",{children:V.createElement(a?It:Mt,{onClick:()=>o(!a)})})]}),m=()=>{const d=()=>f(U,{children:[t(nr,{}),t(tr,{}),t(Gn,{}),t(Yn,{}),t(rr,{}),t(sr,{})]}),u=[{label:t("a",{children:"个人中心"}),icon:t(Ke,{}),key:"userCenter"},{label:t("a",{children:"修改资料"}),key:"update",icon:t(Ge,{})},{type:"divider"},{label:"退出",icon:t(wt,{}),key:"logout",onClick:()=>{Cn().then(()=>{_.removeToken(),r(!1),n(null),c("/login")})}}];return t("div",{className:"right",children:f(O,{size:"middle",children:[d(),t(Pt,{menu:{items:u},children:f(O,{className:"pointer",children:[t("span",{children:e==null?void 0:e.nickname}),t(xe,{src:e==null?void 0:e.avatar})]})})]})})};return t(R.Header,{className:"header",style:{background:l},children:f(U,{children:[i(),m()]})})},ct=V.memo(lr),cr=()=>{const e=Q(),{pathname:n}=ne(),[r,a]=s.useState(),{menuList:o,mapPathToMenu:l}=s.useContext(z);let c="/dashboard",i=[],m=!1;const[d]=se();oe(()=>{let y=l.get(n);if(!y){let k="";l.forEach(({path:b})=>{n.startsWith(b)&&b.length>k.length&&(k=b)}),k&&(y=l.get(k))}y&&(y!=null&&y.hideInMenu?a([y.parent]):a([n]))},[n]);const u=y=>{const k=l.get(y.key);if(console.log("clicked menu",y,k),!k){console.warn("未获取到菜单信息");return}if(k.path!==n){if((k==null?void 0:k.type)==="url"){window.open(k.path,"_blank");return}if(document.title=`${H.pageTitlePrefix} - ${k.label}`,(k==null?void 0:k.type)==="iframe"){console.log("打开iframe页面"),e(ot(k.path));return}e(k.path)}},p=s.useMemo(()=>{const y=b=>b.badge?b.badge==="dot"?t(be,{className:"menu-item-badge",offset:[6,0],dot:!0,children:b.label}):t(be,{className:"menu-item-badge",offset:[15,0],count:b.badge,children:b.label}):b.label,k=(b,I)=>{const g=[];return!m&&I&&i.push(I.key),b.map(h=>{if(pe(h)&&(h.parent&&n.indexOf(h.path)===0&&(console.log("ccccccccccccccccccccc",h.parent),c=h.parent,m=!0),h.type==="iframe"&&(d.get("url")||"")===h.path&&(m=!0,c=h.key),h.hideInMenu))return;let v;if(En(h))v={...h};else if(ge(h))v={...h},h.children&&h.children.length>0&&(v.children=k(h.children));else if(he(h)||at(h)){let{icon:x}=h;typeof x=="string"&&x.includes("icon-")&&(x=t($,{type:x})),v={key:"",...h,icon:x,label:y(h),children:he(h)?k(h.children,h):void 0},!m&&h.path===n&&(c=h.key,m=!0)}v&&(v.key=v.key,g.push(v))}),!m&&i.pop(),g};return k(o)},[o]);return t(Lt,{style:{height:"100%"},onClick:u,mode:"inline",defaultSelectedKeys:[c],selectedKeys:r,items:p,defaultOpenKeys:i})},ir=V.memo(cr);const it=()=>{const{menuCollapsed:e}=s.useContext(z),{colorBgContainer:n}=te();return t(R.Sider,{style:{background:n},trigger:null,className:"left-sider",collapsible:!0,collapsed:e,children:t(ir,{})})};const dr=()=>{console.log("MultitabLayout render...");const{menuCollapsed:e}=s.useContext(z);return t(_n,{children:f(R,{className:"multitab-layout","data-menu-collapsed":e?1:0,children:[t(ct,{}),f(R,{children:[t(it,{}),f(R,{className:"content-layout",children:[t(Kn,{}),t(lt,{})]})]})]})})},ur=V.memo(dr);const mr=({children:e})=>t(R.Content,{className:"content",children:e}),hr=V.memo(mr);const pr=()=>{console.log("SingleLaylut render...");const{menuCollapsed:e}=s.useContext(z);return f(R,{className:"single-tab-layout","data-menu-collapsed":e?1:0,children:[t(ct,{}),f(R,{children:[t(it,{}),f(R,{className:"content-layout",children:[t(st,{}),t(hr,{children:t(Nt,{})}),t(lt,{})]})]})]})};const gr=()=>{const[e,n]=s.useState(!0),{setIsLogin:r,setUserInfo:a}=s.useContext(Y),{colorBgContainer:o}=te(),{settings:{multitabMode:l,fixedMenu:c,fixedHeader:i,theme:m}}=s.useContext(j),d=Q(),[u]=se();return console.log("global layout render..."),s.useEffect(()=>{if(!$e()){d("/login");return}vn().then(p=>{if(n(!1),r(!0),a(p),u.has("ghpage")){const y=decodeURIComponent(u.get("ghpage"));d(y);return}}).catch(p=>{p instanceof At&&He.error({message:"网络错误",description:"获取用户信息失败, 无法打开页面",duration:null,closeIcon:null})})},[]),oe(()=>{$e()||(B.error("登录状态已失效, 即将跳转到登录页面..."),setTimeout(()=>{d("/login")},500))}),e?t(Ie,{title:"页面加载中",loading:e}):t(On,{children:f("div",{"data-fixed-menu":c?1:0,"data-fixed-header":i?1:0,style:{background:o},className:`global-layout theme-${m}`,children:[l?t(ur,{}):t(pr,{}),t(An,{})]})})},fr=V.memo(gr),Fe=()=>t("span",{children:"UserCenterPage"}),yr=()=>t("span",{children:"UserCenterUpdatePage"});const dt=s.forwardRef(({state:e},n)=>{const[r]=C.useForm(),a=s.useRef(null);return s.useImperativeHandle(n,()=>({form:r,input:a.current}),[r,a]),t("div",{children:f(C,{form:r,labelCol:{span:3},name:"userForm",initialValues:e||void 0,children:[t(C.Item,{name:"username",label:"账号",rules:[{required:!0,message:"请输入账号"}],children:t(P,{placeholder:"请输入账号",ref:a})}),t(C.Item,{name:"password",label:"密码",rules:[{required:!e,message:"请输入密码"}],children:t(P.Password,{placeholder:e?"不修改密码请留空!":"请输入密码"})}),t(C.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入昵称"}],children:t(P,{placeholder:"请输入昵称"})}),t(C.Item,{name:"gender",label:"性别",children:f(A.Group,{children:[t(A,{value:1,children:"男"}),t(A,{value:2,children:"女"})]})}),t(C.Item,{name:"mobile",label:"手机号",children:t(P,{placeholder:"请输入手机号"})}),t(C.Item,{name:"email",label:"邮箱",children:t(P,{placeholder:"请输入邮箱"})})]})})}),br=({refreshList:e})=>{const[n,r]=s.useState(!1),{run:a,loading:o}=J(Sn,{manual:!0,debounceWait:100,onSuccess:()=>{var i;r(!1),(i=l.current)==null||i.form.resetFields(),e==null||e()}}),l=s.useRef(null);return f("div",{children:[t(S,{type:"primary",icon:t(Se,{}),onClick:()=>{r(!0),setTimeout(()=>{var i,m;(m=(i=l.current)==null?void 0:i.input)==null||m.focus()},100)},children:"新增用户"}),t(Ye,{open:n,title:"添加用户",okText:"添加",cancelText:"取消",confirmLoading:o,onCancel:()=>r(!1),onOk:()=>{var i;(i=l.current)==null||i.form.validateFields().then(m=>{a(m)}).catch(m=>console.log(m))},children:t(dt,{ref:l})})]})},kr=(e,n)=>{const r=Rt(e,n),{tableProps:a}=r,o={...a.pagination,showTotal:(i,m)=>`第${m[0]}-${m[1]} 条/共 ${i} 条`,hideOnSinglePage:!0};a.pagination=o;const l=a.onChange,c=(...i)=>{var I;let[m,d,u,p]=i,y=m,k,b;Object.keys(u).length>0&&(Array.isArray(u)?(b={},u.map(g=>{var h;b[(h=g.column)==null?void 0:h.dataIndex]=g.order})):b={[(I=u.column)==null?void 0:I.dataIndex]:u.order}),Object.keys(d).length>0&&(k=d,console.log("filterrrrrrrrrrrrr",d)),l(y,k,b)};return a.onChange=c,r.tableProps.size="small",r},vr=({state:e,refreshList:n})=>{const[r,a]=s.useState(!1),{runAsync:o,loading:l}=J(Tn,{manual:!0,debounceWait:100}),c=s.useRef(null);return f(U,{children:[t(S,{icon:t(Ge,{}),size:"small",onClick:()=>{a(!0),setTimeout(()=>{var m,d;(d=(m=c.current)==null?void 0:m.input)==null||d.focus()},100)},children:"编辑"}),t(Ye,{open:r,title:"更新用户信息",okText:"保存",cancelText:"取消",confirmLoading:l,onCancel:()=>a(!1),onOk:()=>{var m;(m=c.current)==null||m.form.validateFields().then(d=>{o({...d,id:e.id}).then(()=>{var u;a(!1),(u=c.current)==null||u.form.resetFields(),n==null||n()}).catch(q)}).catch(d=>console.log(d))},children:t(dt,{ref:c,state:e})})]})};const Z=e=>{const{children:n,className:r="",style:a={},...o}=e,{colorBgContainer:l}=te(),c="content-box",i={backgroundColor:l};return t("div",{className:`${c} ${r}`,style:{...i,...a},...o,children:n})},Cr=e=>{const{search:n,form:r,onSearch:a,onReset:o,fields:l,title:c="搜索",...i}=e,m=s.useCallback((b,I,g)=>{switch(typeof I=="string"&&["input","number","select"].includes(b)&&(g.placeholder=(g==null?void 0:g.placeholder)||I),b){case"input":return t(P,{...g});case"number":return t(Et,{...g});case"select":return t(Te,{...g});case"radio":return t(A.Group,{...g});case"date":return t(Pe,{...g});case"dateRange":return t(Pe.RangePicker,{...g});case"checkbox":return t(Je.Group,{...g});case"cascader":return t($t,{...g});case"treeSelect":return t(We,{...g});default:return t(U,{})}},[]),d=async()=>{await r.validateFields().catch(b=>console.warn(b)),a==null||a(r),n.submit()},u=()=>{o==null||o(r),n.reset()},p={labelCol:{span:5},style:{paddingTop:16}},y=({type:b,name:I,label:g,fieldProps:h={},itemProps:v={}})=>t(me,{span:6,children:t(C.Item,{name:I,label:g,...v,children:m(b,g,h)})},`${I}-${g}`),k=()=>{const b=n.type==="simple"?0:18-l.length%4*6;return f(me,{span:6,offset:b,style:{textAlign:"right"},children:[t(S,{onClick:u,children:"重置"}),t(S,{style:{margin:"0 8px"},type:"primary",onClick:d,children:"查询"}),l.length>3&&f("a",{style:{fontSize:12},onClick:n.changeType,children:[n.type==="advance"?t(Ft,{}):t(Ot,{}),n.type==="advance"?"收起":"展开"]})]})};return l.length===0?null:f(Z,{children:[t("div",{children:t(E.Title,{level:5,children:c})}),t(C,{form:r,...p,...i,children:f(Qe,{gutter:24,children:[n.type==="advance"?l.map(y):l.slice(0,3).map(y),k()]})})]})},xr=()=>{var g;console.log("render ExampleUserListPage");const[e]=C.useForm(),[n,r]=s.useState([]),a=s.useRef();s.useEffect(()=>{a.current=new Map},[]);const{runAsync:o,loading:l}=J(In,{manual:!0,debounceWait:100}),{refresh:c,tableProps:i,search:m}=kr(xn,{form:e}),d=()=>{m.reset(),m.submit()},u=h=>{var v;typeof h=="number"&&((v=a==null?void 0:a.current)==null||v.set(h,!0)),o({id:h}).then(()=>{typeof h=="object"&&r([]),c()}).finally(()=>{var x;return typeof h=="number"&&((x=a==null?void 0:a.current)==null?void 0:x.delete(h))})},p=s.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"账号",dataIndex:"username",render:(h,{avatar:v,username:x})=>f(U,{children:[" ",t(xe,{src:v})," ",x]})},{title:"昵称",dataIndex:"nickname"},{title:"性别",dataIndex:"gender",render:h=>h===nt.male?t(we,{color:"blue",children:"男"}):t(we,{color:"error",children:"女"})},{title:"邮箱",dataIndex:"email"},{title:"手机号",dataIndex:"mobile",sorter:!0},{title:"注册时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(h,v)=>{var w;const{id:x}=v;return f(O,{children:[t(Le,{title:"确认要删除这条数据吗?",onConfirm:()=>u(x),children:t(S,{loading:(w=a==null?void 0:a.current)==null?void 0:w.has(x),icon:t(Ut,{}),size:"small",danger:!0,children:"删除"})}),t(vr,{state:v,refreshList:c})]})}}],[]),k={selectedRowKeys:n,onChange:h=>{console.log("selectedRowKeys changed: ",h),r(h)}},b=n.length>0;return f(U,{children:[t(Cr,{form:e,search:m,fields:[{type:"input",label:"账号",name:"username"},{type:"input",label:"手机号",name:"mobile"},{type:"input",label:"邮箱",name:"email"},{type:"select",label:"性别",name:"gender",fieldProps:{options:[{label:"男",value:"1"},{label:"女",value:"2"}]}}]}),t("br",{}),f(Z,{children:[f("div",{className:"table-header",children:[t("div",{className:"left",children:t(E.Title,{level:5,children:"用户列表"})}),t("div",{className:"right",children:f(O,{size:"middle",children:[t(Le,{title:`确定要删除这${n.length}条数据吗?`,onConfirm:()=>u(n),children:t(S,{type:"primary",danger:!0,disabled:!b,loading:l&&((g=a.current)==null?void 0:g.size)===0,children:"批量删除"})}),t(br,{refreshList:d}),t(S,{type:"link",title:"点击刷新",onClick:c,icon:t(_t,{})})]})})]}),t(Bt,{rowKey:"id",rowSelection:k,columns:p,...i})]})]})},ie=({title:e="空白页"})=>{const[n,r]=s.useState(0);return se(),console.log("BlankPage: 被调用"),s.useEffect(()=>(console.log("BlankPage: 初次渲染"),()=>{console.log("BlankPage: 被卸载了")}),[]),f(Z,{style:{height:"500px"},children:[t(E.Title,{level:4,children:e}),f(E.Text,{children:["Count: ",n]}),t("br",{}),t(S,{onClick:a=>r(o=>o+1),children:"add"})]})},Sr=()=>{const{pathname:e}=ne();return t(Dt,{status:"404",title:"404",subTitle:`页面不存在, 当前路由: ${e}`,extra:t(S,{type:"primary",children:t(ye,{to:"/",children:"返回首页"})})})};const Tr=s.forwardRef((e,n)=>{const r="MdEditorDraft",a=s.useRef(null),o=s.useRef(),{height:l=600,value:c="",onChange:i=q,contentType:m="markdown"}=e,{settings:{theme:d}}=s.useContext(j);s.useImperativeHandle(n,()=>({editor:o.current,container:a.current||void 0,getMarkdown:()=>{var p;return((p=o.current)==null?void 0:p.getMarkdown())||""},getHTML:()=>{var p;return((p=o.current)==null?void 0:p.getHTML())||""},clearDraft:()=>{localStorage.removeItem(r)},setMarkdown:p=>{var y;(y=o.current)==null||y.setMarkdown(p)}}),[o.current,a.current]);const u=()=>new Ht({initialValue:c,height:`${l}px`,initialEditType:"markdown",previewStyle:"vertical",plugins:[zt],language:"zh-CN",useCommandShortcut:!0,extendedAutolinks:!0,el:a.current,hideModeSwitch:!0,theme:d==="dark"?"dark":void 0});return s.useEffect(()=>{var k;o.current=u(),o.current.addHook("addImageBlobHook",(b,I,g)=>{const h=document.getElementById("toastuiAltTextInput"),v=(h==null?void 0:h.value)||"image",x=new FileReader;x.onload=w=>{var N;const L=(N=w.target)==null?void 0:N.result;console.log("Base64 encoded string:",L),I(L,v)},x.readAsDataURL(b)}),o.current.eventEmitter.listen("change",b=>{var I,g;i(m==="markdown"?((I=o.current)==null?void 0:I.getMarkdown())||"":((g=o.current)==null?void 0:g.getHTML())||"",b)});let p=setInterval(()=>{if(!o.current)return;const b=o.current.getMarkdown();localStorage.setItem(r,b),console.log("已保存到草稿箱!")},15*1e3);const y=localStorage.getItem(r);return y&&((k=o.current)==null||k.setMarkdown(y),console.log("已从草稿箱加载数据!")),()=>{p&&clearInterval(p)}},[]),oe(()=>{var y,k;const p=(y=o.current)==null?void 0:y.getMarkdown();(k=o.current)==null||k.destroy(),o.current=u(),o.current.setMarkdown(p||"")},[d]),oe(()=>{var p;(p=o.current)==null||p.setMarkdown(c)},[c]),t("div",{style:{backgroundColor:"#fff"},ref:a})}),Ir=()=>{const[e]=C.useForm(),n=s.useRef(null),r=Q(),a="articleDraft",{loading:o,run:l}=J(Pn,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{var u;(u=n.current)==null||u.clearDraft(),r("/article/list")},200)}),{data:c,loading:i}=J(Ln);s.useEffect(()=>{const u=_.getObject(a)||{},p={status:200,comment_control:[1,2],description:"",source:"",author:"醉丶春风",sort_value:100};e.setFieldsValue({...p,...u})},[]);const m=async(u=!1)=>{var y;const p=await e.validateFields();p.content=((y=n.current)==null?void 0:y.getHTML())||"",p.is_draft=u?1:0,console.log("formData",p),l(p)},d=u=>(console.log("Upload event:",u),Array.isArray(u)?u:u&&u.fileList);return f(Z,{children:[t(E.Title,{level:3,children:"发布文章"}),t(K,{}),f(C,{form:e,name:"createForm",labelCol:{span:2},children:[t(C.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:t(P,{})}),t(C.Item,{label:"封面",name:"cover",getValueFromEvent:d,valuePropName:"fileList",children:t(Ze,{maxCount:1,listType:"picture-card",accept:"image/*",children:f("div",{children:[t(Se,{}),t("div",{style:{marginTop:8},children:"选择图片"})]})})}),t(C.Item,{label:"标签",name:"tags",children:t(Te,{mode:"tags",placeholder:"文章标签",style:{width:400}})}),t(C.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:t(P,{style:{width:200}})}),t(C.Item,{label:"简介",name:"description",children:t(P.TextArea,{rows:3})}),t(C.Item,{label:"内容",name:"markdown_content",children:t(Tr,{ref:n})}),t(C.Item,{name:"category_id",label:"分类",rules:[{required:!0,message:"请选择分类!"}],children:t(We,{dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"请选择分类",fieldNames:{label:"name",value:"id"},allowClear:!0,treeDefaultExpandAll:!0,loading:i,treeData:c})}),t(C.Item,{name:"status",label:"状态",initialValue:200,children:f(A.Group,{children:[t(A,{value:200,children:"显示"}),t(A,{value:900,children:"不显示"})]})}),t(C.Item,{name:"comment_control",label:"评论控制",initialValue:[1,2],children:t(Je.Group,{options:[{label:"显示评论",value:1},{label:"允许评论",value:2}]})}),t(C.Item,{label:"来源",name:"source",children:t(P,{style:{width:200}})}),t(C.Item,{label:"排序",name:"sort_value",children:t(P,{style:{width:200}})}),t(C.Item,{wrapperCol:{offset:3},children:f(O,{children:[t(S,{icon:t(Xe,{}),onClick:()=>m(),loading:o,type:"primary",children:"发布文章"}),t(S,{icon:t(Vt,{}),loading:o,onClick:()=>m(!0),children:"保存为草稿"})]})})]})]})},Mr=()=>{const[e]=C.useForm(),n=Q(),r=jt(),{loading:a,run:o}=J(Mn,{manual:!0,debounceWait:10,onSuccess:d=>e.setFieldsValue(d)});s.useEffect(()=>{o({id:r.id})},[r.id]);const{loading:l,run:c}=J(wn,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{n("/article/list")},200)}),i=async()=>{const d=await e.validateFields();c(d)},m=d=>(console.log("Upload event:",d),Array.isArray(d)?d:d&&d.fileList);return f(Z,{children:[t(E.Title,{level:3,children:"更新文章"}),t(K,{}),t(De,{spinning:a,children:t(C,{form:e,name:"createForm",labelCol:{span:3},children:f(Qe,{gutter:36,children:[f(me,{span:16,children:[t(C.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:t(P,{})}),t(C.Item,{label:"简介",name:"description",children:t(P,{})}),t(C.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:t(P.TextArea,{rows:20})}),t(C.Item,{wrapperCol:{offset:3},children:t(O,{children:t(S,{icon:t(Xe,{}),onClick:i,loading:l,type:"primary",children:"保存"})})})]}),f(me,{span:8,children:[t(C.Item,{label:"封面",name:"cover",getValueFromEvent:m,valuePropName:"fileList",children:t(Ze,{maxCount:1,listType:"picture-card",children:f("div",{children:[t(Se,{}),t("div",{style:{marginTop:8},children:"选择图片"})]})})}),t(C.Item,{label:"标签",name:"tags",children:t(Te,{mode:"tags",placeholder:"文章标签"})}),t(C.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:t(P,{})})]})]})})})]})},Pr=()=>t("span",{children:"分类管理页面"}),wr=()=>{const{userInfo:e,setUserInfo:n}=s.useContext(Y),r=a=>{n({...e,roles:[a]})};return f(Z,{children:[f(E.Text,{children:["当前权限: ",JSON.stringify(e==null?void 0:e.roles)]}),t(K,{}),f(S.Group,{children:[t(S,{type:"primary",onClick:()=>r("admin"),children:"切换为 Admin"}),t(S,{onClick:()=>r("guest"),children:"切换为 Guest"})]})]})},Oe=({children:e,role:n})=>{const{userInfo:r}=s.useContext(Y);return rt(n,r)?t(U,{children:e}):null},Lr=()=>{const{userInfo:e,setUserInfo:n}=s.useContext(Y),r=a=>{n({...e,roles:[a]})};return f(Z,{children:[f(E.Text,{children:["当前权限: ",JSON.stringify(e==null?void 0:e.roles)]}),t(K,{}),f(S.Group,{children:[t(S,{type:"primary",onClick:()=>r("admin"),children:"切换为 Admin"}),t(S,{onClick:()=>r("guest"),children:"切换为 Guest"})]}),t(K,{}),f(O,{children:[t(Oe,{role:"admin",children:t(S,{type:"primary",children:"Admin menu"})}),t(Oe,{role:"guest",children:t(S,{children:"Guest menu"})})]})]})},Nr=s.lazy(()=>le(()=>import("./index-0dedfc1e.js"),["assets/index-0dedfc1e.js","assets/vendor-53b41d67.js","assets/vendor-3c51b279.css"])),Ue=s.lazy(()=>le(()=>import("./index-d05e4aae.js"),["assets/index-d05e4aae.js","assets/vendor-53b41d67.js","assets/vendor-3c51b279.css"])),Ar=s.lazy(()=>le(()=>import("./index-48b0129e.js"),["assets/index-48b0129e.js","assets/vendor-53b41d67.js","assets/vendor-3c51b279.css","assets/index-5c0cb4e1.css"])),Rr=s.lazy(()=>le(()=>import("./index-90cf3d35.js"),["assets/index-90cf3d35.js","assets/vendor-53b41d67.js","assets/vendor-3c51b279.css","assets/index-19ead691.css"])),$r=s.lazy(()=>le(()=>import("./index-f4f339c4.js"),["assets/index-f4f339c4.js","assets/vendor-53b41d67.js","assets/vendor-3c51b279.css","assets/index-c11d3a46.css"])),X=({children:e})=>t(V.Suspense,{fallback:t(Ie,{}),children:e});function Er(){return[{path:"/login",element:t(X,{children:t(Ar,{})})},{path:"/",element:t(fr,{}),children:[{path:"/",element:t(hn,{to:"/dashboard"})},{path:"/dashboard",element:t(X,{children:t(Rr,{})})},{path:"/user",children:[{index:!0,element:t(Fe,{})},{path:"/user/center/index",element:t(Fe,{})},{path:"/user/center/update",element:t(yr,{})}]},{path:"/example",children:[{path:"/example/userList",element:t(xr,{})},{path:"/example/tabs/manage",element:t(X,{children:t(Nr,{})})},{path:"/example/permission",children:[{path:"/example/permission/menu",element:t(wr,{})},{path:"/example/permission/button",element:t(Lr,{})}]}]},{path:"/article",children:[{index:!0,element:t(X,{children:t(Ue,{})})},{path:"/article/list",element:t(X,{children:t(Ue,{})})},{path:"/article/category",element:t(Pr,{})},{path:"/article/create",element:t(Ir,{})},{path:"/article/update/:id",element:t(Mr,{})}]},{path:"/blank",element:t(ie,{})},{path:"/badge/dot",element:t(ie,{title:"红点徽标"})},{path:"/badge/count",element:t(ie,{title:"数字徽标"})},{path:D,element:t(X,{children:t($r,{})})},{path:"/multilevel/menu/2/3",element:t(ie,{title:"三级菜单"})},{path:"*",element:t(Sr,{})}]}]}const Fr=qt(Er(),{basename:"/react-admin-template/"});function Or(){return s.useEffect(()=>{},[]),t(dn,{children:t(Kt,{router:Fr})})}function _e(e){const n=JSON.stringify({type:"JWT",alg:"HS256"}),r=Number((new Date().getTime()/1e3).toFixed(0)),a=JSON.stringify({iss:"github.com/xstnet",sub:"react-admin",iat:r,exp:r+86400*14,data:e}),o="H_97UyQUOmURnZdDwI0khuAt4Cmg";return`${Ne(n)}.${Ne(a)}.${o}`}T.mock(/api\/login/,"post",({body:e})=>{const{username:n,password:r}=JSON.parse(e);return n==="admin"?r!=="123456"?{code:-1,message:"密码错误"}:{code:0,message:"登录成功",data:{token:_e({uid:1})}}:{code:0,message:"登录成功",data:{token:_e({uid:F.Random.natural(2,1e4)})}}});T.setup({timeout:100});T.mock(/api\/user\/info/,"get",e=>({code:0,message:"ok",data:{id:1,username:"admin",nickname:"醉丶春风",avatar:"https://www.xstnet.com/static/images/head.gif",password:"",gender:F.Random.natural(1,2),email:"shantongxu@qq.com",mobile:"133xxxx3333",roles:["admin"]}}));T.mock(/api\/user\/logout/,"post",e=>({code:0,message:"退出成功"}));T.mock(/api\/user\/list/,"get",e=>{const n=new URLSearchParams(e.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,username:"@first@last",nickname:"@cname",avatar:()=>F.Random.dataImage("200x200"),email:"@email",mobile:()=>T.mock(/^1[3456789]\d{9}$/).replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"),"gender|1-2":0,create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return T.mock(a)});T.mock(/api\/user\/create/,"post",e=>({code:0,message:"创建成功",data:{id:F.Random.natural(100,9999)}}));T.mock(/api\/user\/update/,"post",e=>({code:0,message:"更新成功"}));T.mock(/api\/user\/delete/,"post",e=>({code:0,message:"删除成功"}));T.setup({timeout:100});T.mock(/api\/article\/detail/,"get",e=>(console.log("🚀 ~ file: article.ts:7 ~ Mock.mock ~ options:",e),{code:0,message:"ok",data:{id:1,title:"主题",description:"醉丶春风",author:"醉丶春风",tags:[1,2],content:"content",create_time:F.Random.datetime()}}));T.mock(/api\/article\/list/,"get",e=>{const n=new URLSearchParams(e.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,author:"@first@last",title:()=>T.Random.ctitle(5,20),description:"@cname",cover:()=>F.Random.dataImage("480x270","封面"),content:"@email",create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return T.mock(a)});T.mock(/api\/article\/create/,"post",e=>({code:0,message:"创建成功",data:{id:F.Random.natural(100,9999)}}));T.mock(/api\/article\/update/,"post",e=>({code:0,message:"更新成功"}));T.mock(/api\/article\/delete/,"post",e=>({code:0,message:"删除成功"}));T.setup({timeout:100});T.mock(/api\/todo\/list/,"get",e=>{const n={code:0,message:"",data:{total:3,list:[{id:Re(100,1e9),name:"全局搜索",status:ae.incomplete,create_time:"2023-04-20",update_time:"2023-04-20"},{id:Re(100,1e9),name:"多tab布局支持",status:ae.completed,create_time:"2023-04-15",update_time:"2023-04-215"},{id:1,name:"这是一个todo例子",status:ae.completed,create_time:"2023-04-10",update_time:"2023-04-10"}]}};return T.mock(n)});T.mock(/api\/todo\/create/,"post",e=>{const n=JSON.parse(e.body);return{code:0,message:"",data:{id:F.Random.natural(100,9999),name:n.name,status:ae.incomplete,create_time:F.Random.now(),update_time:F.Random.now()}}});T.mock(/api\/todo\/update/,e=>({code:0,message:""}));T.mock(/api\/todo\/changeStatus/,"post",e=>({code:0,message:""}));T.mock(/api\/todo\/delete/,"post",e=>({code:0,message:""}));T.setup({timeout:100});T.mock(/api\/category\/treeList/,"get",e=>(console.log("🚀 ~ file: article.ts:7 ~ Mock.mock ~ options:",e),{code:0,message:"ok",data:[{id:1,name:"前端",children:[{id:2,name:"React教程"},{id:3,name:"Vue"},{id:4,name:"Javascript教程"},{id:5,name:"HTML"},{id:6,name:"CSS"}]},{id:7,name:"后端",children:[{id:8,name:"mysql进阶"},{id:9,name:"Vue"},{id:10,name:"SprootBoot"},{id:11,name:"NodeJS从入门到精通"},{id:12,name:"数据库"},{id:14,name:"Linux"}]}]}));Gt.createRoot(document.getElementById("root")).render(t(Or,{}));export{Z as C,pn as D,U as F,fe as M,Qn as R,j as S,ae as T,t as a,Cr as b,H as c,_ as d,_r as e,qr as f,Br as g,te as h,zr as i,f as j,jr as k,Vr as l,Hr as m,q as n,z as o,Dr as p,Re as r,kr as u,$e as v};
