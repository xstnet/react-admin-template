import{j as ge,r as d,C as $e,z as tt,t as H,u as nt,c as rt,R as Q,a as _,b as ie,M as at,B as Se,L as z,d as j,m as O,e as ot,F as p,f as lt,D as it,g as V,S as Z,h as fe,i as st,k as ct,l as w,n as dt,A as Oe,o as ut,p as mt,G as ht,U as pt,E as ye,q as gt,T,s as B,I as x,v as I,P as X,w as De,x as ft,y as be,H as ae,J as Re,K as yt,N as bt,X as vt,Y as kt,O as Be,Q as Ct,V as K,W as C,Z as ee,_ as de,$ as xt,a0 as St,a1 as It,a2 as q,a3 as He,a4 as Mt,a5 as Ie,a6 as ue,a7 as Ke,a8 as qe,a9 as Pt,aa as Tt,ab as G,ac as Ye,ad as Nt,ae as je,af as Ve,ag as Lt,ah as ve,ai as _e,aj as wt,ak as At,al as te,am as Ut,an as Ft,ao as $t,ap as Ot,aq as Dt,ar as Me,as as M,at as E,au as Pe,av as Rt,aw as Bt}from"./vendor-673ef6b0.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(l){if(l.ep)return;l.ep=!0;const o=r(l);fetch(l.href,o)}})();const Y=ge.Fragment,e=ge.jsx,c=ge.jsxs,Te=[{label:"控制台",type:"group",children:[{label:"控制台",icon:"icon-dashboard",path:"/dashboard"}]},{label:"示例页面",type:"group",children:[{label:"列表页",icon:"icon-list",path:"/example/userList"},{label:"多级菜单",icon:"icon-list",path:"/multilevel/menu",children:[{label:"二级菜单",icon:"icon-list",path:"/multilevel/menu/2",children:[{label:"三级菜单",icon:"icon-list",path:"/multilevel/menu/2/3"}]}]},{label:"空白页",icon:"icon-example",path:"/blank"},{label:"404",icon:"icon-example",path:"/404"}]},{label:"徽标示例",type:"group",children:[{label:"红点徽标",icon:"icon-list",badge:"dot",path:"/blank"},{label:"数字徽标",icon:"icon-example",badge:98,path:"/blank"}]},{type:"divider"},{path:"/article",label:"文章管理",icon:"icon-article",children:[{path:"/article/list",label:"文章列表",icon:"icon-article"},{path:"/article/create",label:"发布文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/update",label:"更新文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/category",label:"分类管理",icon:"icon-list"}]},{path:"/iframe",label:"外部页面",icon:"icon-href",children:[{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(外链)",icon:"icon-document",key:"webpage-antd-document",type:"url"},{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(内嵌)",icon:"icon-document",type:"iframe"},{path:"https://www.xstnet.com",label:"博客主页(内嵌)",icon:"icon-document",type:"iframe"}]},{path:"/document",label:"文档",icon:"icon-document",children:[{path:"/document/start",label:"开始使用",icon:"icon-document"},{path:"/document/package.json",label:"Package文件说明",icon:"icon-document"}]},{type:"divider"},{path:"/user/center",label:"个人中心",icon:"icon-user-permissions",children:[{path:"/user/center/index",label:"个人中心",icon:"icon-example"},{path:"/user/center/update",label:"修改信息",icon:"icon-document"}]}];function Ee(t){return!!(typeof t.children>"u"||Array.isArray(t.children)&&t.children.length===0)}function oe(t){return se(t)?!1:!!(typeof t.children<"u"&&Array.isArray(t.children)&&t.children.length>0)}function ke(t){return typeof t.path=="string"&&typeof t.label=="string"}function se(t){return typeof t.type<"u"&&t.type==="group"}function Ht(t){return typeof t.type<"u"&&t.type==="divider"}const Kt=void 0,W=d.createContext(Kt),qt=({children:t})=>{let n=0;const r=d.useMemo(()=>Te,[Te]),[a,l]=d.useState(r),[o,u]=d.useState(!1),{mapPathToMenu:i,mapKeyToMenu:m,processedMenuList:s}=d.useMemo(()=>(()=>{const y=new Map,b=new Map,S=v=>(v.key||(v.key=String(++n)),{...v}),P=v=>v.map(U=>{const k=S(U);return(oe(k)||se(k))&&(k.children=P(k.children||[])),ke(k)&&b.set(k.path,k),k!=null&&k.key&&y.set(k.key,k),k});return{processedMenuList:P(a),mapKeyToMenu:y,mapPathToMenu:b}})(),[a]),g=d.useMemo(()=>({menuList:s,setMenuList:l,menuCollapsed:o,setMenuCollapsed:u,mapPathToMenu:i,mapKeyToMenu:m}),[a,o]);return e(W.Provider,{value:g,children:t})},F={pageTitle:"后台管理系统模板",pageTitlePrefix:"后台管理",tokenKey:"Authorization",apiBaseUrl:"https://xstnet.github.io/react-admin-template/api",iconFontUrl:"//at.alicdn.com/t/c/font_3917407_iepuc225qt9.js"};function Yt(t,n){localStorage.setItem(t,typeof n=="object"?JSON.stringify(n):n)}function jt(t){localStorage.setItem(F.tokenKey,typeof t=="object"?JSON.stringify(t):t)}function ze(t){return localStorage.getItem(t)}function Vt(t){const n=localStorage.getItem(t);if(n!==null)return Number(n)}function _t(t){const n=localStorage.getItem(t);if(n!==null)return n==="true"}function Et(t){const n=localStorage.getItem(t);if(n!==null)return JSON.parse(n)}function zt(t){return ze(t)!==null}function Wt(t){localStorage.removeItem(t)}function Jt(){localStorage.removeItem(F.tokenKey)}function Gt(){localStorage.clear()}const A={set:Yt,setToken:jt,has:zt,getString:ze,getObject:Et,getBoolean:_t,getNumber:Vt,remove:Wt,removeToken:Jt,clear:Gt},We=()=>{const[t,n]=d.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);return d.useEffect(()=>{const a=l=>{console.log("chage",l.matches),l.matches?n(!0):n(!1)};return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",a)}},[]),[t?"dark":"light"]},Qt=void 0,Xt=d.createContext(Qt),Zt=({children:t})=>{const{settings:{primaryColor:n,theme:r,compactMode:a,followSystemTheme:l}}=d.useContext(J),[o]=We(),u={},i=()=>{const m=[];return l?m.push(o==="light"?H.defaultAlgorithm:H.darkAlgorithm):m.push(r==="light"?H.defaultAlgorithm:H.darkAlgorithm),console.log("algorighm",r,m),a&&m.push(H.compactAlgorithm),m};return e(Xt.Provider,{value:u,children:e($e,{locale:tt,theme:{algorithm:i(),token:{colorPrimary:n},components:{Button:{borderRadius:4,borderRadiusSM:2},Modal:{borderRadius:4,borderRadiusOuter:2}}},children:t})})},en=void 0,J=d.createContext(en),tn=({children:t})=>{const n=d.useMemo(()=>{const u=A.getObject("settings")||{};return console.log("settingsCache",u),{theme:"light",compactMode:!1,followSystemTheme:!1,fixedHeader:!0,fixedMenu:!0,primaryColor:"#00b96b",...u}},[]),[r,a]=d.useState(n),l=d.useCallback(u=>{const i={...r,...u};a(i),A.set("settings",i)},[r]),o={settings:r,setSetting:l};return e(J.Provider,{value:o,children:e(Zt,{children:t})})},nn=void 0,Ce=d.createContext(nn),rn=({children:t})=>{const[n,r]=d.useState(!1),[a,{toggleFullscreen:l}]=nt(document.body),[o,u]=d.useState(null),i=d.useMemo(()=>({isLogin:n,setIsLogin:r,userInfo:o,setUserInfo:u,fullScreen:a,setFullScreen:l}),[n,o,a]);return e(Ce.Provider,{value:i,children:e(tn,{children:e(qt,{children:t})})})},D=rt({scriptUrl:F.iconFontUrl,extraCommonProps:{}}),xe="/iframe",Je=t=>`${xe}?url=${t}`;function Ge(){}function an(t,n,r=3){return typeof t!="string"||typeof n!="string"?"":n.length?r&1&&t.startsWith(n)?t.substring(n.length):r&2&&t.endsWith(n)?t.substring(0,t.length-n.length):t:t}function on(t,n){return an(t,n,2)}function le(t,n){return Math.floor(Math.random()*(n-t+1))+t}const ln=()=>{const t=_(),{menuList:n,mapKeyToMenu:r,mapPathToMenu:a}=d.useContext(W);let l="/dashboard",o=[],u=!1;const i=location.pathname.replace(on("/react-admin-template/","/"),""),[m]=ie(),s=f=>{const y=r.get(f.key);if(console.log("mapKeyToMenu",r),console.log("clicked menu",f,y),!y){console.warn("未获取到菜单信息");return}if(y.path!==i){if((y==null?void 0:y.type)==="url"){window.open(y.path,"_blank");return}if(document.title=`${F.pageTitlePrefix} - ${y.label}`,(y==null?void 0:y.type)==="iframe"){console.log("打开iframe页面"),t(Je(y.path));return}t(y.path)}},g=d.useMemo(()=>{const f=b=>b.badge?b.badge==="dot"?e(Se,{className:"menu-item-badge",offset:[6,0],dot:!0,children:b.label}):e(Se,{className:"menu-item-badge",offset:[15,0],count:b.badge,children:b.label}):b.label,y=(b,S)=>{const P=[];return!u&&S&&o.push(S.key),b.map(h=>{var U;if(ke(h)&&(h.parent&&i.indexOf(h.path)===0&&(console.log("dddddd",a,a.get(h.parent),h.parent),l=((U=a.get(h.parent))==null?void 0:U.key)||"",u=!0),h.type==="iframe"&&(m.get("url")||"")===h.path&&(u=!0,l=h.key),h.hideInMenu))return;let v;if(Ht(h))v={...h};else if(se(h))v={...h},h.children&&h.children.length>0&&(v.children=y(h.children));else if(oe(h)||Ee(h)){let{icon:k}=h;typeof k=="string"&&k.includes("icon-")&&(k=e(D,{type:k})),v={key:"",...h,icon:k,label:f(h),children:oe(h)?y(h.children,h):void 0},!u&&h.path===i&&(l=h.key,u=!0)}v&&(v.key=v.key,P.push(v))}),!u&&o.pop(),P};return y(n)},[n]);return e(at,{style:{height:"100%"},onClick:s,mode:"inline",defaultSelectedKeys:[l],items:g,defaultOpenKeys:o})},sn=Q.memo(ln),ce=()=>{const{token:t}=H.useToken();return t},cn=()=>{const{menuCollapsed:t}=d.useContext(W),{colorBgContainer:n}=ce();return e(z.Sider,{style:{background:n},trigger:null,className:"left-sider",collapsible:!0,collapsed:t,children:e(sn,{})})};var me=(t=>(t[t.success=0]="success",t[t.noLogin=-10001]="noLogin",t[t.loginExpired=-10002]="loginExpired",t))(me||{}),Qe=(t=>(t[t.male=1]="male",t[t.female=2]="female",t))(Qe||{}),R=(t=>(t[t.Incomplete=1]="Incomplete",t[t.completed=2]="completed",t[t.deleted=10]="deleted",t))(R||{}),Xe=(t=>(t.day="YYYY-MM-DD",t.second="YYYY-MM-DD HH:mm:ss",t.minute="YYYY-MM-DD HH:mm",t.hour="YYYY-MM-DD HH",t))(Xe||{});const dn=10*1e3;j.defaults.baseURL=F.apiBaseUrl;j.defaults.headers.post["Content-Type"]="application/json; charset=utf-8";j.defaults.timeout=dn;j.interceptors.request.use(t=>(console.group(`${t.method}${t.url}${JSON.stringify(t.params)}`),t.headers.Authorization=`Bearer ${A.getString(F.tokenKey)}`,t),t=>Promise.reject(t));j.interceptors.response.use(t=>{const n=t.data;return typeof n.code!="number"?(O.error("系统错误",2),console.warn("api调用失败, 未正常返回数据, url:",t.config.url,"data:",n,"response:",t),console.groupEnd(),Promise.reject(t)):(console.log("Request log: ",t.config.url,t.data,t),console.groupEnd(),n.code===0?(t.config.method==="post"&&O.success(t.data.message),t):n.code===me.noLogin?(O.error("您还没有登录, 即将跳转到登录页面, 请稍后..."),A.remove(F.tokenKey),location.reload(),Promise.reject(n)):n.code===me.loginExpired?(O.error("登录已失效, 即将跳转到登录页面..."),A.remove(F.tokenKey),location.reload(),Promise.reject(n)):(O.error(n.message),Promise.reject(t)))},t=>(typeof t.message=="string"&&t.message==="Network Error"?O.error("网络错误, 请稍后再试!"):O.error("请求失败, 请稍后再试"),console.log("Request error",t),console.groupEnd(),Promise.reject(t)));const un=(t,n,r)=>{const a=r||{};return a.params=n,j.get(t,a)},mn=(t,n,r)=>j.post(t,n,r),hn=t=>j.request(t),N={get:un,post:mn,request:hn},L=t=>t.then(n=>Promise.resolve(n.data.data)).catch(n=>Promise.reject(n)),pn=t=>{const n=N.post("/login",t);return L(n)},gn=t=>L(N.get("/user/info",t)),fn=t=>L(N.post("/user/logout",t)),yn=(t,n)=>L(N.get("/user/list",{...t,...n})),bn=t=>L(N.post("/user/create",t)),vn=t=>L(N.post("/user/update",t)),kn=t=>L(N.post("/user/delete",t)),Cn=(t,n)=>L(N.get("/article/list",{...t,...n})),xn=t=>L(N.get("/article/detail",t)),Sn=t=>L(N.post("/article/create",t)),In=t=>L(N.post("/article/update",t)),Mn=t=>L(N.post("/article/delete",t));const Pn=t=>{const n=["#1890ff","#722ed1","#eb2f96","#00b96b","#52c41a","#13c2c2","#1677ff","#f5222d","#fa8c16","#faad14"],{onChange:r,presetColors:a=n,defaultSelectedColor:l=""}=t,{value:o=l}=t,[u,i]=d.useState(o),m=s=>{i(s),r==null||r(s)};return e("div",{className:"theme-color-wrap",children:a.map(s=>e("div",{onClick:()=>m(s),className:"theme-color-item",style:{backgroundColor:s},title:s,children:u===s&&e(ot,{className:"checked-icon"})},s))})},Tn=t=>{const{open:n,onClose:r=Ge}=t,{settings:a,setSetting:l}=d.useContext(J),[o]=p.useForm(),[u]=We(),i=d.useMemo(()=>({...a,theme:a.followSystemTheme?"followSystem":a.theme,showFooter:void 0}),[a]),m=(s,g)=>{const f={...s},{theme:y,fixedMenu:b,fixedHeader:S}=f;y&&(console.log("themeee",y),f.followSystemTheme=!1,y==="followSystem"&&(f.followSystemTheme=!0,f.theme=u)),b&&(f.fixedHeader=!0),S===!1&&(f.fixedMenu=!1),l(f),console.log("chage",s,g)};return lt(()=>{o==null||o.setFieldsValue(i)},[i]),e(it,{title:"偏好设置",onClose:r,open:n,children:c(p,{name:"basic",labelCol:{span:5},wrapperCol:{span:19},initialValues:{...i},autoComplete:"off",onValuesChange:m,form:o,children:[e(p.Item,{label:"外观",name:"theme",children:c(V.Group,{buttonStyle:"solid",children:[c(V.Button,{value:"light",children:[e(D,{type:"icon-theme-light"})," 浅色"]}),c(V.Button,{value:"dark",children:[e(D,{type:"icon-theme-dark"})," 深色"]}),c(V.Button,{value:"followSystem",children:[e(D,{type:"icon-followSystem"})," 跟随系统"]})]})}),e(p.Item,{label:"紧凑模式",valuePropName:"checked",name:"compactMode",children:e(Z,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(p.Item,{label:"主题色",name:"primaryColor",children:e(Pn,{defaultSelectedColor:a.primaryColor})}),e(fe,{children:"布局"}),e(p.Item,{label:"固定头部",valuePropName:"checked",name:"fixedHeader",children:e(Z,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(p.Item,{help:"固定菜单启用时, 头部也会同步固定",label:"固定菜单",valuePropName:"checked",name:"fixedMenu",children:e(Z,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(p.Item,{valuePropName:"checked",label:"显示页脚",name:"showFootor",children:e(Z,{checkedChildren:"开启",unCheckedChildren:"关闭"})})]})})},Nn=t=>{const[n,r]=d.useState(!1);return c("div",{children:[e(Tn,{open:n,onClose:()=>{r(!1)}}),e(D,{onClick:()=>{r(!0)},title:"设置",type:"icon-setting",className:"action-icon"})]})},Ln=()=>{const{fullScreen:t,setFullScreen:n,userInfo:r,setUserInfo:a,setIsLogin:l}=d.useContext(Ce),{menuCollapsed:o,setMenuCollapsed:u}=d.useContext(W),{settings:{theme:i},setSetting:m}=d.useContext(J),{token:{colorBgContainer:s}}=H.useToken(),g=_(),f=()=>{O.success(t?"已退出全屏模式":"进入全屏模式"),n(!t)},y=()=>{m({followSystemTheme:!1,theme:i==="light"?"dark":"light"})},b=()=>c("div",{className:"left",children:[c("div",{className:"logo",children:[e(D,{type:"icon-react",className:"logo-img"}),e("span",{className:"logo-text",children:"React Admin Template"})]}),e("div",{children:Q.createElement(o?st:ct,{onClick:()=>u(!o)})})]}),S=()=>{const P=()=>c(Y,{children:[e(D,{title:"搜索",type:"icon-search",className:"action-icon"}),t?e(ut,{title:"退出全屏模式",className:"action-icon",onClick:f}):e(mt,{title:"进入全屏模式",className:"action-icon",onClick:f}),e("a",{target:"_blank",className:"action-icon",title:"Go to Github",href:"https://github.com/xstnet/react-admin-template",rel:"norefer noopener",children:e(ht,{})}),i==="dark"?e(D,{onClick:y,title:"主题-深色模式",type:"icon-theme-dark",className:"action-icon"}):e(D,{onClick:y,title:"主题-明亮模式",type:"icon-theme-light",className:"action-icon"}),e(Nn,{})]}),h=[{label:e("a",{children:"个人中心"}),icon:e(pt,{}),key:"userCenter"},{label:e("a",{children:"修改资料"}),key:"update",icon:e(ye,{})},{type:"divider"},{label:"退出",icon:e(gt,{}),key:"logout",onClick:()=>{fn().then(()=>{A.removeToken(),l(!1),a(null),g("/login")})}}];return e("div",{className:"right",children:c(w,{size:"middle",children:[P(),e(dt,{menu:{items:h},children:c(w,{className:"pointer",children:[e("span",{children:r==null?void 0:r.nickname}),e(Oe,{src:r==null?void 0:r.avatar})]})})]})})};return e(z.Header,{className:"header",style:{background:s},children:c(Y,{children:[b(),S()]})})},wn=Q.memo(Ln),An=T.Text,ne=()=>ae().format(Xe.second),Un=()=>{const[t,n]=d.useState(0),{colorPrimary:r}=ce(),[a,l]=d.useState([{id:le(100,1e9),name:"鼠标悬浮时在显示编辑图标",status:R.Incomplete,create_time:ne(),update_time:ne()},{id:1,name:"这是一个todo例子",status:R.completed,create_time:ne(),update_time:ne()}]),[o,u]=d.useState(""),i=()=>{o&&(l([{name:o,status:R.Incomplete,id:le(100,1e9),create_time:ae().format("YYYY-MM-DD HH:MM:SS"),update_time:ae().format("YYYY-MM-DD HH:MM:SS")},...a]),u(""))},m=(f,y)=>{l(a.map(b=>b.id!==f?b:{...b,status:y?R.completed:R.Incomplete}))},s=(f,y)=>{console.log("iii",f,y),l(a.map(b=>b.id!==f?b:{...b,name:y}))},g=f=>{l(a.filter(y=>y.id!==f))};return e(B,{title:"待办事项",children:c(w,{direction:"vertical",style:{width:"100%"},children:[c(w.Compact,{style:{width:"100%",marginBottom:"16px"},children:[e(x,{value:o,onChange:f=>u(f.target.value),placeholder:"添加新事项",onPressEnter:i}),e(I,{onClick:i,type:"primary",icon:e(X,{})})]}),a.map(({id:f,status:y,name:b})=>{const S=y===R.completed,P=t===f&&y===R.Incomplete;return e(De,{onChange:({target:{checked:h}})=>m(f,h),checked:S,children:e(An,{type:S?"secondary":void 0,delete:S,onMouseEnter:()=>n(f),onMouseLeave:()=>n(0),editable:P?{onChange:h=>s(f,h)}:!1,children:c(w,{children:[b,P&&e(ft,{title:"删除",children:e(be,{onClick:()=>g(f),style:{color:r}})})]})})},f)})]})})},Fn=()=>{const[t,n]=d.useState("pv"),r=[{tab:"访问量",key:"pv"},{tab:"IP",key:"ip"}],a={pv:{stroke:"#8884d8",fill:"#b5b1e6"},ip:{stroke:"#00b96b",fill:"#82ca9d"}},l=Array.from({length:7}).map((o,u)=>({name:ae().subtract(u+1,"day").format("MM-DD"),pv:le(1e3,1e4),ip:le(100,1e3)})).reverse();return e(B,{activeTabKey:t,onTabChange:o=>n(o),tabList:r,children:e(Re,{width:"100%",height:200,children:c(yt,{data:l,children:[e(bt,{strokeDasharray:"3 3"}),e(vt,{dataKey:"name"}),e(kt,{}),e(Be,{wrapperStyle:{outline:"none"}}),e(Ct,{type:"monotone",strokeWidth:2,dataKey:t,stroke:a[t].stroke,fill:a[t].fill})]})})})},Ne=[{name:"视频类",value:400},{name:"图文类",value:300},{name:"资讯类",value:300}],Le=()=>e(Y,{children:c("div",{children:[c(K,{gutter:24,children:[e(C,{span:6,children:e(B,{bordered:!1,children:e(ee,{title:"今日销售额",value:126560,precision:2,prefix:"$"})})}),e(C,{span:6,children:e(B,{bordered:!1,children:e(ee,{title:"示例指标",value:11.28,precision:2,prefix:e(de,{}),suffix:"%"})})}),e(C,{span:6,children:e(B,{bordered:!1,children:e(ee,{title:"示例指标",value:11.28,precision:2,prefix:e(de,{}),suffix:"%"})})}),e(C,{span:6,children:e(B,{bordered:!1,children:e(ee,{title:"示例指标",value:11.28,precision:2,valueStyle:{color:"#3f8600"},prefix:e(de,{}),suffix:"%"})})})]}),e("br",{}),c(K,{gutter:16,children:[e(C,{span:18,children:e(Fn,{})}),e(C,{span:6,children:e(B,{title:"内容占比",children:e(Re,{width:"100%",height:200,children:c(xt,{width:400,height:400,children:[e(St,{data:Ne,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:70,label:!0,children:Ne.map((t,n)=>e(It,{fill:["#0088FE","#00C49F","#FFBB28"][n%3]},`cell-${n}`))}),e(Be,{wrapperStyle:{outline:"none"}})]})})})})]}),e("br",{}),c(K,{gutter:16,children:[e(C,{span:12,children:e(Un,{})}),e(C,{span:12,children:e(B,{title:"登录历史",children:"登录历史"})})]})]})}),we=()=>e("span",{children:"UserCenterPage"}),$n=()=>e("span",{children:"UserCenterUpdatePage"});const Ze=d.forwardRef(({state:t},n)=>{const[r]=p.useForm(),a=d.useRef(null);return d.useImperativeHandle(n,()=>({form:r,input:a.current}),[r,a]),e("div",{children:c(p,{form:r,labelCol:{span:3},name:"userForm",initialValues:t||void 0,children:[e(p.Item,{name:"username",label:"账号",rules:[{required:!0,message:"请输入账号"}],children:e(x,{ref:a})}),e(p.Item,{name:"password",label:"密码",rules:[{required:!t,message:"请输入密码"}],children:e(x.Password,{})}),e(p.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入昵称"}],children:e(x,{})}),e(p.Item,{name:"gender",label:"性别",children:c(V.Group,{children:[e(V,{value:1,children:"男"}),e(V,{value:2,children:"女"})]})}),e(p.Item,{name:"mobile",label:"手机号",children:e(x,{})}),e(p.Item,{name:"email",label:"邮箱",children:e(x,{})})]})})}),On=({refreshList:t})=>{const[n,r]=d.useState(!1),{run:a,loading:l}=q(bn,{manual:!0,debounceWait:100,onSuccess:()=>{var i;r(!1),(i=o.current)==null||i.form.resetFields(),t==null||t()}}),o=d.useRef(null);return c("div",{children:[e(I,{type:"primary",icon:e(X,{}),onClick:()=>{r(!0),setTimeout(()=>{var i,m;(m=(i=o.current)==null?void 0:i.input)==null||m.focus()},100)},children:"新增用户"}),e(He,{open:n,title:"添加用户",okText:"添加",cancelText:"取消",confirmLoading:l,onCancel:()=>r(!1),onOk:()=>{var i;(i=o.current)==null||i.form.validateFields().then(m=>{a(m)}).catch(m=>console.log(m))},children:e(Ze,{ref:o})})]})},Dn=({search:t,form:n})=>e(p,{form:n,name:"advanced_search",style:{paddingTop:16},onFinish:a=>{console.log("Received values of form: ",a)},children:c(K,{gutter:24,children:[e(C,{span:6,children:e(p.Item,{name:"username",label:"账号",children:e(x,{placeholder:"账号"})})}),e(C,{span:6,children:e(p.Item,{name:"mobile",label:"手机号",children:e(x,{placeholder:"手机号"})})}),e(C,{span:6,children:e(p.Item,{name:"email",label:"邮箱",children:e(x,{placeholder:"邮箱"})})}),c(C,{span:6,style:{textAlign:"right"},children:[e(I,{onClick:t.reset,children:"重置"}),e(I,{style:{margin:"0 8px"},type:"primary",onClick:t.submit,children:"查询"})]})]})}),et=(t,n)=>{const r=Mt(t,n),{tableProps:a}=r,l={...a.pagination,showTotal:(i,m)=>`第${m[0]}-${m[1]} 条/共 ${i} 条`,hideOnSinglePage:!0};a.pagination=l;const o=a.onChange,u=(...i)=>{var P;let[m,s,g,f]=i,y=m,b,S;Object.keys(g).length>0&&(Array.isArray(g)?(S={},g.map(h=>{var v;S[(v=h.column)==null?void 0:v.dataIndex]=h.order})):S={[(P=g.column)==null?void 0:P.dataIndex]:g.order}),Object.keys(s).length>0&&(b=s,console.log("filterrrrrrrrrrrrr",s)),o(y,b,S)};return a.onChange=u,r.tableProps.size="small",r},Rn=({state:t,refreshList:n})=>{const[r,a]=d.useState(!1),{runAsync:l,loading:o}=q(vn,{manual:!0,debounceWait:100}),u=d.useRef(null);return c(Y,{children:[e(I,{icon:e(ye,{}),size:"small",onClick:()=>{a(!0),setTimeout(()=>{var m,s;(s=(m=u.current)==null?void 0:m.input)==null||s.focus()},100)},children:"编辑"}),e(He,{open:r,title:"更新用户信息用户",okText:"保存",cancelText:"取消",confirmLoading:o,onCancel:()=>a(!1),onOk:()=>{var m;(m=u.current)==null||m.form.validateFields().then(s=>{l({...s,id:t.id}).then(()=>{var g;a(!1),(g=u.current)==null||g.form.resetFields(),n==null||n()}).catch(Ge)}).catch(s=>console.log(s))},children:e(Ze,{ref:u,state:t})})]})};const $=t=>{const{children:n,className:r="",style:a={},...l}=t,{colorBgContainer:o}=ce(),u="content-box",i={backgroundColor:o};return e("div",{className:`${u} ${r}`,style:{...i,...a},...l,children:n})},Bn=()=>{var P;console.log("render ExampleUserListPage");const[t]=p.useForm(),[n,r]=d.useState([]),a=d.useRef();d.useEffect(()=>{a.current=new Map},[]);const{runAsync:l,loading:o}=q(kn,{manual:!0,debounceWait:100}),{refresh:u,tableProps:i,search:m}=et(yn,{form:t}),s=()=>{m.reset(),m.submit()},g=h=>{var v;typeof h=="number"&&((v=a==null?void 0:a.current)==null||v.set(h,!0)),l({id:h}).then(()=>{typeof h=="object"&&r([]),u()}).finally(()=>{var U;return typeof h=="number"&&((U=a==null?void 0:a.current)==null?void 0:U.delete(h))})},f=d.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"头像",dataIndex:"avatar",render:h=>e(Oe,{src:h})},{title:"账号",dataIndex:"username"},{title:"昵称",dataIndex:"nickname"},{title:"性别",dataIndex:"gender",render:h=>h===Qe.male?e(Ie,{color:"blue",children:"男"}):e(Ie,{color:"error",children:"女"})},{title:"邮箱",dataIndex:"email"},{title:"手机号",dataIndex:"mobile",sorter:!0},{title:"注册时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(h,v)=>{var k;const{id:U}=v;return c(w,{children:[e(ue,{title:"确认要删除这条数据吗?",onConfirm:()=>g(U),children:e(I,{loading:(k=a==null?void 0:a.current)==null?void 0:k.has(U),icon:e(be,{}),size:"small",danger:!0,children:"删除"})}),e(Rn,{state:v,refreshList:u})]})}}],[]),b={selectedRowKeys:n,onChange:h=>{console.log("selectedRowKeys changed: ",h),r(h)}},S=n.length>0;return c(Y,{children:[c($,{children:[e("div",{children:e(T.Title,{level:5,children:"搜索"})}),e(Dn,{search:m,form:t})]}),e("br",{}),c($,{children:[c("div",{className:"table-header",children:[e("div",{className:"left",children:e(T.Title,{level:5,children:"用户列表"})}),e("div",{className:"right",children:c(w,{size:"middle",children:[e(ue,{title:`确定要删除这${n.length}条数据吗?`,onConfirm:()=>g(n),children:e(I,{type:"primary",danger:!0,disabled:!S,loading:o&&((P=a.current)==null?void 0:P.size)===0,children:"批量删除"})}),e(On,{refreshList:s}),e(I,{type:"link",title:"点击刷新",onClick:u,icon:e(Ke,{})})]})})]}),e(qe,{rowKey:"id",rowSelection:b,columns:f,...i})]})]})},Ae=({title:t="空白页"})=>e($,{style:{height:"500px"},children:e(T.Title,{level:4,children:t})}),Hn=({search:t,form:n})=>e(p,{form:n,name:"advanced_search",style:{paddingTop:16},onFinish:a=>{console.log("Received values of form: ",a)},children:c(K,{gutter:24,children:[e(C,{span:6,children:e(p.Item,{name:"title",label:"主题",children:e(x,{placeholder:"标题"})})}),e(C,{span:6,children:e(p.Item,{name:"ahthor",label:"作者",children:e(x,{placeholder:"作者"})})}),e(C,{span:6,children:e(p.Item,{name:"create_time",label:"发布时间",children:e(Pt.RangePicker,{})})}),c(C,{span:6,style:{textAlign:"right"},children:[e(I,{onClick:t.reset,children:"重置"}),e(I,{style:{margin:"0 8px"},type:"primary",onClick:t.submit,children:"查询"})]})]})});const Ue=()=>{console.log("render ArticleIndexPage");const[t]=p.useForm(),n=d.useRef();_(),d.useEffect(()=>{n.current=new Map},[]);const{runAsync:r}=q(Mn,{manual:!0,debounceWait:100}),{refresh:a,tableProps:l,search:o}=et(Cn,{form:t}),u=m=>{var s;(s=n==null?void 0:n.current)==null||s.set(m,!0),r({id:m}).then(a).finally(()=>{var g;return(g=n==null?void 0:n.current)==null?void 0:g.delete(m)})},i=d.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"封面",dataIndex:"cover",render:m=>e(Tt,{width:80,height:45,style:{borderRadius:4},src:m})},{title:"标题",dataIndex:"title"},{title:"简介",dataIndex:"description"},{title:"作者",dataIndex:"author"},{title:"发布时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(m,s)=>{var f;const{id:g}=s;return c(w,{children:[e(ue,{title:"确认要删除这条数据吗?",onConfirm:()=>u(g),children:e(I,{loading:(f=n==null?void 0:n.current)==null?void 0:f.has(g),icon:e(be,{}),size:"small",danger:!0,children:"删除"})}),e(G,{to:`/article/update/${g}`,children:e(I,{icon:e(ye,{}),size:"small",children:"编辑"})})]})}}],[]);return c(Y,{children:[c($,{children:[e("div",{children:e(T.Title,{level:5,children:"搜索"})}),e(Hn,{search:o,form:t})]}),e("br",{}),c($,{children:[c("div",{className:"table-header",children:[e("div",{className:"left",children:e(T.Title,{level:5,children:"文章列表"})}),e("div",{className:"right",children:c(w,{size:"middle",children:[e(G,{to:"/article/create",children:e(I,{type:"primary",icon:e(X,{}),children:"发布文章"})}),e(I,{type:"link",title:"点击刷新",onClick:a,icon:e(Ke,{})})]})})]}),e(qe,{rowKey:"id",columns:i,...l})]})]})},Kn=()=>{const[t]=p.useForm(),n=_(),r="articleDraft",{loading:a,run:l}=q(Sn,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{A.remove(r),n("/article/list")},200)}),o=A.getObject(r)||{},u=async()=>{const s=await t.validateFields();l(s)},i=()=>{const{cover:s,...g}=t.getFieldsValue();A.set(r,g),O.success("已保存到草稿箱")},m=s=>(console.log("Upload event:",s),Array.isArray(s)?s:s&&s.fileList);return c($,{children:[e(T.Title,{level:3,children:"发布文章"}),e(fe,{}),e(p,{form:t,name:"createForm",labelCol:{span:3},initialValues:o,children:c(K,{gutter:36,children:[c(C,{span:16,children:[e(p.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(x,{})}),e(p.Item,{label:"简介",name:"description",children:e(x,{})}),e(p.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:e(x.TextArea,{rows:20})}),e(p.Item,{wrapperCol:{offset:3},children:c(w,{children:[e(I,{icon:e(Ye,{}),onClick:u,loading:a,type:"primary",children:"发布文章"}),e(I,{icon:e(Nt,{}),onClick:i,children:"保存为草稿"})]})})]}),c(C,{span:8,children:[e(p.Item,{label:"封面",name:"cover",getValueFromEvent:m,valuePropName:"fileList",children:e(je,{maxCount:1,listType:"picture-card",children:c("div",{children:[e(X,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(p.Item,{label:"标签",name:"tags",children:e(Ve,{mode:"tags",placeholder:"文章标签"})}),e(p.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(x,{})})]})]})})]})},qn=()=>{const[t]=p.useForm(),n=_(),r=Lt(),{loading:a,run:l}=q(xn,{manual:!0,debounceWait:10,onSuccess:s=>t.setFieldsValue(s)});d.useEffect(()=>{l({id:r.id})},[r.id]);const{loading:o,run:u}=q(In,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{n("/article/list")},200)}),i=async()=>{const s=await t.validateFields();u(s)},m=s=>(console.log("Upload event:",s),Array.isArray(s)?s:s&&s.fileList);return c($,{children:[e(T.Title,{level:3,children:"更新文章"}),e(fe,{}),e(ve,{spinning:a,children:e(p,{form:t,name:"createForm",labelCol:{span:3},children:c(K,{gutter:36,children:[c(C,{span:16,children:[e(p.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(x,{})}),e(p.Item,{label:"简介",name:"description",children:e(x,{})}),e(p.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:e(x.TextArea,{rows:20})}),e(p.Item,{wrapperCol:{offset:3},children:e(w,{children:e(I,{icon:e(Ye,{}),onClick:i,loading:o,type:"primary",children:"保存"})})})]}),c(C,{span:8,children:[e(p.Item,{label:"封面",name:"cover",getValueFromEvent:m,valuePropName:"fileList",children:e(je,{maxCount:1,listType:"picture-card",children:c("div",{children:[e(X,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(p.Item,{label:"标签",name:"tags",children:e(Ve,{mode:"tags",placeholder:"文章标签"})}),e(p.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(x,{})})]})]})})})]})},Yn=()=>{const t=_e();return c($,{style:{},children:[e(T.Title,{children:"404"}),e(T.Paragraph,{children:"页面不存在"}),c(T.Paragraph,{children:["路由: ",t.pathname]}),e(G,{to:"/",children:"回到首页"})]})};const jn=t=>{const{title:n="Iframe Page",name:r="internal-iframe"}=t,a=d.useRef(null),[l,o]=d.useState(!0),[u]=ie();d.useEffect(()=>{o(!0)},[u]);const i=u.get("url"),m=()=>{o(!1)};return i?e(Y,{children:e($,{style:{height:"100%",padding:0},children:e(ve,{wrapperClassName:"iframeSpin",spinning:l,tip:"正在加载第三方页面, 请稍后...",children:e("iframe",{ref:a,width:"100%",height:"100%",onLoad:m,title:n,name:r,src:i})})})}):e($,{children:e(wt,{message:"无效的url地址",type:"error"})})};function Vn(){return At([{path:"/",element:e(Le,{})},{path:"/dashboard",element:e(Le,{})},{path:"/user",children:[{index:!0,element:e(we,{})},{path:"/user/center/index",element:e(we,{})},{path:"/user/center/update",element:e($n,{})}]},{path:"/example/userList",element:e(Bn,{})},{path:"/article",children:[{index:!0,element:e(Ue,{})},{path:"/article/list",element:e(Ue,{})},{path:"/article/create",element:e(Kn,{})},{path:"/article/update/:id",element:e(qn,{})}]},{path:"/blank",element:e(Ae,{})},{path:xe,element:e(jn,{})},{path:"/multilevel/menu/2/3",element:e(Ae,{title:"三级菜单"})},{path:"*",element:e(Yn,{})}])}const _n=()=>e(z.Content,{className:"content",children:e(Vn,{})}),En=Q.memo(_n);const re=new Map,he=t=>{t.map(n=>{ke(n)&&(n==null?void 0:n.type)==="url"||(se(n)&&he(n.children||[]),(oe(n)||Ee(n))&&(n.path&&re.set(n.path,n.label),n.children&&he(n.children||[])))})},zn=()=>{const{menuList:t}=d.useContext(W),n=d.useMemo(()=>(re.clear(),he(t),re),[t]),r=_e(),[a]=ie(),l=()=>{if(r.pathname===xe){const i=a.get("url");if(i&&re.has(i))return[e(te.Item,{children:e(G,{style:{color:"inherit"},to:Je(i),children:n.get(i)})},i)]}return[]},o=d.useMemo(()=>{const i=r.pathname.split("/").filter(m=>m);return i.map((m,s)=>{const g=`/${i.slice(0,s+1).join("/")}`;return n.has(g)?e(te.Item,{children:s===i.length-1?e(G,{style:{color:"inherit"},to:g,children:n.get(g)}):n.get(g)},g):null})},[r]),u=[e(te.Item,{children:e(Ut,{})},"home"),...o,...l()];return e(te,{className:"breadcrumb",children:u})},Wn=Q.memo(zn);function Jn(t){const n=t.split(".")[1];if(n)try{return JSON.parse(Ft(n))}catch(r){console.warn("Parse Token Error: ",r);return}}function pe(){var r;const t=A.getString(F.tokenKey);if(!t)return!1;const n=Jn(t);return n!==void 0&&((r=n==null?void 0:n.data)==null?void 0:r.uid)>0&&n.exp>new Date().getTime()/1e3}const Gn=({loading:t,title:n})=>{const{settings:{theme:r}}=d.useContext(J);return e(ve,{size:"large",spinning:t,tip:n,wrapperClassName:`page-loading-spin-${r}`,children:e("div",{style:{height:"100vh",width:"100vw"}})})};const Qn=()=>{const[t,n]=d.useState(!0),{setIsLogin:r,setUserInfo:a}=d.useContext(Ce),{menuCollapsed:l}=d.useContext(W),{colorBgContainer:o}=ce(),{settings:{fixedMenu:u,fixedHeader:i}}=d.useContext(J),m=_(),[s]=ie();return console.log("default layout render..."),d.useEffect(()=>{if(!pe()){m("/login");return}gn().then(g=>{if(n(!1),r(!0),a(g),s.has("ghpage")){const f=decodeURIComponent(s.get("ghpage"));m(f);return}}).catch(g=>{g instanceof $t&&Ot.error({message:"网络错误",description:"获取用户信息失败, 无法打开页面",duration:null,closeIcon:null})})},[]),pe()?t?e(Gn,{title:"页面加载中",loading:t}):c(z,{"data-fixed-menu":u?1:0,"data-menu-collapsed":l?1:0,"data-fixed-header":i?1:0,style:{background:o},className:"default-layout",children:[e(wn,{}),c(z,{children:[e(cn,{}),c(z,{className:"content-layout",children:[e(Wn,{}),e(En,{})]})]})]}):(m("/login"),null)};const Xn=()=>{const t=_(),{loading:n,run:r}=q(pn,{manual:!0,debounceWait:300,onSuccess:o=>{A.setToken(o.token),t("/dashboard")}});document.title=F.pageTitle;const a=o=>{r(o)};d.useEffect(()=>{pe()&&t("/dashboard")},[]);const l={remember:!0,username:"admin",password:"123456"};return e(Y,{children:c($e,{theme:{algorithm:[H.defaultAlgorithm]},children:[e("div",{className:"bg-wrap"}),c(K,{className:"login-wrap",children:[e(C,{span:15,className:"login-banner"}),c(C,{span:9,className:"login-form-wrap",children:[e(T.Title,{style:{textAlign:"center"},children:"后台管理系统"}),e("br",{}),c(p,{name:"loginForm",labelCol:{span:5},wrapperCol:{span:19},style:{maxWidth:600},initialValues:l,onFinish:a,autoComplete:"off",children:[e(p.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名!"}],children:e(x,{placeholder:"admin"})}),e(p.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码!"}],children:e(x.Password,{placeholder:"123456"})}),e(p.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:5},children:e(De,{children:"记住我"})}),e(p.Item,{wrapperCol:{offset:5,span:16},children:e(I,{loading:n,type:"primary",htmlType:"submit",children:"登录"})})]})]})]})]})})};function Zn(){return d.useEffect(()=>{},[]),e(rn,{children:e("div",{className:"App",children:c(Dt,{children:[e(Me,{element:e(Xn,{}),path:"/login"}),e(Me,{path:"*",element:e(Qn,{})})]})})})}function Fe(t){const n=JSON.stringify({type:"JWT",alg:"HS256"}),r=Number((new Date().getTime()/1e3).toFixed(0)),a=JSON.stringify({iss:"github.com/xstnet",sub:"react-admin",iat:r,exp:r+86400*14,data:t}),l="H_97UyQUOmURnZdDwI0khuAt4Cmg";return`${Pe(n)}.${Pe(a)}.${l}`}M.mock(/api\/login/,"post",({body:t})=>{const{username:n,password:r}=JSON.parse(t);return n==="admin"?r!=="123456"?{code:-1,message:"密码错误"}:{code:0,message:"登录成功",data:{token:Fe({uid:1})}}:{code:0,message:"登录成功",data:{token:Fe({uid:E.Random.natural(2,1e4)})}}});M.setup({timeout:100});M.mock(/api\/user\/info/,"get",t=>({code:0,message:"ok",data:{id:1,username:"admin",nickname:"醉丶春风",avatar:"https://www.xstnet.com/static/images/head.gif",password:"",gender:E.Random.natural(1,2),email:"shantongxu@qq.com",mobile:"133xxxx3333"}}));M.mock(/api\/user\/logout/,"post",t=>({code:0,message:"退出成功"}));M.mock(/api\/user\/list/,"get",t=>{const n=new URLSearchParams(t.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,username:"@first@last",nickname:"@cname",avatar:()=>E.Random.dataImage("200x200"),email:"@email",mobile:()=>M.mock(/^1[3456789]\d{9}$/).replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"),"gender|1-2":0,create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return M.mock(a)});M.mock(/api\/user\/create/,"post",t=>({code:0,message:"创建成功",data:{id:E.Random.natural(100,9999)}}));M.mock(/api\/user\/update/,"post",t=>({code:0,message:"更新成功"}));M.mock(/api\/user\/delete/,"post",t=>({code:0,message:"删除成功"}));M.setup({timeout:100});M.mock(/api\/article\/detail/,"get",t=>(console.log("🚀 ~ file: article.ts:7 ~ Mock.mock ~ options:",t),{code:0,message:"ok",data:{id:1,title:"主题",description:"醉丶春风",author:"醉丶春风",tags:[1,2],content:"content",create_time:E.Random.datetime()}}));M.mock(/api\/article\/list/,"get",t=>{const n=new URLSearchParams(t.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,author:"@first@last",title:()=>M.Random.ctitle(5,20),description:"@cname",cover:()=>E.Random.dataImage("480x270","封面"),content:"@email",create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return M.mock(a)});M.mock(/api\/article\/create/,"post",t=>({code:0,message:"创建成功",data:{id:E.Random.natural(100,9999)}}));M.mock(/api\/article\/update/,"post",t=>({code:0,message:"更新成功"}));M.mock(/api\/article\/delete/,"post",t=>({code:0,message:"删除成功"}));Rt.createRoot(document.getElementById("root")).render(e(Bt,{basename:"/react-admin-template/",children:e(Zn,{})}));
