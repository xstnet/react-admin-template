import{j as de,r as d,C as Ne,z as _e,t as R,u as We,c as Je,R as G,a as K,b as ne,M as Ge,B as be,L as z,d as j,m as O,e as Qe,F as h,f as Ze,D as Xe,g as q,S as Q,h as ue,i as Ye,k as et,l as D,n as tt,A as Le,o as nt,p as rt,G as at,U as ot,E as me,q as lt,s as H,v as C,w as Z,x as X,y as oe,I as x,H as B,J as I,P as re,K as we,N as it,T as ke,O as le,Q as Ae,V as L,W as Ue,X as Fe,Y as st,Z as ct,_ as J,$ as Oe,a0 as dt,a1 as $e,a2 as Re,a3 as ut,a4 as he,a5 as De,a6 as mt,a7 as ht,a8 as Y,a9 as pt,aa as gt,ab as ft,ac as yt,ad as bt,ae as kt,af as ve,ag as S,ah as V,ai as xe,aj as vt,ak as xt}from"./vendor-381de1a0.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(l){if(l.ep)return;l.ep=!0;const o=r(l);fetch(l.href,o)}})();const E=de.Fragment,e=de.jsx,m=de.jsxs,Ce=[{label:"控制台",type:"group",children:[{label:"控制台",icon:"icon-dashboard",path:"/dashboard"}]},{label:"示例页面",type:"group",children:[{label:"列表页",icon:"icon-list",path:"/example/userList"},{label:"多级菜单",icon:"icon-list",path:"/multilevel/menu",children:[{label:"二级菜单",icon:"icon-list",path:"/multilevel/menu/2",children:[{label:"三级菜单",icon:"icon-list",path:"/multilevel/menu/2/3"}]}]},{label:"空白页",icon:"icon-example",path:"/blank"},{label:"404",icon:"icon-example",path:"/404"}]},{label:"徽标示例",type:"group",children:[{label:"红点徽标",icon:"icon-list",badge:"dot",path:"/blank"},{label:"数字徽标",icon:"icon-example",badge:98,path:"/blank"}]},{type:"divider"},{path:"/article",label:"文章管理",icon:"icon-article",children:[{path:"/article/list",label:"文章列表",icon:"icon-article"},{path:"/article/create",label:"发布文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/update",label:"更新文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/category",label:"分类管理",icon:"icon-list"}]},{path:"/iframe",label:"外部页面",icon:"icon-href",children:[{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(外链)",icon:"icon-document",key:"webpage-antd-document",type:"url"},{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(内嵌)",icon:"icon-document",type:"iframe"},{path:"https://www.xstnet.com",label:"博客主页(内嵌)",icon:"icon-document",type:"iframe"}]},{path:"/document",label:"文档",icon:"icon-document",children:[{path:"/document/start",label:"开始使用",icon:"icon-document"},{path:"/document/package.json",label:"Package文件说明",icon:"icon-document"}]},{type:"divider"},{path:"/user/center",label:"个人中心",icon:"icon-user-permissions",children:[{path:"/user/center/index",label:"个人中心",icon:"icon-example"},{path:"/user/center/update",label:"修改信息",icon:"icon-document"}]}];function Be(t){return!!(typeof t.children>"u"||Array.isArray(t.children)&&t.children.length===0)}function te(t){return ae(t)?!1:!!(typeof t.children<"u"&&Array.isArray(t.children)&&t.children.length>0)}function pe(t){return typeof t.path=="string"&&typeof t.label=="string"}function ae(t){return typeof t.type<"u"&&t.type==="group"}function Ct(t){return typeof t.type<"u"&&t.type==="divider"}const St=void 0,_=d.createContext(St),It=({children:t})=>{let n=0;const r=d.useMemo(()=>Ce,[Ce]),[a,l]=d.useState(r),[o,u]=d.useState(!1),{mapPathToMenu:i,mapKeyToMenu:c,processedMenuList:s}=d.useMemo(()=>(()=>{const f=new Map,v=new Map,P=b=>(b.key||(b.key=String(++n)),{...b}),T=b=>b.map(A=>{const k=P(A);return(te(k)||ae(k))&&(k.children=T(k.children||[])),pe(k)&&v.set(k.path,k),k!=null&&k.key&&f.set(k.key,k),k});return{processedMenuList:T(a),mapKeyToMenu:f,mapPathToMenu:v}})(),[a]),g=d.useMemo(()=>({menuList:s,setMenuList:l,menuCollapsed:o,setMenuCollapsed:u,mapPathToMenu:i,mapKeyToMenu:c}),[a,o]);return e(_.Provider,{value:g,children:t})},U={pageTitle:"后台管理系统模板",pageTitlePrefix:"后台管理",tokenKey:"Authorization",apiBaseUrl:"https://xstnet.github.io/react-admin-template/api",iconFontUrl:"//at.alicdn.com/t/c/font_3917407_iepuc225qt9.js"};function Pt(t,n){localStorage.setItem(t,typeof n=="object"?JSON.stringify(n):n)}function Tt(t){localStorage.setItem(U.tokenKey,typeof t=="object"?JSON.stringify(t):t)}function Ee(t){return localStorage.getItem(t)}function Mt(t){const n=localStorage.getItem(t);if(n!==null)return Number(n)}function Nt(t){const n=localStorage.getItem(t);if(n!==null)return n==="true"}function Lt(t){const n=localStorage.getItem(t);if(n!==null)return JSON.parse(n)}function wt(t){return Ee(t)!==null}function At(t){localStorage.removeItem(t)}function Ut(){localStorage.removeItem(U.tokenKey)}function Ft(){localStorage.clear()}const w={set:Pt,setToken:Tt,has:wt,getString:Ee,getObject:Lt,getBoolean:Nt,getNumber:Mt,remove:At,removeToken:Ut,clear:Ft},je=()=>{const[t,n]=d.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);return d.useEffect(()=>{const a=l=>{console.log("chage",l.matches),l.matches?n(!0):n(!1)};return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",a)}},[]),[t?"dark":"light"]},Ot=void 0,$t=d.createContext(Ot),Rt=({children:t})=>{const{settings:{primaryColor:n,theme:r,compactMode:a,followSystemTheme:l}}=d.useContext(W),[o]=je(),u={},i=()=>{const c=[];return l?c.push(o==="light"?R.defaultAlgorithm:R.darkAlgorithm):c.push(r==="light"?R.defaultAlgorithm:R.darkAlgorithm),console.log("algorighm",r,c),a&&c.push(R.compactAlgorithm),c};return e($t.Provider,{value:u,children:e(Ne,{locale:_e,theme:{algorithm:i(),token:{colorPrimary:n},components:{Button:{borderRadius:4,borderRadiusSM:2},Modal:{borderRadius:4,borderRadiusOuter:2}}},children:t})})},Dt=void 0,W=d.createContext(Dt),Bt=({children:t})=>{const n=d.useMemo(()=>{const u=w.getObject("settings")||{};return console.log("settingsCache",u),{theme:"light",compactMode:!1,followSystemTheme:!1,fixedHeader:!0,fixedMenu:!0,primaryColor:"#00b96b",...u}},[]),[r,a]=d.useState(n),l=d.useCallback(u=>{const i={...r,...u};a(i),w.set("settings",i)},[r]),o={settings:r,setSetting:l};return e(W.Provider,{value:o,children:e(Rt,{children:t})})},Et=void 0,ge=d.createContext(Et),jt=({children:t})=>{const[n,r]=d.useState(!1),[a,{toggleFullscreen:l}]=We(document.body),[o,u]=d.useState(null),i=d.useMemo(()=>({isLogin:n,setIsLogin:r,userInfo:o,setUserInfo:u,fullScreen:a,setFullScreen:l}),[n,o,a]);return e(ge.Provider,{value:i,children:e(Bt,{children:e(It,{children:t})})})},$=Je({scriptUrl:U.iconFontUrl,extraCommonProps:{}}),fe="/iframe",qe=t=>`${fe}?url=${t}`;function Ke(){}function qt(t,n,r=3){return typeof t!="string"||typeof n!="string"?"":n.length?r&1&&t.startsWith(n)?t.substring(n.length):r&2&&t.endsWith(n)?t.substring(0,t.length-n.length):t:t}function Kt(t,n){return qt(t,n,2)}const Vt=()=>{const t=K(),{menuList:n,mapKeyToMenu:r,mapPathToMenu:a}=d.useContext(_);let l="/dashboard",o=[],u=!1;const i=location.pathname.replace(Kt("/react-admin-template/","/"),""),[c]=ne(),s=y=>{const f=r.get(y.key);if(console.log("mapKeyToMenu",r),console.log("clicked menu",y,f),!f){console.warn("未获取到菜单信息");return}if(f.path!==i){if((f==null?void 0:f.type)==="url"){window.open(f.path,"_blank");return}if(document.title=`${U.pageTitlePrefix} - ${f.label}`,(f==null?void 0:f.type)==="iframe"){console.log("打开iframe页面"),t(qe(f.path));return}t(f.path)}},g=d.useMemo(()=>{const y=v=>v.badge?v.badge==="dot"?e(be,{className:"menu-item-badge",offset:[6,0],dot:!0,children:v.label}):e(be,{className:"menu-item-badge",offset:[15,0],count:v.badge,children:v.label}):v.label,f=(v,P)=>{const T=[];return!u&&P&&o.push(P.key),v.map(p=>{var A;if(pe(p)&&(p.parent&&i.indexOf(p.path)===0&&(console.log("dddddd",a,a.get(p.parent),p.parent),l=((A=a.get(p.parent))==null?void 0:A.key)||"",u=!0),p.type==="iframe"&&(c.get("url")||"")===p.path&&(u=!0,l=p.key),p.hideInMenu))return;let b;if(Ct(p))b={...p};else if(ae(p))b={...p},p.children&&p.children.length>0&&(b.children=f(p.children));else if(te(p)||Be(p)){let{icon:k}=p;typeof k=="string"&&k.includes("icon-")&&(k=e($,{type:k})),b={key:"",...p,icon:k,label:y(p),children:te(p)?f(p.children,p):void 0},!u&&p.path===i&&(l=p.key,u=!0)}b&&(b.key=b.key,T.push(b))}),!u&&o.pop(),T};return f(n)},[n]);return e(Ge,{style:{height:"100%"},onClick:s,mode:"inline",defaultSelectedKeys:[l],items:g,defaultOpenKeys:o})},zt=G.memo(Vt),ye=()=>{const{token:t}=R.useToken();return t},Ht=()=>{const{menuCollapsed:t}=d.useContext(_),{colorBgContainer:n}=ye();return e(z.Sider,{style:{background:n},trigger:null,className:"left-sider",collapsible:!0,collapsed:t,children:e(zt,{})})};var ie=(t=>(t[t.success=0]="success",t[t.noLogin=-10001]="noLogin",t[t.loginExpired=-10002]="loginExpired",t))(ie||{}),Ve=(t=>(t[t.male=1]="male",t[t.female=2]="female",t))(Ve||{});const _t=10*1e3;j.defaults.baseURL=U.apiBaseUrl;j.defaults.headers.post["Content-Type"]="application/json; charset=utf-8";j.defaults.timeout=_t;j.interceptors.request.use(t=>(console.group(`${t.method}${t.url}${JSON.stringify(t.params)}`),t.headers.Authorization=`Bearer ${w.getString(U.tokenKey)}`,t),t=>Promise.reject(t));j.interceptors.response.use(t=>{const n=t.data;return typeof n.code!="number"?(O.error("系统错误",2),console.warn("api调用失败, 未正常返回数据, url:",t.config.url,"data:",n,"response:",t),console.groupEnd(),Promise.reject(t)):(console.log("Request log: ",t.config.url,t.data,t),console.groupEnd(),n.code===0?(t.config.method==="post"&&O.success(t.data.message),t):n.code===ie.noLogin?(O.error("您还没有登录, 即将跳转到登录页面, 请稍后..."),w.remove(U.tokenKey),location.reload(),Promise.reject(n)):n.code===ie.loginExpired?(O.error("登录已失效, 即将跳转到登录页面..."),w.remove(U.tokenKey),location.reload(),Promise.reject(n)):(O.error(n.message),Promise.reject(t)))},t=>(typeof t.message=="string"&&t.message==="Network Error"?O.error("网络错误, 请稍后再试!"):O.error("请求失败, 请稍后再试"),console.log("Request error",t),console.groupEnd(),Promise.reject(t)));const Wt=(t,n,r)=>{const a=r||{};return a.params=n,j.get(t,a)},Jt=(t,n,r)=>j.post(t,n,r),Gt=t=>j.request(t),M={get:Wt,post:Jt,request:Gt},N=t=>t.then(n=>Promise.resolve(n.data.data)).catch(n=>Promise.reject(n)),Qt=t=>{const n=M.post("/login",t);return N(n)},Zt=t=>N(M.get("/user/info",t)),Xt=t=>N(M.post("/user/logout",t)),Yt=(t,n)=>N(M.get("/user/list",{...t,...n})),en=t=>N(M.post("/user/create",t)),tn=t=>N(M.post("/user/update",t)),nn=t=>N(M.post("/user/delete",t)),rn=(t,n)=>N(M.get("/article/list",{...t,...n})),an=t=>N(M.get("/article/detail",t)),on=t=>N(M.post("/article/create",t)),ln=t=>N(M.post("/article/update",t)),sn=t=>N(M.post("/article/delete",t));const cn=t=>{const n=["#1890ff","#722ed1","#eb2f96","#00b96b","#52c41a","#13c2c2","#1677ff","#f5222d","#fa8c16","#faad14"],{onChange:r,presetColors:a=n,defaultSelectedColor:l=""}=t,{value:o=l}=t,[u,i]=d.useState(o),c=s=>{i(s),r==null||r(s)};return e("div",{className:"theme-color-wrap",children:a.map(s=>e("div",{onClick:()=>c(s),className:"theme-color-item",style:{backgroundColor:s},title:s,children:u===s&&e(Qe,{className:"checked-icon"})},s))})},dn=t=>{const{open:n,onClose:r=Ke}=t,{settings:a,setSetting:l}=d.useContext(W),[o]=h.useForm(),[u]=je(),i=d.useMemo(()=>({...a,theme:a.followSystemTheme?"followSystem":a.theme,showFooter:void 0}),[a]),c=(s,g)=>{const y={...s},{theme:f,fixedMenu:v,fixedHeader:P}=y;f&&(console.log("themeee",f),y.followSystemTheme=!1,f==="followSystem"&&(y.followSystemTheme=!0,y.theme=u)),v&&(y.fixedHeader=!0),P===!1&&(y.fixedMenu=!1),l(y),console.log("chage",s,g)};return Ze(()=>{o==null||o.setFieldsValue(i)},[i]),e(Xe,{title:"偏好设置",onClose:r,open:n,children:m(h,{name:"basic",labelCol:{span:5},wrapperCol:{span:19},initialValues:{...i},autoComplete:"off",onValuesChange:c,form:o,children:[e(h.Item,{label:"外观",name:"theme",children:m(q.Group,{buttonStyle:"solid",children:[m(q.Button,{value:"light",children:[e($,{type:"icon-theme-light"})," 浅色"]}),m(q.Button,{value:"dark",children:[e($,{type:"icon-theme-dark"})," 深色"]}),m(q.Button,{value:"followSystem",children:[e($,{type:"icon-followSystem"})," 跟随系统"]})]})}),e(h.Item,{label:"紧凑模式",valuePropName:"checked",name:"compactMode",children:e(Q,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(h.Item,{label:"主题色",name:"primaryColor",children:e(cn,{defaultSelectedColor:a.primaryColor})}),e(ue,{children:"布局"}),e(h.Item,{label:"固定头部",valuePropName:"checked",name:"fixedHeader",children:e(Q,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(h.Item,{help:"固定菜单启用时, 头部也会同步固定",label:"固定菜单",valuePropName:"checked",name:"fixedMenu",children:e(Q,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(h.Item,{valuePropName:"checked",label:"显示页脚",name:"showFootor",children:e(Q,{checkedChildren:"开启",unCheckedChildren:"关闭"})})]})})},un=t=>{const[n,r]=d.useState(!1);return m("div",{children:[e(dn,{open:n,onClose:()=>{r(!1)}}),e($,{onClick:()=>{r(!0)},title:"设置",type:"icon-setting",className:"action-icon"})]})},mn=()=>{const{fullScreen:t,setFullScreen:n,userInfo:r,setUserInfo:a,setIsLogin:l}=d.useContext(ge),{menuCollapsed:o,setMenuCollapsed:u}=d.useContext(_),{settings:{theme:i},setSetting:c}=d.useContext(W),{token:{colorBgContainer:s}}=R.useToken(),g=K(),y=()=>{O.success(t?"已退出全屏模式":"进入全屏模式"),n(!t)},f=()=>{c({followSystemTheme:!1,theme:i==="light"?"dark":"light"})},v=()=>m("div",{className:"left",children:[m("div",{className:"logo",children:[e($,{type:"icon-react",className:"logo-img"}),e("span",{className:"logo-text",children:"React Admin Template"})]}),e("div",{children:G.createElement(o?Ye:et,{onClick:()=>u(!o)})})]}),P=()=>{const T=()=>m(E,{children:[e($,{title:"搜索",type:"icon-search",className:"action-icon"}),t?e(nt,{title:"退出全屏模式",className:"action-icon",onClick:y}):e(rt,{title:"进入全屏模式",className:"action-icon",onClick:y}),e("a",{target:"_blank",className:"action-icon",title:"Go to Github",href:"https://github.com/xstnet/react-admin-template",rel:"norefer noopener",children:e(at,{})}),i==="dark"?e($,{onClick:f,title:"主题-深色模式",type:"icon-theme-dark",className:"action-icon"}):e($,{onClick:f,title:"主题-明亮模式",type:"icon-theme-light",className:"action-icon"}),e(un,{})]}),p=[{label:e("a",{children:"个人中心"}),icon:e(ot,{}),key:"userCenter"},{label:e("a",{children:"修改资料"}),key:"update",icon:e(me,{})},{type:"divider"},{label:"退出",icon:e(lt,{}),key:"logout",onClick:()=>{Xt().then(()=>{w.removeToken(),l(!1),a(null),g("/login")})}}];return e("div",{className:"right",children:m(D,{size:"middle",children:[T(),e(tt,{menu:{items:p},children:m(D,{className:"pointer",children:[e("span",{children:r==null?void 0:r.nickname}),e(Le,{src:r==null?void 0:r.avatar})]})})]})})};return e(z.Header,{className:"header",style:{background:s},children:m(E,{children:[v(),P()]})})},hn=G.memo(mn),Se=()=>e(E,{children:e("div",{children:m(H,{gutter:24,children:[e(C,{span:6,children:e(Z,{bordered:!1,children:e(X,{title:"今日销售额",value:126560,precision:2,prefix:"$"})})}),e(C,{span:6,children:e(Z,{bordered:!1,children:e(X,{title:"示例指标",value:11.28,precision:2,prefix:e(oe,{}),suffix:"%"})})}),e(C,{span:6,children:e(Z,{bordered:!1,children:e(X,{title:"示例指标",value:11.28,precision:2,prefix:e(oe,{}),suffix:"%"})})}),e(C,{span:6,children:e(Z,{bordered:!1,children:e(X,{title:"示例指标",value:11.28,precision:2,valueStyle:{color:"#3f8600"},prefix:e(oe,{}),suffix:"%"})})})]})})}),Ie=()=>e("span",{children:"UserCenterPage"}),pn=()=>e("span",{children:"UserCenterUpdatePage"});const ze=d.forwardRef(({state:t},n)=>{const[r]=h.useForm(),a=d.useRef(null);return d.useImperativeHandle(n,()=>({form:r,input:a.current}),[r,a]),e("div",{children:m(h,{form:r,labelCol:{span:3},name:"userForm",initialValues:t||void 0,children:[e(h.Item,{name:"username",label:"账号",rules:[{required:!0,message:"请输入账号"}],children:e(x,{ref:a})}),e(h.Item,{name:"password",label:"密码",rules:[{required:!t,message:"请输入密码"}],children:e(x.Password,{})}),e(h.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入昵称"}],children:e(x,{})}),e(h.Item,{name:"gender",label:"性别",children:m(q.Group,{children:[e(q,{value:1,children:"男"}),e(q,{value:2,children:"女"})]})}),e(h.Item,{name:"mobile",label:"手机号",children:e(x,{})}),e(h.Item,{name:"email",label:"邮箱",children:e(x,{})})]})})}),gn=({refreshList:t})=>{const[n,r]=d.useState(!1),{run:a,loading:l}=B(en,{manual:!0,debounceWait:100,onSuccess:()=>{var i;r(!1),(i=o.current)==null||i.form.resetFields(),t==null||t()}}),o=d.useRef(null);return m("div",{children:[e(I,{type:"primary",icon:e(re,{}),onClick:()=>{r(!0),setTimeout(()=>{var i,c;(c=(i=o.current)==null?void 0:i.input)==null||c.focus()},100)},children:"新增用户"}),e(we,{open:n,title:"添加用户",okText:"添加",cancelText:"取消",confirmLoading:l,onCancel:()=>r(!1),onOk:()=>{var i;(i=o.current)==null||i.form.validateFields().then(c=>{a(c)}).catch(c=>console.log(c))},children:e(ze,{ref:o})})]})},fn=({search:t,form:n})=>e(h,{form:n,name:"advanced_search",style:{paddingTop:16},onFinish:a=>{console.log("Received values of form: ",a)},children:m(H,{gutter:24,children:[e(C,{span:6,children:e(h.Item,{name:"username",label:"账号",children:e(x,{placeholder:"账号"})})}),e(C,{span:6,children:e(h.Item,{name:"mobile",label:"手机号",children:e(x,{placeholder:"手机号"})})}),e(C,{span:6,children:e(h.Item,{name:"email",label:"邮箱",children:e(x,{placeholder:"邮箱"})})}),m(C,{span:6,style:{textAlign:"right"},children:[e(I,{onClick:t.reset,children:"重置"}),e(I,{style:{margin:"0 8px"},type:"primary",onClick:t.submit,children:"查询"})]})]})}),He=(t,n)=>{const r=it(t,n),{tableProps:a}=r,l={...a.pagination,showTotal:(i,c)=>`第${c[0]}-${c[1]} 条/共 ${i} 条`,hideOnSinglePage:!0};a.pagination=l;const o=a.onChange,u=(...i)=>{var T;let[c,s,g,y]=i,f=c,v,P;Object.keys(g).length>0&&(Array.isArray(g)?(P={},g.map(p=>{var b;P[(b=p.column)==null?void 0:b.dataIndex]=p.order})):P={[(T=g.column)==null?void 0:T.dataIndex]:g.order}),Object.keys(s).length>0&&(v=s,console.log("filterrrrrrrrrrrrr",s)),o(f,v,P)};return a.onChange=u,r.tableProps.size="small",r},yn=({state:t,refreshList:n})=>{const[r,a]=d.useState(!1),{runAsync:l,loading:o}=B(tn,{manual:!0,debounceWait:100}),u=d.useRef(null);return m(E,{children:[e(I,{icon:e(me,{}),size:"small",onClick:()=>{a(!0),setTimeout(()=>{var c,s;(s=(c=u.current)==null?void 0:c.input)==null||s.focus()},100)},children:"编辑"}),e(we,{open:r,title:"更新用户信息用户",okText:"保存",cancelText:"取消",confirmLoading:o,onCancel:()=>a(!1),onOk:()=>{var c;(c=u.current)==null||c.form.validateFields().then(s=>{l({...s,id:t.id}).then(()=>{var g;a(!1),(g=u.current)==null||g.form.resetFields(),n==null||n()}).catch(Ke)}).catch(s=>console.log(s))},children:e(ze,{ref:u,state:t})})]})};const F=t=>{const{children:n,className:r="",style:a={},...l}=t,{colorBgContainer:o}=ye(),u="content-box",i={backgroundColor:o};return e("div",{className:`${u} ${r}`,style:{...i,...a},...l,children:n})},bn=()=>{var T;console.log("render ExampleUserListPage");const[t]=h.useForm(),[n,r]=d.useState([]),a=d.useRef();d.useEffect(()=>{a.current=new Map},[]);const{runAsync:l,loading:o}=B(nn,{manual:!0,debounceWait:100}),{refresh:u,tableProps:i,search:c}=He(Yt,{form:t}),s=()=>{c.reset(),c.submit()},g=p=>{var b;typeof p=="number"&&((b=a==null?void 0:a.current)==null||b.set(p,!0)),l({id:p}).then(()=>{typeof p=="object"&&r([]),u()}).finally(()=>{var A;return typeof p=="number"&&((A=a==null?void 0:a.current)==null?void 0:A.delete(p))})},y=d.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"头像",dataIndex:"avatar",render:p=>e(Le,{src:p})},{title:"账号",dataIndex:"username"},{title:"昵称",dataIndex:"nickname"},{title:"性别",dataIndex:"gender",render:p=>p===Ve.male?e(ke,{color:"blue",children:"男"}):e(ke,{color:"error",children:"女"})},{title:"邮箱",dataIndex:"email"},{title:"手机号",dataIndex:"mobile",sorter:!0},{title:"注册时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(p,b)=>{var k;const{id:A}=b;return m(D,{children:[e(le,{title:"确认要删除这条数据吗?",onConfirm:()=>g(A),children:e(I,{loading:(k=a==null?void 0:a.current)==null?void 0:k.has(A),icon:e(Ae,{}),size:"small",danger:!0,children:"删除"})}),e(yn,{state:b,refreshList:u})]})}}],[]),v={selectedRowKeys:n,onChange:p=>{console.log("selectedRowKeys changed: ",p),r(p)}},P=n.length>0;return m(E,{children:[m(F,{children:[e("div",{children:e(L.Title,{level:5,children:"搜索"})}),e(fn,{search:c,form:t})]}),e("br",{}),m(F,{children:[m("div",{className:"table-header",children:[e("div",{className:"left",children:e(L.Title,{level:5,children:"用户列表"})}),e("div",{className:"right",children:m(D,{size:"middle",children:[e(le,{title:`确定要删除这${n.length}条数据吗?`,onConfirm:()=>g(n),children:e(I,{type:"primary",danger:!0,disabled:!P,loading:o&&((T=a.current)==null?void 0:T.size)===0,children:"批量删除"})}),e(gn,{refreshList:s}),e(I,{type:"link",title:"点击刷新",onClick:u,icon:e(Ue,{})})]})})]}),e(Fe,{rowKey:"id",rowSelection:v,columns:y,...i})]})]})},Pe=({title:t="空白页"})=>e(F,{style:{height:"500px"},children:e(L.Title,{level:4,children:t})}),kn=({search:t,form:n})=>e(h,{form:n,name:"advanced_search",style:{paddingTop:16},onFinish:a=>{console.log("Received values of form: ",a)},children:m(H,{gutter:24,children:[e(C,{span:6,children:e(h.Item,{name:"title",label:"主题",children:e(x,{placeholder:"标题"})})}),e(C,{span:6,children:e(h.Item,{name:"ahthor",label:"作者",children:e(x,{placeholder:"作者"})})}),e(C,{span:6,children:e(h.Item,{name:"create_time",label:"发布时间",children:e(st.RangePicker,{})})}),m(C,{span:6,style:{textAlign:"right"},children:[e(I,{onClick:t.reset,children:"重置"}),e(I,{style:{margin:"0 8px"},type:"primary",onClick:t.submit,children:"查询"})]})]})});const Te=()=>{console.log("render ArticleIndexPage");const[t]=h.useForm(),n=d.useRef();K(),d.useEffect(()=>{n.current=new Map},[]);const{runAsync:r}=B(sn,{manual:!0,debounceWait:100}),{refresh:a,tableProps:l,search:o}=He(rn,{form:t}),u=c=>{var s;(s=n==null?void 0:n.current)==null||s.set(c,!0),r({id:c}).then(a).finally(()=>{var g;return(g=n==null?void 0:n.current)==null?void 0:g.delete(c)})},i=d.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"封面",dataIndex:"cover",render:c=>e(ct,{width:80,height:45,style:{borderRadius:4},src:c})},{title:"标题",dataIndex:"title"},{title:"简介",dataIndex:"description"},{title:"作者",dataIndex:"author"},{title:"发布时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(c,s)=>{var y;const{id:g}=s;return m(D,{children:[e(le,{title:"确认要删除这条数据吗?",onConfirm:()=>u(g),children:e(I,{loading:(y=n==null?void 0:n.current)==null?void 0:y.has(g),icon:e(Ae,{}),size:"small",danger:!0,children:"删除"})}),e(J,{to:`/article/update/${g}`,children:e(I,{icon:e(me,{}),size:"small",children:"编辑"})})]})}}],[]);return m(E,{children:[m(F,{children:[e("div",{children:e(L.Title,{level:5,children:"搜索"})}),e(kn,{search:o,form:t})]}),e("br",{}),m(F,{children:[m("div",{className:"table-header",children:[e("div",{className:"left",children:e(L.Title,{level:5,children:"文章列表"})}),e("div",{className:"right",children:m(D,{size:"middle",children:[e(J,{to:"/article/create",children:e(I,{type:"primary",icon:e(re,{}),children:"发布文章"})}),e(I,{type:"link",title:"点击刷新",onClick:a,icon:e(Ue,{})})]})})]}),e(Fe,{rowKey:"id",columns:i,...l})]})]})},vn=()=>{const[t]=h.useForm(),n=K(),r="articleDraft",{loading:a,run:l}=B(on,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{w.remove(r),n("/article/list")},200)}),o=w.getObject(r)||{},u=async()=>{const s=await t.validateFields();l(s)},i=()=>{const{cover:s,...g}=t.getFieldsValue();w.set(r,g),O.success("已保存到草稿箱")},c=s=>(console.log("Upload event:",s),Array.isArray(s)?s:s&&s.fileList);return m(F,{children:[e(L.Title,{level:3,children:"发布文章"}),e(ue,{}),e(h,{form:t,name:"createForm",labelCol:{span:3},initialValues:o,children:m(H,{gutter:36,children:[m(C,{span:16,children:[e(h.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(x,{})}),e(h.Item,{label:"简介",name:"description",children:e(x,{})}),e(h.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:e(x.TextArea,{rows:20})}),e(h.Item,{wrapperCol:{offset:3},children:m(D,{children:[e(I,{icon:e(Oe,{}),onClick:u,loading:a,type:"primary",children:"发布文章"}),e(I,{icon:e(dt,{}),onClick:i,children:"保存为草稿"})]})})]}),m(C,{span:8,children:[e(h.Item,{label:"封面",name:"cover",getValueFromEvent:c,valuePropName:"fileList",children:e($e,{maxCount:1,listType:"picture-card",children:m("div",{children:[e(re,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(h.Item,{label:"标签",name:"tags",children:e(Re,{mode:"tags",placeholder:"文章标签"})}),e(h.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(x,{})})]})]})})]})},xn=()=>{const[t]=h.useForm(),n=K(),r=ut(),{loading:a,run:l}=B(an,{manual:!0,debounceWait:10,onSuccess:s=>t.setFieldsValue(s)});d.useEffect(()=>{l({id:r.id})},[r.id]);const{loading:o,run:u}=B(ln,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{n("/article/list")},200)}),i=async()=>{const s=await t.validateFields();u(s)},c=s=>(console.log("Upload event:",s),Array.isArray(s)?s:s&&s.fileList);return m(F,{children:[e(L.Title,{level:3,children:"更新文章"}),e(ue,{}),e(he,{spinning:a,children:e(h,{form:t,name:"createForm",labelCol:{span:3},children:m(H,{gutter:36,children:[m(C,{span:16,children:[e(h.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(x,{})}),e(h.Item,{label:"简介",name:"description",children:e(x,{})}),e(h.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:e(x.TextArea,{rows:20})}),e(h.Item,{wrapperCol:{offset:3},children:e(D,{children:e(I,{icon:e(Oe,{}),onClick:i,loading:o,type:"primary",children:"保存"})})})]}),m(C,{span:8,children:[e(h.Item,{label:"封面",name:"cover",getValueFromEvent:c,valuePropName:"fileList",children:e($e,{maxCount:1,listType:"picture-card",children:m("div",{children:[e(re,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(h.Item,{label:"标签",name:"tags",children:e(Re,{mode:"tags",placeholder:"文章标签"})}),e(h.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(x,{})})]})]})})})]})},Cn=()=>{const t=De();return m(F,{style:{},children:[e(L.Title,{children:"404"}),e(L.Paragraph,{children:"页面不存在"}),m(L.Paragraph,{children:["路由: ",t.pathname]}),e(J,{to:"/",children:"回到首页"})]})};const Sn=t=>{const{title:n="Iframe Page",name:r="internal-iframe"}=t,a=d.useRef(null),[l,o]=d.useState(!0),[u]=ne();d.useEffect(()=>{o(!0)},[u]);const i=u.get("url"),c=()=>{o(!1)};return i?e(E,{children:e(F,{style:{height:"100%",padding:0},children:e(he,{wrapperClassName:"iframeSpin",spinning:l,tip:"正在加载第三方页面, 请稍后...",children:e("iframe",{ref:a,width:"100%",height:"100%",onLoad:c,title:n,name:r,src:i})})})}):e(F,{children:e(mt,{message:"无效的url地址",type:"error"})})};function In(){return ht([{path:"/",element:e(Se,{})},{path:"/dashboard",element:e(Se,{})},{path:"/user",children:[{index:!0,element:e(Ie,{})},{path:"/user/center/index",element:e(Ie,{})},{path:"/user/center/update",element:e(pn,{})}]},{path:"/example/userList",element:e(bn,{})},{path:"/article",children:[{index:!0,element:e(Te,{})},{path:"/article/list",element:e(Te,{})},{path:"/article/create",element:e(vn,{})},{path:"/article/update/:id",element:e(xn,{})}]},{path:"/blank",element:e(Pe,{})},{path:fe,element:e(Sn,{})},{path:"/multilevel/menu/2/3",element:e(Pe,{title:"三级菜单"})},{path:"*",element:e(Cn,{})}])}const Pn=()=>e(z.Content,{className:"content",children:e(In,{})}),Tn=G.memo(Pn);const ee=new Map,se=t=>{t.map(n=>{pe(n)&&(n==null?void 0:n.type)==="url"||(ae(n)&&se(n.children||[]),(te(n)||Be(n))&&(n.path&&ee.set(n.path,n.label),n.children&&se(n.children||[])))})},Mn=()=>{const{menuList:t}=d.useContext(_),n=d.useMemo(()=>(ee.clear(),se(t),ee),[t]),r=De(),[a]=ne(),l=()=>{if(r.pathname===fe){const i=a.get("url");if(i&&ee.has(i))return[e(Y.Item,{children:e(J,{style:{color:"inherit"},to:qe(i),children:n.get(i)})},i)]}return[]},o=d.useMemo(()=>{const i=r.pathname.split("/").filter(c=>c);return i.map((c,s)=>{const g=`/${i.slice(0,s+1).join("/")}`;return n.has(g)?e(Y.Item,{children:s===i.length-1?e(J,{style:{color:"inherit"},to:g,children:n.get(g)}):n.get(g)},g):null})},[r]),u=[e(Y.Item,{children:e(pt,{})},"home"),...o,...l()];return e(Y,{className:"breadcrumb",children:u})},Nn=G.memo(Mn);function Ln(t){const n=t.split(".")[1];if(n)try{return JSON.parse(gt(n))}catch(r){console.warn("Parse Token Error: ",r);return}}function ce(){var r;const t=w.getString(U.tokenKey);if(!t)return!1;const n=Ln(t);return n!==void 0&&((r=n==null?void 0:n.data)==null?void 0:r.uid)>0&&n.exp>new Date().getTime()/1e3}const wn=({loading:t,title:n})=>{const{settings:{theme:r}}=d.useContext(W);return e(he,{size:"large",spinning:t,tip:n,wrapperClassName:`page-loading-spin-${r}`,children:e("div",{style:{height:"100vh",width:"100vw"}})})};const An=()=>{const[t,n]=d.useState(!0),{setIsLogin:r,setUserInfo:a}=d.useContext(ge),{menuCollapsed:l}=d.useContext(_),{colorBgContainer:o}=ye(),{settings:{fixedMenu:u,fixedHeader:i}}=d.useContext(W),c=K(),[s]=ne();return console.log("default layout render..."),d.useEffect(()=>{if(!ce()){c("/login");return}Zt().then(g=>{if(n(!1),r(!0),a(g),s.has("ghpage")){const y=decodeURIComponent(s.get("ghpage"));c(y);return}}).catch(g=>{g instanceof ft&&yt.error({message:"网络错误",description:"获取用户信息失败, 无法打开页面",duration:null,closeIcon:null})})},[]),ce()?t?e(wn,{title:"页面加载中",loading:t}):m(z,{"data-fixed-menu":u?1:0,"data-menu-collapsed":l?1:0,"data-fixed-header":i?1:0,style:{background:o},className:"default-layout",children:[e(hn,{}),m(z,{children:[e(Ht,{}),m(z,{className:"content-layout",children:[e(Nn,{}),e(Tn,{})]})]})]}):(c("/login"),null)};const Un=()=>{const t=K(),{loading:n,run:r}=B(Qt,{manual:!0,debounceWait:300,onSuccess:o=>{w.setToken(o.token),t("/dashboard")}});document.title=U.pageTitle;const a=o=>{r(o)};d.useEffect(()=>{ce()&&t("/dashboard")},[]);const l={remember:!0,username:"admin",password:"123456"};return e(E,{children:m(Ne,{theme:{algorithm:[R.defaultAlgorithm]},children:[e("div",{className:"bg-wrap"}),m(H,{className:"login-wrap",children:[e(C,{span:15,className:"login-banner"}),m(C,{span:9,className:"login-form-wrap",children:[e(L.Title,{style:{textAlign:"center"},children:"后台管理系统"}),e("br",{}),m(h,{name:"loginForm",labelCol:{span:5},wrapperCol:{span:19},style:{maxWidth:600},initialValues:l,onFinish:a,autoComplete:"off",children:[e(h.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名!"}],children:e(x,{placeholder:"admin"})}),e(h.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码!"}],children:e(x.Password,{placeholder:"123456"})}),e(h.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:5},children:e(bt,{children:"记住我"})}),e(h.Item,{wrapperCol:{offset:5,span:16},children:e(I,{loading:n,type:"primary",htmlType:"submit",children:"登录"})})]})]})]})]})})};function Fn(){return d.useEffect(()=>{},[]),e(jt,{children:e("div",{className:"App",children:m(kt,{children:[e(ve,{element:e(Un,{}),path:"/login"}),e(ve,{path:"*",element:e(An,{})})]})})})}function Me(t){const n=JSON.stringify({type:"JWT",alg:"HS256"}),r=Number((new Date().getTime()/1e3).toFixed(0)),a=JSON.stringify({iss:"github.com/xstnet",sub:"react-admin",iat:r,exp:r+86400*14,data:t}),l="H_97UyQUOmURnZdDwI0khuAt4Cmg";return`${xe(n)}.${xe(a)}.${l}`}S.mock(/api\/login/,"post",({body:t})=>{const{username:n,password:r}=JSON.parse(t);return n==="admin"?r!=="123456"?{code:-1,message:"密码错误"}:{code:0,message:"登录成功",data:{token:Me({uid:1})}}:{code:0,message:"登录成功",data:{token:Me({uid:V.Random.natural(2,1e4)})}}});S.setup({timeout:100});S.mock(/api\/user\/info/,"get",t=>({code:0,message:"ok",data:{id:1,username:"admin",nickname:"醉丶春风",avatar:"https://www.xstnet.com/static/images/head.gif",password:"",gender:V.Random.natural(1,2),email:"shantongxu@qq.com",mobile:"133xxxx3333"}}));S.mock(/api\/user\/logout/,"post",t=>({code:0,message:"退出成功"}));S.mock(/api\/user\/list/,"get",t=>{const n=new URLSearchParams(t.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,username:"@first@last",nickname:"@cname",avatar:()=>V.Random.dataImage("200x200"),email:"@email",mobile:()=>S.mock(/^1[3456789]\d{9}$/).replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"),"gender|1-2":0,create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return S.mock(a)});S.mock(/api\/user\/create/,"post",t=>({code:0,message:"创建成功",data:{id:V.Random.natural(100,9999)}}));S.mock(/api\/user\/update/,"post",t=>({code:0,message:"更新成功"}));S.mock(/api\/user\/delete/,"post",t=>({code:0,message:"删除成功"}));S.setup({timeout:100});S.mock(/api\/article\/detail/,"get",t=>(console.log("🚀 ~ file: article.ts:7 ~ Mock.mock ~ options:",t),{code:0,message:"ok",data:{id:1,title:"主题",description:"醉丶春风",author:"醉丶春风",tags:[1,2],content:"content",create_time:V.Random.datetime()}}));S.mock(/api\/article\/list/,"get",t=>{const n=new URLSearchParams(t.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,author:"@first@last",title:()=>S.Random.ctitle(5,20),description:"@cname",cover:()=>V.Random.dataImage("480x270","封面"),content:"@email",create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return S.mock(a)});S.mock(/api\/article\/create/,"post",t=>({code:0,message:"创建成功",data:{id:V.Random.natural(100,9999)}}));S.mock(/api\/article\/update/,"post",t=>({code:0,message:"更新成功"}));S.mock(/api\/article\/delete/,"post",t=>({code:0,message:"删除成功"}));vt.createRoot(document.getElementById("root")).render(e(xt,{basename:"/react-admin-template/",children:e(Fn,{})}));
