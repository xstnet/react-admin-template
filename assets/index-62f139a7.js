import{j as de,r as c,C as Le,z as We,t as R,u as Je,c as Ge,R as Q,a as V,b as ne,M as Qe,B as be,L as _,d as E,m as O,e as Xe,F as h,f as Ye,D as Ze,g as K,S as X,h as ue,i as et,k as tt,l as D,n as nt,A as Ae,o as rt,p as at,G as ot,U as lt,E as me,q as it,s as st,v as H,w as ct,x as dt,y as ut,X as mt,Y as ht,T as pt,H as gt,I as q,J as x,K as Y,N as oe,O as C,P as B,Q as I,V as re,W as we,Z as ft,_ as ke,$ as le,a0 as Ue,a1 as L,a2 as Fe,a3 as Oe,a4 as yt,a5 as bt,a6 as G,a7 as $e,a8 as kt,a9 as Re,aa as De,ab as vt,ac as he,ad as Be,ae as xt,af as Ct,ag as Z,ah as St,ai as It,aj as Pt,ak as Tt,al as Mt,am as Nt,an as ve,ao as S,ap as z,aq as xe,ar as Lt,as as At}from"./vendor-71b3f8f7.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function r(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(l){if(l.ep)return;l.ep=!0;const o=r(l);fetch(l.href,o)}})();const j=de.Fragment,e=de.jsx,u=de.jsxs,Ce=[{label:"控制台",type:"group",children:[{label:"控制台",icon:"icon-dashboard",path:"/dashboard"}]},{label:"示例页面",type:"group",children:[{label:"列表页",icon:"icon-list",path:"/example/userList"},{label:"多级菜单",icon:"icon-list",path:"/multilevel/menu",children:[{label:"二级菜单",icon:"icon-list",path:"/multilevel/menu/2",children:[{label:"三级菜单",icon:"icon-list",path:"/multilevel/menu/2/3"}]}]},{label:"空白页",icon:"icon-example",path:"/blank"},{label:"404",icon:"icon-example",path:"/404"}]},{label:"徽标示例",type:"group",children:[{label:"红点徽标",icon:"icon-list",badge:"dot",path:"/blank"},{label:"数字徽标",icon:"icon-example",badge:98,path:"/blank"}]},{type:"divider"},{path:"/article",label:"文章管理",icon:"icon-article",children:[{path:"/article/list",label:"文章列表",icon:"icon-article"},{path:"/article/create",label:"发布文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/update",label:"更新文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/category",label:"分类管理",icon:"icon-list"}]},{path:"/iframe",label:"外部页面",icon:"icon-href",children:[{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(外链)",icon:"icon-document",key:"webpage-antd-document",type:"url"},{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(内嵌)",icon:"icon-document",type:"iframe"},{path:"https://www.xstnet.com",label:"博客主页(内嵌)",icon:"icon-document",type:"iframe"}]},{path:"/document",label:"文档",icon:"icon-document",children:[{path:"/document/start",label:"开始使用",icon:"icon-document"},{path:"/document/package.json",label:"Package文件说明",icon:"icon-document"}]},{type:"divider"},{path:"/user/center",label:"个人中心",icon:"icon-user-permissions",children:[{path:"/user/center/index",label:"个人中心",icon:"icon-example"},{path:"/user/center/update",label:"修改信息",icon:"icon-document"}]}];function je(t){return!!(typeof t.children>"u"||Array.isArray(t.children)&&t.children.length===0)}function te(t){return ae(t)?!1:!!(typeof t.children<"u"&&Array.isArray(t.children)&&t.children.length>0)}function pe(t){return typeof t.path=="string"&&typeof t.label=="string"}function ae(t){return typeof t.type<"u"&&t.type==="group"}function wt(t){return typeof t.type<"u"&&t.type==="divider"}const Ut=void 0,W=c.createContext(Ut),Ft=({children:t})=>{let n=0;const r=c.useMemo(()=>Ce,[Ce]),[a,l]=c.useState(r),[o,m]=c.useState(!1),{mapPathToMenu:i,mapKeyToMenu:d,processedMenuList:s}=c.useMemo(()=>(()=>{const f=new Map,v=new Map,P=b=>(b.key||(b.key=String(++n)),{...b}),T=b=>b.map(w=>{const k=P(w);return(te(k)||ae(k))&&(k.children=T(k.children||[])),pe(k)&&v.set(k.path,k),k!=null&&k.key&&f.set(k.key,k),k});return{processedMenuList:T(a),mapKeyToMenu:f,mapPathToMenu:v}})(),[a]),g=c.useMemo(()=>({menuList:s,setMenuList:l,menuCollapsed:o,setMenuCollapsed:m,mapPathToMenu:i,mapKeyToMenu:d}),[a,o]);return e(W.Provider,{value:g,children:t})},U={pageTitle:"后台管理系统模板",pageTitlePrefix:"后台管理",tokenKey:"Authorization",apiBaseUrl:"https://xstnet.github.io/react-admin-template/api",iconFontUrl:"//at.alicdn.com/t/c/font_3917407_iepuc225qt9.js"};function Ot(t,n){localStorage.setItem(t,typeof n=="object"?JSON.stringify(n):n)}function $t(t){localStorage.setItem(U.tokenKey,typeof t=="object"?JSON.stringify(t):t)}function Ee(t){return localStorage.getItem(t)}function Rt(t){const n=localStorage.getItem(t);if(n!==null)return Number(n)}function Dt(t){const n=localStorage.getItem(t);if(n!==null)return n==="true"}function Bt(t){const n=localStorage.getItem(t);if(n!==null)return JSON.parse(n)}function jt(t){return Ee(t)!==null}function Et(t){localStorage.removeItem(t)}function Kt(){localStorage.removeItem(U.tokenKey)}function qt(){localStorage.clear()}const A={set:Ot,setToken:$t,has:jt,getString:Ee,getObject:Bt,getBoolean:Dt,getNumber:Rt,remove:Et,removeToken:Kt,clear:qt},Ke=()=>{const[t,n]=c.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);return c.useEffect(()=>{const a=l=>{console.log("chage",l.matches),l.matches?n(!0):n(!1)};return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",a)}},[]),[t?"dark":"light"]},Vt=void 0,zt=c.createContext(Vt),Ht=({children:t})=>{const{settings:{primaryColor:n,theme:r,compactMode:a,followSystemTheme:l}}=c.useContext(J),[o]=Ke(),m={},i=()=>{const d=[];return l?d.push(o==="light"?R.defaultAlgorithm:R.darkAlgorithm):d.push(r==="light"?R.defaultAlgorithm:R.darkAlgorithm),console.log("algorighm",r,d),a&&d.push(R.compactAlgorithm),d};return e(zt.Provider,{value:m,children:e(Le,{locale:We,theme:{algorithm:i(),token:{colorPrimary:n},components:{Button:{borderRadius:4,borderRadiusSM:2},Modal:{borderRadius:4,borderRadiusOuter:2}}},children:t})})},_t=void 0,J=c.createContext(_t),Wt=({children:t})=>{const n=c.useMemo(()=>{const m=A.getObject("settings")||{};return console.log("settingsCache",m),{theme:"light",compactMode:!1,followSystemTheme:!1,fixedHeader:!0,fixedMenu:!0,primaryColor:"#00b96b",...m}},[]),[r,a]=c.useState(n),l=c.useCallback(m=>{const i={...r,...m};a(i),A.set("settings",i)},[r]),o={settings:r,setSetting:l};return e(J.Provider,{value:o,children:e(Ht,{children:t})})},Jt=void 0,ge=c.createContext(Jt),Gt=({children:t})=>{const[n,r]=c.useState(!1),[a,{toggleFullscreen:l}]=Je(document.body),[o,m]=c.useState(null),i=c.useMemo(()=>({isLogin:n,setIsLogin:r,userInfo:o,setUserInfo:m,fullScreen:a,setFullScreen:l}),[n,o,a]);return e(ge.Provider,{value:i,children:e(Wt,{children:e(Ft,{children:t})})})},$=Ge({scriptUrl:U.iconFontUrl,extraCommonProps:{}}),fe="/iframe",qe=t=>`${fe}?url=${t}`;function Ve(){}function Qt(t,n,r=3){return typeof t!="string"||typeof n!="string"?"":n.length?r&1&&t.startsWith(n)?t.substring(n.length):r&2&&t.endsWith(n)?t.substring(0,t.length-n.length):t:t}function Xt(t,n){return Qt(t,n,2)}function Se(t,n){return Math.floor(Math.random()*(n-t+1))+t}const Yt=()=>{const t=V(),{menuList:n,mapKeyToMenu:r,mapPathToMenu:a}=c.useContext(W);let l="/dashboard",o=[],m=!1;const i=location.pathname.replace(Xt("/react-admin-template/","/"),""),[d]=ne(),s=y=>{const f=r.get(y.key);if(console.log("mapKeyToMenu",r),console.log("clicked menu",y,f),!f){console.warn("未获取到菜单信息");return}if(f.path!==i){if((f==null?void 0:f.type)==="url"){window.open(f.path,"_blank");return}if(document.title=`${U.pageTitlePrefix} - ${f.label}`,(f==null?void 0:f.type)==="iframe"){console.log("打开iframe页面"),t(qe(f.path));return}t(f.path)}},g=c.useMemo(()=>{const y=v=>v.badge?v.badge==="dot"?e(be,{className:"menu-item-badge",offset:[6,0],dot:!0,children:v.label}):e(be,{className:"menu-item-badge",offset:[15,0],count:v.badge,children:v.label}):v.label,f=(v,P)=>{const T=[];return!m&&P&&o.push(P.key),v.map(p=>{var w;if(pe(p)&&(p.parent&&i.indexOf(p.path)===0&&(console.log("dddddd",a,a.get(p.parent),p.parent),l=((w=a.get(p.parent))==null?void 0:w.key)||"",m=!0),p.type==="iframe"&&(d.get("url")||"")===p.path&&(m=!0,l=p.key),p.hideInMenu))return;let b;if(wt(p))b={...p};else if(ae(p))b={...p},p.children&&p.children.length>0&&(b.children=f(p.children));else if(te(p)||je(p)){let{icon:k}=p;typeof k=="string"&&k.includes("icon-")&&(k=e($,{type:k})),b={key:"",...p,icon:k,label:y(p),children:te(p)?f(p.children,p):void 0},!m&&p.path===i&&(l=p.key,m=!0)}b&&(b.key=b.key,T.push(b))}),!m&&o.pop(),T};return f(n)},[n]);return e(Qe,{style:{height:"100%"},onClick:s,mode:"inline",defaultSelectedKeys:[l],items:g,defaultOpenKeys:o})},Zt=Q.memo(Yt),ye=()=>{const{token:t}=R.useToken();return t},en=()=>{const{menuCollapsed:t}=c.useContext(W),{colorBgContainer:n}=ye();return e(_.Sider,{style:{background:n},trigger:null,className:"left-sider",collapsible:!0,collapsed:t,children:e(Zt,{})})};var ie=(t=>(t[t.success=0]="success",t[t.noLogin=-10001]="noLogin",t[t.loginExpired=-10002]="loginExpired",t))(ie||{}),ze=(t=>(t[t.male=1]="male",t[t.female=2]="female",t))(ze||{});const tn=10*1e3;E.defaults.baseURL=U.apiBaseUrl;E.defaults.headers.post["Content-Type"]="application/json; charset=utf-8";E.defaults.timeout=tn;E.interceptors.request.use(t=>(console.group(`${t.method}${t.url}${JSON.stringify(t.params)}`),t.headers.Authorization=`Bearer ${A.getString(U.tokenKey)}`,t),t=>Promise.reject(t));E.interceptors.response.use(t=>{const n=t.data;return typeof n.code!="number"?(O.error("系统错误",2),console.warn("api调用失败, 未正常返回数据, url:",t.config.url,"data:",n,"response:",t),console.groupEnd(),Promise.reject(t)):(console.log("Request log: ",t.config.url,t.data,t),console.groupEnd(),n.code===0?(t.config.method==="post"&&O.success(t.data.message),t):n.code===ie.noLogin?(O.error("您还没有登录, 即将跳转到登录页面, 请稍后..."),A.remove(U.tokenKey),location.reload(),Promise.reject(n)):n.code===ie.loginExpired?(O.error("登录已失效, 即将跳转到登录页面..."),A.remove(U.tokenKey),location.reload(),Promise.reject(n)):(O.error(n.message),Promise.reject(t)))},t=>(typeof t.message=="string"&&t.message==="Network Error"?O.error("网络错误, 请稍后再试!"):O.error("请求失败, 请稍后再试"),console.log("Request error",t),console.groupEnd(),Promise.reject(t)));const nn=(t,n,r)=>{const a=r||{};return a.params=n,E.get(t,a)},rn=(t,n,r)=>E.post(t,n,r),an=t=>E.request(t),M={get:nn,post:rn,request:an},N=t=>t.then(n=>Promise.resolve(n.data.data)).catch(n=>Promise.reject(n)),on=t=>{const n=M.post("/login",t);return N(n)},ln=t=>N(M.get("/user/info",t)),sn=t=>N(M.post("/user/logout",t)),cn=(t,n)=>N(M.get("/user/list",{...t,...n})),dn=t=>N(M.post("/user/create",t)),un=t=>N(M.post("/user/update",t)),mn=t=>N(M.post("/user/delete",t)),hn=(t,n)=>N(M.get("/article/list",{...t,...n})),pn=t=>N(M.get("/article/detail",t)),gn=t=>N(M.post("/article/create",t)),fn=t=>N(M.post("/article/update",t)),yn=t=>N(M.post("/article/delete",t));const bn=t=>{const n=["#1890ff","#722ed1","#eb2f96","#00b96b","#52c41a","#13c2c2","#1677ff","#f5222d","#fa8c16","#faad14"],{onChange:r,presetColors:a=n,defaultSelectedColor:l=""}=t,{value:o=l}=t,[m,i]=c.useState(o),d=s=>{i(s),r==null||r(s)};return e("div",{className:"theme-color-wrap",children:a.map(s=>e("div",{onClick:()=>d(s),className:"theme-color-item",style:{backgroundColor:s},title:s,children:m===s&&e(Xe,{className:"checked-icon"})},s))})},kn=t=>{const{open:n,onClose:r=Ve}=t,{settings:a,setSetting:l}=c.useContext(J),[o]=h.useForm(),[m]=Ke(),i=c.useMemo(()=>({...a,theme:a.followSystemTheme?"followSystem":a.theme,showFooter:void 0}),[a]),d=(s,g)=>{const y={...s},{theme:f,fixedMenu:v,fixedHeader:P}=y;f&&(console.log("themeee",f),y.followSystemTheme=!1,f==="followSystem"&&(y.followSystemTheme=!0,y.theme=m)),v&&(y.fixedHeader=!0),P===!1&&(y.fixedMenu=!1),l(y),console.log("chage",s,g)};return Ye(()=>{o==null||o.setFieldsValue(i)},[i]),e(Ze,{title:"偏好设置",onClose:r,open:n,children:u(h,{name:"basic",labelCol:{span:5},wrapperCol:{span:19},initialValues:{...i},autoComplete:"off",onValuesChange:d,form:o,children:[e(h.Item,{label:"外观",name:"theme",children:u(K.Group,{buttonStyle:"solid",children:[u(K.Button,{value:"light",children:[e($,{type:"icon-theme-light"})," 浅色"]}),u(K.Button,{value:"dark",children:[e($,{type:"icon-theme-dark"})," 深色"]}),u(K.Button,{value:"followSystem",children:[e($,{type:"icon-followSystem"})," 跟随系统"]})]})}),e(h.Item,{label:"紧凑模式",valuePropName:"checked",name:"compactMode",children:e(X,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(h.Item,{label:"主题色",name:"primaryColor",children:e(bn,{defaultSelectedColor:a.primaryColor})}),e(ue,{children:"布局"}),e(h.Item,{label:"固定头部",valuePropName:"checked",name:"fixedHeader",children:e(X,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(h.Item,{help:"固定菜单启用时, 头部也会同步固定",label:"固定菜单",valuePropName:"checked",name:"fixedMenu",children:e(X,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(h.Item,{valuePropName:"checked",label:"显示页脚",name:"showFootor",children:e(X,{checkedChildren:"开启",unCheckedChildren:"关闭"})})]})})},vn=t=>{const[n,r]=c.useState(!1);return u("div",{children:[e(kn,{open:n,onClose:()=>{r(!1)}}),e($,{onClick:()=>{r(!0)},title:"设置",type:"icon-setting",className:"action-icon"})]})},xn=()=>{const{fullScreen:t,setFullScreen:n,userInfo:r,setUserInfo:a,setIsLogin:l}=c.useContext(ge),{menuCollapsed:o,setMenuCollapsed:m}=c.useContext(W),{settings:{theme:i},setSetting:d}=c.useContext(J),{token:{colorBgContainer:s}}=R.useToken(),g=V(),y=()=>{O.success(t?"已退出全屏模式":"进入全屏模式"),n(!t)},f=()=>{d({followSystemTheme:!1,theme:i==="light"?"dark":"light"})},v=()=>u("div",{className:"left",children:[u("div",{className:"logo",children:[e($,{type:"icon-react",className:"logo-img"}),e("span",{className:"logo-text",children:"React Admin Template"})]}),e("div",{children:Q.createElement(o?et:tt,{onClick:()=>m(!o)})})]}),P=()=>{const T=()=>u(j,{children:[e($,{title:"搜索",type:"icon-search",className:"action-icon"}),t?e(rt,{title:"退出全屏模式",className:"action-icon",onClick:y}):e(at,{title:"进入全屏模式",className:"action-icon",onClick:y}),e("a",{target:"_blank",className:"action-icon",title:"Go to Github",href:"https://github.com/xstnet/react-admin-template",rel:"norefer noopener",children:e(ot,{})}),i==="dark"?e($,{onClick:f,title:"主题-深色模式",type:"icon-theme-dark",className:"action-icon"}):e($,{onClick:f,title:"主题-明亮模式",type:"icon-theme-light",className:"action-icon"}),e(vn,{})]}),p=[{label:e("a",{children:"个人中心"}),icon:e(lt,{}),key:"userCenter"},{label:e("a",{children:"修改资料"}),key:"update",icon:e(me,{})},{type:"divider"},{label:"退出",icon:e(it,{}),key:"logout",onClick:()=>{sn().then(()=>{A.removeToken(),l(!1),a(null),g("/login")})}}];return e("div",{className:"right",children:u(D,{size:"middle",children:[T(),e(nt,{menu:{items:p},children:u(D,{className:"pointer",children:[e("span",{children:r==null?void 0:r.nickname}),e(Ae,{src:r==null?void 0:r.avatar})]})})]})})};return e(_.Header,{className:"header",style:{background:s},children:u(j,{children:[v(),P()]})})},Cn=Q.memo(xn),Sn=()=>{const[t,n]=c.useState("pv"),r=[{tab:"访问量",key:"pv"},{tab:"IP",key:"ip"}],a=Array.from({length:7}).map((l,o)=>({name:st().subtract(o+1,"day").format("MM-DD"),pv:Se(1e3,1e4),ip:Se(100,1e3)}));return e(H,{activeTabKey:t,onTabChange:l=>n(l),tabList:r,children:e(ct,{width:"100%",height:200,children:u(dt,{data:a,children:[e(ut,{strokeDasharray:"3 3"}),e(mt,{dataKey:"name"}),e(ht,{}),e(pt,{}),e(gt,{type:"monotone",dataKey:t,stroke:"#8884d8",fill:"#8884d8"})]})})})},Ie=()=>e(j,{children:u("div",{children:[u(q,{gutter:24,children:[e(x,{span:6,children:e(H,{bordered:!1,children:e(Y,{title:"今日销售额",value:126560,precision:2,prefix:"$"})})}),e(x,{span:6,children:e(H,{bordered:!1,children:e(Y,{title:"示例指标",value:11.28,precision:2,prefix:e(oe,{}),suffix:"%"})})}),e(x,{span:6,children:e(H,{bordered:!1,children:e(Y,{title:"示例指标",value:11.28,precision:2,prefix:e(oe,{}),suffix:"%"})})}),e(x,{span:6,children:e(H,{bordered:!1,children:e(Y,{title:"示例指标",value:11.28,precision:2,valueStyle:{color:"#3f8600"},prefix:e(oe,{}),suffix:"%"})})})]}),e("br",{}),u(q,{gutter:16,children:[e(x,{span:12,children:e(Sn,{})}),e(x,{span:12,children:e(H,{children:"待定"})})]})]})}),Pe=()=>e("span",{children:"UserCenterPage"}),In=()=>e("span",{children:"UserCenterUpdatePage"});const He=c.forwardRef(({state:t},n)=>{const[r]=h.useForm(),a=c.useRef(null);return c.useImperativeHandle(n,()=>({form:r,input:a.current}),[r,a]),e("div",{children:u(h,{form:r,labelCol:{span:3},name:"userForm",initialValues:t||void 0,children:[e(h.Item,{name:"username",label:"账号",rules:[{required:!0,message:"请输入账号"}],children:e(C,{ref:a})}),e(h.Item,{name:"password",label:"密码",rules:[{required:!t,message:"请输入密码"}],children:e(C.Password,{})}),e(h.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入昵称"}],children:e(C,{})}),e(h.Item,{name:"gender",label:"性别",children:u(K.Group,{children:[e(K,{value:1,children:"男"}),e(K,{value:2,children:"女"})]})}),e(h.Item,{name:"mobile",label:"手机号",children:e(C,{})}),e(h.Item,{name:"email",label:"邮箱",children:e(C,{})})]})})}),Pn=({refreshList:t})=>{const[n,r]=c.useState(!1),{run:a,loading:l}=B(dn,{manual:!0,debounceWait:100,onSuccess:()=>{var i;r(!1),(i=o.current)==null||i.form.resetFields(),t==null||t()}}),o=c.useRef(null);return u("div",{children:[e(I,{type:"primary",icon:e(re,{}),onClick:()=>{r(!0),setTimeout(()=>{var i,d;(d=(i=o.current)==null?void 0:i.input)==null||d.focus()},100)},children:"新增用户"}),e(we,{open:n,title:"添加用户",okText:"添加",cancelText:"取消",confirmLoading:l,onCancel:()=>r(!1),onOk:()=>{var i;(i=o.current)==null||i.form.validateFields().then(d=>{a(d)}).catch(d=>console.log(d))},children:e(He,{ref:o})})]})},Tn=({search:t,form:n})=>e(h,{form:n,name:"advanced_search",style:{paddingTop:16},onFinish:a=>{console.log("Received values of form: ",a)},children:u(q,{gutter:24,children:[e(x,{span:6,children:e(h.Item,{name:"username",label:"账号",children:e(C,{placeholder:"账号"})})}),e(x,{span:6,children:e(h.Item,{name:"mobile",label:"手机号",children:e(C,{placeholder:"手机号"})})}),e(x,{span:6,children:e(h.Item,{name:"email",label:"邮箱",children:e(C,{placeholder:"邮箱"})})}),u(x,{span:6,style:{textAlign:"right"},children:[e(I,{onClick:t.reset,children:"重置"}),e(I,{style:{margin:"0 8px"},type:"primary",onClick:t.submit,children:"查询"})]})]})}),_e=(t,n)=>{const r=ft(t,n),{tableProps:a}=r,l={...a.pagination,showTotal:(i,d)=>`第${d[0]}-${d[1]} 条/共 ${i} 条`,hideOnSinglePage:!0};a.pagination=l;const o=a.onChange,m=(...i)=>{var T;let[d,s,g,y]=i,f=d,v,P;Object.keys(g).length>0&&(Array.isArray(g)?(P={},g.map(p=>{var b;P[(b=p.column)==null?void 0:b.dataIndex]=p.order})):P={[(T=g.column)==null?void 0:T.dataIndex]:g.order}),Object.keys(s).length>0&&(v=s,console.log("filterrrrrrrrrrrrr",s)),o(f,v,P)};return a.onChange=m,r.tableProps.size="small",r},Mn=({state:t,refreshList:n})=>{const[r,a]=c.useState(!1),{runAsync:l,loading:o}=B(un,{manual:!0,debounceWait:100}),m=c.useRef(null);return u(j,{children:[e(I,{icon:e(me,{}),size:"small",onClick:()=>{a(!0),setTimeout(()=>{var d,s;(s=(d=m.current)==null?void 0:d.input)==null||s.focus()},100)},children:"编辑"}),e(we,{open:r,title:"更新用户信息用户",okText:"保存",cancelText:"取消",confirmLoading:o,onCancel:()=>a(!1),onOk:()=>{var d;(d=m.current)==null||d.form.validateFields().then(s=>{l({...s,id:t.id}).then(()=>{var g;a(!1),(g=m.current)==null||g.form.resetFields(),n==null||n()}).catch(Ve)}).catch(s=>console.log(s))},children:e(He,{ref:m,state:t})})]})};const F=t=>{const{children:n,className:r="",style:a={},...l}=t,{colorBgContainer:o}=ye(),m="content-box",i={backgroundColor:o};return e("div",{className:`${m} ${r}`,style:{...i,...a},...l,children:n})},Nn=()=>{var T;console.log("render ExampleUserListPage");const[t]=h.useForm(),[n,r]=c.useState([]),a=c.useRef();c.useEffect(()=>{a.current=new Map},[]);const{runAsync:l,loading:o}=B(mn,{manual:!0,debounceWait:100}),{refresh:m,tableProps:i,search:d}=_e(cn,{form:t}),s=()=>{d.reset(),d.submit()},g=p=>{var b;typeof p=="number"&&((b=a==null?void 0:a.current)==null||b.set(p,!0)),l({id:p}).then(()=>{typeof p=="object"&&r([]),m()}).finally(()=>{var w;return typeof p=="number"&&((w=a==null?void 0:a.current)==null?void 0:w.delete(p))})},y=c.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"头像",dataIndex:"avatar",render:p=>e(Ae,{src:p})},{title:"账号",dataIndex:"username"},{title:"昵称",dataIndex:"nickname"},{title:"性别",dataIndex:"gender",render:p=>p===ze.male?e(ke,{color:"blue",children:"男"}):e(ke,{color:"error",children:"女"})},{title:"邮箱",dataIndex:"email"},{title:"手机号",dataIndex:"mobile",sorter:!0},{title:"注册时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(p,b)=>{var k;const{id:w}=b;return u(D,{children:[e(le,{title:"确认要删除这条数据吗?",onConfirm:()=>g(w),children:e(I,{loading:(k=a==null?void 0:a.current)==null?void 0:k.has(w),icon:e(Ue,{}),size:"small",danger:!0,children:"删除"})}),e(Mn,{state:b,refreshList:m})]})}}],[]),v={selectedRowKeys:n,onChange:p=>{console.log("selectedRowKeys changed: ",p),r(p)}},P=n.length>0;return u(j,{children:[u(F,{children:[e("div",{children:e(L.Title,{level:5,children:"搜索"})}),e(Tn,{search:d,form:t})]}),e("br",{}),u(F,{children:[u("div",{className:"table-header",children:[e("div",{className:"left",children:e(L.Title,{level:5,children:"用户列表"})}),e("div",{className:"right",children:u(D,{size:"middle",children:[e(le,{title:`确定要删除这${n.length}条数据吗?`,onConfirm:()=>g(n),children:e(I,{type:"primary",danger:!0,disabled:!P,loading:o&&((T=a.current)==null?void 0:T.size)===0,children:"批量删除"})}),e(Pn,{refreshList:s}),e(I,{type:"link",title:"点击刷新",onClick:m,icon:e(Fe,{})})]})})]}),e(Oe,{rowKey:"id",rowSelection:v,columns:y,...i})]})]})},Te=({title:t="空白页"})=>e(F,{style:{height:"500px"},children:e(L.Title,{level:4,children:t})}),Ln=({search:t,form:n})=>e(h,{form:n,name:"advanced_search",style:{paddingTop:16},onFinish:a=>{console.log("Received values of form: ",a)},children:u(q,{gutter:24,children:[e(x,{span:6,children:e(h.Item,{name:"title",label:"主题",children:e(C,{placeholder:"标题"})})}),e(x,{span:6,children:e(h.Item,{name:"ahthor",label:"作者",children:e(C,{placeholder:"作者"})})}),e(x,{span:6,children:e(h.Item,{name:"create_time",label:"发布时间",children:e(yt.RangePicker,{})})}),u(x,{span:6,style:{textAlign:"right"},children:[e(I,{onClick:t.reset,children:"重置"}),e(I,{style:{margin:"0 8px"},type:"primary",onClick:t.submit,children:"查询"})]})]})});const Me=()=>{console.log("render ArticleIndexPage");const[t]=h.useForm(),n=c.useRef();V(),c.useEffect(()=>{n.current=new Map},[]);const{runAsync:r}=B(yn,{manual:!0,debounceWait:100}),{refresh:a,tableProps:l,search:o}=_e(hn,{form:t}),m=d=>{var s;(s=n==null?void 0:n.current)==null||s.set(d,!0),r({id:d}).then(a).finally(()=>{var g;return(g=n==null?void 0:n.current)==null?void 0:g.delete(d)})},i=c.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"封面",dataIndex:"cover",render:d=>e(bt,{width:80,height:45,style:{borderRadius:4},src:d})},{title:"标题",dataIndex:"title"},{title:"简介",dataIndex:"description"},{title:"作者",dataIndex:"author"},{title:"发布时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(d,s)=>{var y;const{id:g}=s;return u(D,{children:[e(le,{title:"确认要删除这条数据吗?",onConfirm:()=>m(g),children:e(I,{loading:(y=n==null?void 0:n.current)==null?void 0:y.has(g),icon:e(Ue,{}),size:"small",danger:!0,children:"删除"})}),e(G,{to:`/article/update/${g}`,children:e(I,{icon:e(me,{}),size:"small",children:"编辑"})})]})}}],[]);return u(j,{children:[u(F,{children:[e("div",{children:e(L.Title,{level:5,children:"搜索"})}),e(Ln,{search:o,form:t})]}),e("br",{}),u(F,{children:[u("div",{className:"table-header",children:[e("div",{className:"left",children:e(L.Title,{level:5,children:"文章列表"})}),e("div",{className:"right",children:u(D,{size:"middle",children:[e(G,{to:"/article/create",children:e(I,{type:"primary",icon:e(re,{}),children:"发布文章"})}),e(I,{type:"link",title:"点击刷新",onClick:a,icon:e(Fe,{})})]})})]}),e(Oe,{rowKey:"id",columns:i,...l})]})]})},An=()=>{const[t]=h.useForm(),n=V(),r="articleDraft",{loading:a,run:l}=B(gn,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{A.remove(r),n("/article/list")},200)}),o=A.getObject(r)||{},m=async()=>{const s=await t.validateFields();l(s)},i=()=>{const{cover:s,...g}=t.getFieldsValue();A.set(r,g),O.success("已保存到草稿箱")},d=s=>(console.log("Upload event:",s),Array.isArray(s)?s:s&&s.fileList);return u(F,{children:[e(L.Title,{level:3,children:"发布文章"}),e(ue,{}),e(h,{form:t,name:"createForm",labelCol:{span:3},initialValues:o,children:u(q,{gutter:36,children:[u(x,{span:16,children:[e(h.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(C,{})}),e(h.Item,{label:"简介",name:"description",children:e(C,{})}),e(h.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:e(C.TextArea,{rows:20})}),e(h.Item,{wrapperCol:{offset:3},children:u(D,{children:[e(I,{icon:e($e,{}),onClick:m,loading:a,type:"primary",children:"发布文章"}),e(I,{icon:e(kt,{}),onClick:i,children:"保存为草稿"})]})})]}),u(x,{span:8,children:[e(h.Item,{label:"封面",name:"cover",getValueFromEvent:d,valuePropName:"fileList",children:e(Re,{maxCount:1,listType:"picture-card",children:u("div",{children:[e(re,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(h.Item,{label:"标签",name:"tags",children:e(De,{mode:"tags",placeholder:"文章标签"})}),e(h.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(C,{})})]})]})})]})},wn=()=>{const[t]=h.useForm(),n=V(),r=vt(),{loading:a,run:l}=B(pn,{manual:!0,debounceWait:10,onSuccess:s=>t.setFieldsValue(s)});c.useEffect(()=>{l({id:r.id})},[r.id]);const{loading:o,run:m}=B(fn,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{n("/article/list")},200)}),i=async()=>{const s=await t.validateFields();m(s)},d=s=>(console.log("Upload event:",s),Array.isArray(s)?s:s&&s.fileList);return u(F,{children:[e(L.Title,{level:3,children:"更新文章"}),e(ue,{}),e(he,{spinning:a,children:e(h,{form:t,name:"createForm",labelCol:{span:3},children:u(q,{gutter:36,children:[u(x,{span:16,children:[e(h.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(C,{})}),e(h.Item,{label:"简介",name:"description",children:e(C,{})}),e(h.Item,{label:"内容",name:"content",rules:[{required:!0,message:"请输入内容"}],children:e(C.TextArea,{rows:20})}),e(h.Item,{wrapperCol:{offset:3},children:e(D,{children:e(I,{icon:e($e,{}),onClick:i,loading:o,type:"primary",children:"保存"})})})]}),u(x,{span:8,children:[e(h.Item,{label:"封面",name:"cover",getValueFromEvent:d,valuePropName:"fileList",children:e(Re,{maxCount:1,listType:"picture-card",children:u("div",{children:[e(re,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(h.Item,{label:"标签",name:"tags",children:e(De,{mode:"tags",placeholder:"文章标签"})}),e(h.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(C,{})})]})]})})})]})},Un=()=>{const t=Be();return u(F,{style:{},children:[e(L.Title,{children:"404"}),e(L.Paragraph,{children:"页面不存在"}),u(L.Paragraph,{children:["路由: ",t.pathname]}),e(G,{to:"/",children:"回到首页"})]})};const Fn=t=>{const{title:n="Iframe Page",name:r="internal-iframe"}=t,a=c.useRef(null),[l,o]=c.useState(!0),[m]=ne();c.useEffect(()=>{o(!0)},[m]);const i=m.get("url"),d=()=>{o(!1)};return i?e(j,{children:e(F,{style:{height:"100%",padding:0},children:e(he,{wrapperClassName:"iframeSpin",spinning:l,tip:"正在加载第三方页面, 请稍后...",children:e("iframe",{ref:a,width:"100%",height:"100%",onLoad:d,title:n,name:r,src:i})})})}):e(F,{children:e(xt,{message:"无效的url地址",type:"error"})})};function On(){return Ct([{path:"/",element:e(Ie,{})},{path:"/dashboard",element:e(Ie,{})},{path:"/user",children:[{index:!0,element:e(Pe,{})},{path:"/user/center/index",element:e(Pe,{})},{path:"/user/center/update",element:e(In,{})}]},{path:"/example/userList",element:e(Nn,{})},{path:"/article",children:[{index:!0,element:e(Me,{})},{path:"/article/list",element:e(Me,{})},{path:"/article/create",element:e(An,{})},{path:"/article/update/:id",element:e(wn,{})}]},{path:"/blank",element:e(Te,{})},{path:fe,element:e(Fn,{})},{path:"/multilevel/menu/2/3",element:e(Te,{title:"三级菜单"})},{path:"*",element:e(Un,{})}])}const $n=()=>e(_.Content,{className:"content",children:e(On,{})}),Rn=Q.memo($n);const ee=new Map,se=t=>{t.map(n=>{pe(n)&&(n==null?void 0:n.type)==="url"||(ae(n)&&se(n.children||[]),(te(n)||je(n))&&(n.path&&ee.set(n.path,n.label),n.children&&se(n.children||[])))})},Dn=()=>{const{menuList:t}=c.useContext(W),n=c.useMemo(()=>(ee.clear(),se(t),ee),[t]),r=Be(),[a]=ne(),l=()=>{if(r.pathname===fe){const i=a.get("url");if(i&&ee.has(i))return[e(Z.Item,{children:e(G,{style:{color:"inherit"},to:qe(i),children:n.get(i)})},i)]}return[]},o=c.useMemo(()=>{const i=r.pathname.split("/").filter(d=>d);return i.map((d,s)=>{const g=`/${i.slice(0,s+1).join("/")}`;return n.has(g)?e(Z.Item,{children:s===i.length-1?e(G,{style:{color:"inherit"},to:g,children:n.get(g)}):n.get(g)},g):null})},[r]),m=[e(Z.Item,{children:e(St,{})},"home"),...o,...l()];return e(Z,{className:"breadcrumb",children:m})},Bn=Q.memo(Dn);function jn(t){const n=t.split(".")[1];if(n)try{return JSON.parse(It(n))}catch(r){console.warn("Parse Token Error: ",r);return}}function ce(){var r;const t=A.getString(U.tokenKey);if(!t)return!1;const n=jn(t);return n!==void 0&&((r=n==null?void 0:n.data)==null?void 0:r.uid)>0&&n.exp>new Date().getTime()/1e3}const En=({loading:t,title:n})=>{const{settings:{theme:r}}=c.useContext(J);return e(he,{size:"large",spinning:t,tip:n,wrapperClassName:`page-loading-spin-${r}`,children:e("div",{style:{height:"100vh",width:"100vw"}})})};const Kn=()=>{const[t,n]=c.useState(!0),{setIsLogin:r,setUserInfo:a}=c.useContext(ge),{menuCollapsed:l}=c.useContext(W),{colorBgContainer:o}=ye(),{settings:{fixedMenu:m,fixedHeader:i}}=c.useContext(J),d=V(),[s]=ne();return console.log("default layout render..."),c.useEffect(()=>{if(!ce()){d("/login");return}ln().then(g=>{if(n(!1),r(!0),a(g),s.has("ghpage")){const y=decodeURIComponent(s.get("ghpage"));d(y);return}}).catch(g=>{g instanceof Pt&&Tt.error({message:"网络错误",description:"获取用户信息失败, 无法打开页面",duration:null,closeIcon:null})})},[]),ce()?t?e(En,{title:"页面加载中",loading:t}):u(_,{"data-fixed-menu":m?1:0,"data-menu-collapsed":l?1:0,"data-fixed-header":i?1:0,style:{background:o},className:"default-layout",children:[e(Cn,{}),u(_,{children:[e(en,{}),u(_,{className:"content-layout",children:[e(Bn,{}),e(Rn,{})]})]})]}):(d("/login"),null)};const qn=()=>{const t=V(),{loading:n,run:r}=B(on,{manual:!0,debounceWait:300,onSuccess:o=>{A.setToken(o.token),t("/dashboard")}});document.title=U.pageTitle;const a=o=>{r(o)};c.useEffect(()=>{ce()&&t("/dashboard")},[]);const l={remember:!0,username:"admin",password:"123456"};return e(j,{children:u(Le,{theme:{algorithm:[R.defaultAlgorithm]},children:[e("div",{className:"bg-wrap"}),u(q,{className:"login-wrap",children:[e(x,{span:15,className:"login-banner"}),u(x,{span:9,className:"login-form-wrap",children:[e(L.Title,{style:{textAlign:"center"},children:"后台管理系统"}),e("br",{}),u(h,{name:"loginForm",labelCol:{span:5},wrapperCol:{span:19},style:{maxWidth:600},initialValues:l,onFinish:a,autoComplete:"off",children:[e(h.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名!"}],children:e(C,{placeholder:"admin"})}),e(h.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码!"}],children:e(C.Password,{placeholder:"123456"})}),e(h.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:5},children:e(Mt,{children:"记住我"})}),e(h.Item,{wrapperCol:{offset:5,span:16},children:e(I,{loading:n,type:"primary",htmlType:"submit",children:"登录"})})]})]})]})]})})};function Vn(){return c.useEffect(()=>{},[]),e(Gt,{children:e("div",{className:"App",children:u(Nt,{children:[e(ve,{element:e(qn,{}),path:"/login"}),e(ve,{path:"*",element:e(Kn,{})})]})})})}function Ne(t){const n=JSON.stringify({type:"JWT",alg:"HS256"}),r=Number((new Date().getTime()/1e3).toFixed(0)),a=JSON.stringify({iss:"github.com/xstnet",sub:"react-admin",iat:r,exp:r+86400*14,data:t}),l="H_97UyQUOmURnZdDwI0khuAt4Cmg";return`${xe(n)}.${xe(a)}.${l}`}S.mock(/api\/login/,"post",({body:t})=>{const{username:n,password:r}=JSON.parse(t);return n==="admin"?r!=="123456"?{code:-1,message:"密码错误"}:{code:0,message:"登录成功",data:{token:Ne({uid:1})}}:{code:0,message:"登录成功",data:{token:Ne({uid:z.Random.natural(2,1e4)})}}});S.setup({timeout:100});S.mock(/api\/user\/info/,"get",t=>({code:0,message:"ok",data:{id:1,username:"admin",nickname:"醉丶春风",avatar:"https://www.xstnet.com/static/images/head.gif",password:"",gender:z.Random.natural(1,2),email:"shantongxu@qq.com",mobile:"133xxxx3333"}}));S.mock(/api\/user\/logout/,"post",t=>({code:0,message:"退出成功"}));S.mock(/api\/user\/list/,"get",t=>{const n=new URLSearchParams(t.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,username:"@first@last",nickname:"@cname",avatar:()=>z.Random.dataImage("200x200"),email:"@email",mobile:()=>S.mock(/^1[3456789]\d{9}$/).replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"),"gender|1-2":0,create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return S.mock(a)});S.mock(/api\/user\/create/,"post",t=>({code:0,message:"创建成功",data:{id:z.Random.natural(100,9999)}}));S.mock(/api\/user\/update/,"post",t=>({code:0,message:"更新成功"}));S.mock(/api\/user\/delete/,"post",t=>({code:0,message:"删除成功"}));S.setup({timeout:100});S.mock(/api\/article\/detail/,"get",t=>(console.log("🚀 ~ file: article.ts:7 ~ Mock.mock ~ options:",t),{code:0,message:"ok",data:{id:1,title:"主题",description:"醉丶春风",author:"醉丶春风",tags:[1,2],content:"content",create_time:z.Random.datetime()}}));S.mock(/api\/article\/list/,"get",t=>{const n=new URLSearchParams(t.url);let r=Number(n.has("pageSize")?n.get("pageSize"):10);const a={code:0,message:"ok",data:{total:100,[`list|${r}`]:[{"id|+1":r,author:"@first@last",title:()=>S.Random.ctitle(5,20),description:"@cname",cover:()=>z.Random.dataImage("480x270","封面"),content:"@email",create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return S.mock(a)});S.mock(/api\/article\/create/,"post",t=>({code:0,message:"创建成功",data:{id:z.Random.natural(100,9999)}}));S.mock(/api\/article\/update/,"post",t=>({code:0,message:"更新成功"}));S.mock(/api\/article\/delete/,"post",t=>({code:0,message:"删除成功"}));Lt.createRoot(document.getElementById("root")).render(e(At,{basename:"/react-admin-template/",children:e(Vn,{})}));
