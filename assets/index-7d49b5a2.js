import{j as Te,r as s,C as pt,z as gt,t as Q,u as ze,a as Z,b as Y,m as H,d as ft,S as je,n as qe,c as $,B as S,e as Ke,R as B,f as ae,g as le,h as ce,L as ke,H as yt,i as bt,k as vt,T as Ge,l as ue,o as kt,F as Ye,p as We,q as Ct,s as A,G as xt,v as L,w as St,x as Tt,y as ee,A as Ie,U as Je,D as z,E as Ce,P as It,I as Mt,J as k,K as te,M as wt,N as _,O as oe,Q as _t,V as Pt,W as Lt,X as Qe,Y as Nt,Z as At,_ as Rt,$ as Ft,a0 as w,a1 as R,a2 as fe,a3 as Ze,a4 as Et,a5 as ye,a6 as $t,a7 as Me,a8 as Ne,a9 as we,aa as Ut,ab as Xe,ac as he,ad as Ot,ae as Dt,af as Ae,ag as Re,ah as Bt,ai as Ht,aj as Vt,ak as zt,al as jt,am as qt,an as et,ao as tt,ap as _e,aq as Kt,ar as Gt,as as Yt,at as Wt,au as I,av as F,aw as Fe,ax as Jt}from"./vendor-f85b10b9.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=a(o);fetch(o.href,l)}})();const O=Te.Fragment,e=Te.jsx,y=Te.jsxs,j={pageTitle:"后台管理系统模板",pageTitlePrefix:"后台管理",tokenKey:"Authorization",apiBaseUrl:"https://xstnet.github.io/react-admin-template/api",iconFontUrl:"//at.alicdn.com/t/c/font_3917407_68ll5mr3jkf.js"};function Qt(t,n){localStorage.setItem(t,typeof n=="object"?JSON.stringify(n):n)}function Zt(t){localStorage.setItem(j.tokenKey,typeof t=="object"?JSON.stringify(t):t)}function nt(t){return localStorage.getItem(t)}function Xt(t){const n=localStorage.getItem(t);if(n!==null)return Number(n)}function en(t){const n=localStorage.getItem(t);if(n!==null)return n==="true"}function tn(t){const n=localStorage.getItem(t);if(n!==null)return JSON.parse(n)}function nn(t){return nt(t)!==null}function an(t){localStorage.removeItem(t)}function rn(){localStorage.removeItem(j.tokenKey)}function on(){localStorage.clear()}const D={set:Qt,setToken:Zt,has:nn,getString:nt,getObject:tn,getBoolean:en,getNumber:Xt,remove:an,removeToken:rn,clear:on},at=()=>{const[t,n]=s.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);return s.useEffect(()=>{const r=o=>{console.log("chage",o.matches),o.matches?n(!0):n(!1)};return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",r),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",r)}},[]),[t?"dark":"light"]},sn=void 0,ln=s.createContext(sn),cn=({children:t})=>{const{settings:{primaryColor:n,theme:a,compactMode:r,followSystemTheme:o}}=s.useContext(K),[l]=at(),c={},d=()=>{const m=[];return o?m.push(l==="light"?Q.defaultAlgorithm:Q.darkAlgorithm):m.push(a==="light"?Q.defaultAlgorithm:Q.darkAlgorithm),r&&m.push(Q.compactAlgorithm),m};return e(ln.Provider,{value:c,children:e(pt,{locale:gt,theme:{algorithm:d(),token:{colorPrimary:n},components:{Button:{borderRadius:4,borderRadiusSM:2},Modal:{borderRadius:4,borderRadiusOuter:2}}},children:t})})},dn=void 0,K=s.createContext(dn),un=({children:t})=>{const n=s.useMemo(()=>({theme:"light",compactMode:!1,followSystemTheme:!0,fixedHeader:!0,fixedMenu:!0,showFooter:!0,multitabMode:!1,primaryColor:"#00b96b",...D.getObject("settings")||{}}),[]),[a,r]=s.useState(n),o=s.useCallback(c=>{const d={...a,...c};r(d),D.set("settings",d)},[a]),l={settings:a,setSetting:o};return e(K.Provider,{value:l,children:e(cn,{children:t})})},mn=void 0,W=s.createContext(mn),hn=({children:t})=>{const[n,a]=s.useState(!1),[r,{toggleFullscreen:o}]=ze(document.body),[l,c]=s.useState(null),d=s.useMemo(()=>({isLogin:n,setIsLogin:a,userInfo:l,setUserInfo:c,fullScreen:r,setFullScreen:o}),[n,l,r]);return e(W.Provider,{value:d,children:e(un,{children:t})})},pn="modulepreload",gn=function(t){return"/react-admin-template/"+t},Ee={},ie=function(n,a,r){if(!a||a.length===0)return n();const o=document.getElementsByTagName("link");return Promise.all(a.map(l=>{if(l=gn(l),l in Ee)return;Ee[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(!!r)for(let i=o.length-1;i>=0;i--){const v=o[i];if(v.href===l&&(!c||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":pn,c||(h.as="script",h.crossOrigin=""),h.href=l,document.head.appendChild(h),c)return new Promise((i,v)=>{h.addEventListener("load",i),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>n())},fn=({to:t})=>{const n=Z();return s.useEffect(()=>{n(t)},[]),null};var xe=(t=>(t[t.success=0]="success",t[t.noLogin=-10001]="noLogin",t[t.loginExpired=-10002]="loginExpired",t))(xe||{}),rt=(t=>(t[t.male=1]="male",t[t.female=2]="female",t))(rt||{}),se=(t=>(t[t.incomplete=1]="incomplete",t[t.completed=2]="completed",t[t.deleted=10]="deleted",t))(se||{}),yn=(t=>(t.day="YYYY-MM-DD",t.second="YYYY-MM-DD HH:mm:ss",t.minute="YYYY-MM-DD HH:mm",t.hour="YYYY-MM-DD HH",t))(yn||{});function G(){}function $e(t,n){return Math.floor(Math.random()*(n-t+1))+t}function ot(t,n){const{roles:a=[]}=n||{};return t?typeof t=="string"||typeof t=="number"?a.includes(t):Array.isArray(t)?t.some(r=>a.includes(r)):typeof t=="function"?t(n):!1:!0}function bn(t,n){let a;return function(...r){clearTimeout(a),a=setTimeout(()=>{t(...r)},n)}}function vn(t){var a;const{config:n}=t;console.group(`${(a=n.method)==null?void 0:a.toLocaleUpperCase()} ${n.url}`),console.log("Path:",n.url),console.log("Method:",n.method),console.log("Params:",n.params),console.log("Body:",n.data),console.log("StatusCode:",t.status),console.log("Response:",typeof t.data=="object"?Object.assign(Object.create(null),t.data):t.data),console.groupEnd()}const kn=10*1e3;Y.defaults.baseURL=j.apiBaseUrl;Y.defaults.headers.post["Content-Type"]="application/json; charset=utf-8";Y.defaults.timeout=kn;Y.interceptors.request.use(t=>(t.headers.Authorization=`Bearer ${D.getString(j.tokenKey)}`,t),t=>Promise.reject(t));Y.interceptors.response.use(t=>{vn(t);const n=t.data;return typeof n.code!="number"?(H.error("系统错误",2),console.warn("api调用失败, 未正常返回数据, url:",t.config.url,"data:",n,"response:",t),Promise.reject(t)):n.code===0?(t.config.method==="post"&&typeof t.data.message=="string"&&t.data.message.length>0&&H.success(t.data.message),t):n.code===xe.noLogin?(H.error("您还没有登录, 即将跳转到登录页面, 请稍后..."),D.remove(j.tokenKey),location.reload(),Promise.reject(n)):n.code===xe.loginExpired?(H.error("登录已失效, 即将跳转到登录页面..."),D.remove(j.tokenKey),location.reload(),Promise.reject(n)):(H.error(n.message),Promise.reject(t))},t=>(typeof t.message=="string"&&t.message==="Network Error"?H.error("网络错误, 请稍后再试!"):H.error("请求失败, 请稍后再试"),console.log("Request error",t),Promise.reject(t)));const Cn=(t,n,a)=>{const r=a||{};return r.params=n,Y.get(t,r).then(o=>o.data.data).catch(o=>Promise.reject(o))},xn=(t,n,a)=>Y.post(t,n,a).then(r=>r.data.data).catch(r=>Promise.reject(r)),Sn=t=>Y.request(t),M={get:Cn,post:xn,request:Sn},za=t=>M.post("/login",t),Tn=t=>M.get("/user/info",t),In=()=>M.post("/user/logout"),Mn=(t,n)=>M.get("/user/list",{...t,...n}),wn=t=>M.post("/user/create",t),_n=t=>M.post("/user/update",t),Pn=t=>M.post("/user/delete",t),ja=(t,n)=>M.get("/article/list",{...t,...n}),Ln=t=>M.get("/article/detail",t),Nn=t=>M.post("/article/create",t),An=t=>M.post("/article/update",t),qa=t=>M.post("/article/delete",t),Ka=t=>M.get("/todo/list",t),Ga=t=>M.post("/todo/changeStatus",t),Ya=t=>M.post("/todo/delete",t),Wa=t=>M.post("/todo/update",t),Ja=t=>M.post("/todo/create",t),Pe=()=>M.get("/category/treeList"),Rn=t=>M.post("/category/create",t),Fn=t=>M.post("/category/update",t);function En(t){const n=t.split(".")[1];if(n)try{return JSON.parse(ft(n))}catch(a){console.warn("Parse Token Error: ",a);return}}function Ue(){var a;const t=D.getString(j.tokenKey);if(!t)return!1;const n=En(t);return n!==void 0&&((a=n==null?void 0:n.data)==null?void 0:a.uid)>0&&n.exp>new Date().getTime()/1e3}const Le=({loading:t=!0,title:n="页面加载中",delay:a=50})=>{const{settings:{theme:r}}=s.useContext(K);return e(je,{size:"large",spinning:t,tip:n,delay:a,wrapperClassName:`page-loading-spin-${r}`,children:e("div",{style:{height:"100%",width:"100%"}})})},$n=()=>{const[t,n]=qe.useNotification(),a=D.getBoolean("dontShowCompactModeNotify"),{setSetting:r,settings:{compactMode:o}}=s.useContext(K),l=()=>{const c=`open${Date.now()}`,d=y($,{children:[e(S,{type:"link",size:"small",onClick:()=>t.destroy(),children:"不再提示"}),e(S,{type:"primary",size:"small",onClick:()=>{r({compactMode:!0}),t.destroy(c)},children:"开启"})]});t.info({message:"开启紧凑布局模式",description:"检测到您的屏幕尺寸过小, 是否开启紧凑布局模式? 或者您也可以选择在设置中手动开启",btn:d,key:c,onClose:()=>D.set("dontShowCompactModeNotify",!0)})};return s.useEffect(()=>{!a&&!o&&window.innerWidth<=1440&&l()},[]),n},Un=[{label:"控制台",icon:"icon-dashboard",path:"/dashboard",permission:"admin"},{label:"示例页面",path:"/example",icon:"icon-example",children:[{label:"列表页",icon:"icon-list",path:"/example/userList",permission:["admin","guest"]},{label:"权限测试页",icon:"icon-list",path:"/example/permission",children:[{label:"菜单权限",icon:"icon-list",path:"/example/permission/menu"},{label:"按钮权限",icon:"icon-list",path:"/example/permission/button"}]},{label:"多级菜单",icon:"icon-list",path:"/multilevel/menu",children:[{label:"二级菜单",icon:"icon-list",path:"/multilevel/menu/2",children:[{label:"三级菜单",icon:"icon-list",path:"/multilevel/menu/2/3"}]}]},{label:"Tabs标签页",icon:"icon-list",path:"/example/tabs",children:[{label:"标签管理",icon:"icon-list",path:"/example/tabs/manage"}]},{label:"空白页",icon:"icon-example",path:"/blank"},{label:"404",icon:"icon-example",path:"/404"}]},{label:"徽标示例",path:"/badge",icon:"icon-example",children:[{label:"红点徽标",icon:"icon-list",badge:"dot",path:"/badge/dot"},{label:"数字徽标",icon:"icon-example",badge:98,path:"/badge/count"}]},{path:"/article",label:"文章管理",icon:"icon-article",permission:"admin",children:[{path:"/article/list",label:"文章列表",icon:"icon-article"},{path:"/article/create",label:"发布文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/update",label:"更新文章",hideInMenu:!0,parent:"/article/list"},{path:"/article/category",label:"分类管理",icon:"icon-list"}]},{path:"/iframe",label:"外部页面",icon:"icon-href",permission:"admin",children:[{path:"https://ant-design.antgroup.com/components/overview-cn",label:"antd文档(外链)",icon:"icon-document",type:"url"},{path:"https://ant-design.antgroup.com/components/overview-cn/",label:"antd文档(内嵌)",icon:"icon-document",type:"iframe"},{path:"https://www.xstnet.com",label:"博客主页(内嵌)",icon:"icon-document",type:"iframe"},{path:"https://baidu.com",label:"百度",icon:"icon-document",type:"iframe"}]},{path:"/document",label:"文档",hideInMenu:!0,icon:"icon-document",children:[{path:"/document/start",label:"开始使用",icon:"icon-document"},{path:"/document/package.json",label:"Package文件说明",icon:"icon-document"}]},{path:"/user/center",label:"个人中心",icon:"icon-user-permissions",permission:t=>t.roles.includes("admin"),children:[{path:"/user/center/index",label:"个人中心",icon:"icon-example"},{path:"/user/center/update",label:"修改信息",icon:"icon-document"}]}],On=async t=>Un;function st(t){return!!(typeof t.children>"u"||Array.isArray(t.children)&&t.children.length===0)}function pe(t){return be(t)?!1:!!(typeof t.children<"u"&&Array.isArray(t.children)&&t.children.length>0)}function ge(t){return typeof t.path=="string"&&typeof t.label=="string"}function be(t){return typeof t.type<"u"&&t.type==="group"}function Dn(t){return typeof t.type<"u"&&t.type==="divider"}const Bn=void 0,q=s.createContext(Bn),Hn=({children:t})=>{const{userInfo:n}=s.useContext(W),[a,r]=s.useState([]),[o,l]=s.useState(!1);s.useEffect(()=>{async function h(){try{const i=await On(n);r([...i])}catch(i){console.warn("获取菜单数据失败",i)}}h()},[n]);const{mapPathToMenu:c,processedMenuList:d}=s.useMemo(()=>(()=>{const i=new Map,v=b=>{ge(b)&&(b.key=(b==null?void 0:b.key)||b.path);const{permission:T,...p}=b;return p},u=b=>b.map(p=>{var x;const{permission:g=void 0}=p;if(!ot(g,n))return null;const C=v(p);return(pe(C)||be(C))&&(C.children=u(C.children||[]),!C.children||!((x=C.children)!=null&&x.length))?null:(ge(C)&&i.set(C.path,C),C)}).filter(p=>p);return{processedMenuList:u(a),mapPathToMenu:i}})(),[a]),m=s.useMemo(()=>({menuList:d,setMenuList:r,menuCollapsed:o,setMenuCollapsed:l,mapPathToMenu:c}),[a,o]);return a.length===0?e(q.Provider,{value:m,children:e(Le,{})}):e(q.Provider,{value:m,children:t})},Vn={addTab:G,removeTab:G,tabs:[],openTab:G,hasTab:()=>!1,setTabs:G,activeTab:"",whiteList:[],tabEvent:Ke(),addTabWithNavigate:G},ve=s.createContext(Vn),zn=({children:t})=>{const[n,a]=s.useState([]),[r,o]=s.useState(""),l=s.useMemo(()=>Ke(),[]),c=Z(),d=s.useCallback(()=>{const v=p=>{p&&p!==r&&o(p)},u=p=>n.findIndex(g=>g.key===p)>-1,f=(p,g=!0)=>{u(p.key)||a(C=>[...C,{...p}]),g&&r!==p.key&&v(p.key)};return{openTab:v,addTab:f,removeTab:p=>{const g=n.findIndex(x=>x.key===p);if(g===-1)return;const C=n[g===0?1:g-1];a(x=>x.filter(P=>P.key!==p)),r===p&&C&&c(C.key),console.log("tabs",n)},hasTab:u,addTabWithNavigate:p=>{f(p,!0);const g=n.find(x=>x.key===p.key)||p;if(!g){console.log("标签页不存在");return}const C=g.key+(g.queryString||"");c(C)}}},[n,r]),m=s.useMemo(()=>d(),[d]),h=["/"],i=s.useMemo(()=>({tabs:n,setTabs:a,activeTab:r,tabEvent:l,whiteList:h,...m}),[n,r]);return e(ve.Provider,{value:i,children:t})},ne=()=>{const{token:t}=Q.useToken();return t},V="/iframe",lt=t=>`${V}?url=${t}`;const me=new Map,Se=t=>{t.map(n=>{ge(n)&&(n==null?void 0:n.type)==="url"||(be(n)&&Se(n.children||[]),(pe(n)||st(n))&&(n.path&&me.set(n.path,n.label),n.children&&Se(n.children||[])))})},jn=()=>{const{menuList:t}=s.useContext(q),n=s.useMemo(()=>(me.clear(),Se(t),me),[t]),a=ae(),[r]=le(),o=()=>{if(a.pathname===V){const d=r.get("url");if(d&&me.has(d))return[e(ce.Item,{children:e(ke,{style:{color:"inherit"},to:lt(d),children:n.get(d)})},d)]}return[]},l=s.useMemo(()=>{const d=a.pathname.split("/").filter(m=>m);return d.map((m,h)=>{const i=`/${d.slice(0,h+1).join("/")}`;return n.has(i)?e(ce.Item,{children:h===d.length-1?e(ke,{style:{color:"inherit"},to:i,children:n.get(i)}):n.get(i)},i):null})},[a]),c=[e(ce.Item,{children:e(yt,{})},"home"),...l,...o()];return e(ce,{className:"breadcrumb",children:c})},it=B.memo(jn);function qn({freeze:t,children:n}){const a=s.useRef({}).current;if(t&&!a.promise)throw a.promise=new Promise(r=>{a.resolve=r}),a.promise;if(t)throw a.promise;return a.promise&&(a.resolve(),a.promise=void 0),e(s.Fragment,{children:n})}function Kn({freeze:t,children:n,placeholder:a=null}){return e(s.Suspense,{fallback:a,children:e(qn,{freeze:t,children:n})})}const Gn=({active:t,children:n,id:a,parentRef:r})=>{const[o]=s.useState(()=>document.createElement("div")),l=s.useRef(!0),c=a.indexOf(V)===0,d=s.useMemo(()=>bt.createPortal(n,o),[]);return s.useEffect(()=>{const m=()=>{var i,v;if(t&&o.setAttribute("id",a),c)return h();if(t)(i=r.current)==null||i.appendChild(o);else try{(v=r.current)==null||v.removeChild(o)}catch{}},h=()=>{var i;l.current&&((i=r.current)==null||i.appendChild(o)),o.style.display=t?"block":"none",l.current=!1};m()},[t,o,l.current]),s.useEffect(()=>()=>{var m;try{(m=r.current)==null||m.removeChild(o)}catch{}},[]),c?e(Kn,{freeze:!t,children:d}):d};let Oe=1;const Yn=()=>{const t=vt(),{pathname:n,search:a}=ae(),r=n===V?n+a:n,{tabs:o,tabEvent:l,whiteList:c}=s.useContext(ve),d=s.useRef(null),[m,h]=s.useState([]);return s.useEffect(()=>{const i=l.on("reload",v=>{console.log("刷新页面:",v),h(m.map(u=>u.id!==v?u:{...u,key:++Oe}))});return()=>{i()}},[m]),s.useEffect(()=>{if(!r||c.includes(r))return;const i=o.map(v=>v.key);h(v=>(v.find(f=>f.id===r)||v.push({id:r,element:t,key:++Oe}),v.filter(f=>i.includes(f.id))))},[o]),c.includes(r)?t:y(O,{children:[e("div",{ref:d,className:"keep-alive"}),m.map(({id:i,element:v,key:u})=>e(Gn,{active:i===r,parentRef:d,id:i,children:v},u))]})};const Wn=()=>{const{pathname:t}=ae(),{tabs:n,activeTab:a,removeTab:r,tabEvent:o,addTabWithNavigate:l}=s.useContext(ve),{colorPrimary:c}=ne(),[d,m]=s.useState(!1),{colorBgLayout:h}=ne(),i=p=>{p&&p!==t&&l({key:p,label:""})},v=(p,g)=>{g==="remove"&&r(p)},u=()=>{o.emit("reload",t)},f=p=>{const g=p;m(g),o.emit("fullScreen",g)},b=()=>y($,{size:0,children:[e(ue,{title:"刷新当前页面",children:e(S,{onClick:u,type:"link",style:{color:c},icon:e(kt,{})})}),(()=>d?e(ue,{title:"退出全屏",children:e(S,{onClick:()=>f(!1),type:"link",style:{color:c},icon:e(Ye,{})})}):e(ue,{title:"全屏",children:e(S,{onClick:()=>f(!0),type:"link",style:{color:c},icon:e(We,{})})}))()]}),T={backgroundColor:h,left:d?0:void 0};return e(Ge,{className:"tabs-wrapper",type:"editable-card",hideAdd:!0,activeKey:a,items:[...n],onChange:i,onEdit:v,tabBarExtraContent:e(b,{}),style:T})};const Jn=({children:t})=>{const{pathname:n,search:a}=ae(),{addTab:r,hasTab:o,openTab:l,tabs:c,tabEvent:d,whiteList:m}=s.useContext(ve),{mapPathToMenu:h}=s.useContext(q),i=s.useRef(null),[v,{toggleFullscreen:u}]=ze(i),{colorBgLayout:f}=ne(),[b]=le(),T=Ct(),p=C=>{var U;let x="";const P=C.split("/").filter(N=>N);for(let N=0;N<P.length;N++){const re=`/${P.slice(0,N+1).join("/")}`;h.has(re)&&(x=((U=h.get(re))==null?void 0:U.label)||x)}return x},g=()=>{if(m.includes(n))return;let C=n;n===V&&(C=b.get("url")||"");const x=h.get(C),P=x?n===V?n+a:x.key:n;if(o(P)){l(P);return}if(!x||!x.path){let U=p(C);if(!U)U="404",n===V&&(U="Iframe 页面");else{const{params:{id:N=void 0}}=T.pop()||{params:{id:void 0}};N&&(U+=": "+N)}r({label:U,key:P,queryString:a,children:null});return}r({label:x.label,key:P,queryString:n===V?"":a,children:null})};return s.useEffect(()=>{g()},[n,a]),s.useEffect(()=>{},[a]),s.useEffect(()=>{const C=d.on("fullScreen",x=>{u()});return()=>{C()}},[]),y(A.Content,{className:"content",ref:i,style:{backgroundColor:f},children:[c.length?e(Wn,{}):null,c.length?e(it,{}):null,e(Yn,{})]})},Qn=B.memo(Jn),ct=()=>{const{settings:{showFooter:t}}=s.useContext(K),{Text:n,Link:a}=L;return t?y(A.Footer,{style:{textAlign:"center",paddingBottom:4},children:[y(n,{type:"secondary",children:["React Admin Template",e(a,{href:"https://github.com/xstnet/react-admin-template",target:"_blank",style:{color:"inherit",marginLeft:5},children:e(xt,{})})]}),e("br",{}),e(a,{href:"https://github.com/xstnet",target:"_blank",children:e(n,{type:"secondary",children:"醉丶春风"})}),y(n,{type:"secondary",children:["©2023 Created by",e(a,{target:"_blank",href:"https://ant-design.antgroup.com/index-cn",style:{margin:"0 6px",color:"inherit"},children:"Ant Design"}),"V5"]})]}):null};const E=St({scriptUrl:j.iconFontUrl,extraCommonProps:{}}),Zn=()=>{const{fullScreen:t,setFullScreen:n}=s.useContext(W),a=()=>{H.success(t?"已退出全屏模式":"进入全屏模式"),n(!t)};return t?e(Ye,{title:"退出全屏模式",className:"action-icon",onClick:a}):e(We,{title:"进入全屏模式",className:"action-icon",onClick:a})},Xn=()=>e(L.Link,{className:"action-icon",target:"_blank",style:{color:"inherit"},href:"https://github.com/xstnet/react-admin-template",children:e(Tt,{})}),ea=[[2,1,"刚刚"],[60,1,"%d秒前"],[3600,60,"%d分钟前"],[86400,3600,"%d小时前"],[86400*30,3600*24,"%d天前"],[86400*30*12,3600*24*30,"%d月前"],[1/0,3600*24*30*12,"%d年前"]],ta=[[-60,1,"%d秒后"],[-3600,60,"%d分钟后"],[-86400,3600,"%d小时后"],[-(86400*30),3600*24,"%d天后"],[-(86400*30*12),3600*24*30,"%d月后"],[-1/0,3600*24*30*12,"%d年后"]],na=({time:t,...n})=>{const a=Math.floor(new Date().getTime()/1e3),r=Math.floor(new Date(t).getTime()/1e3),o=a-r;if(isNaN(r))return e(O,{children:"time"});const l=o<-1?ta:ea;let c="";for(const[d,m,h]of l)if(Math.abs(o)<Math.abs(d)){const i=Math.floor(Math.abs(o)/m);c=h.replace("%d",String(i));break}return e(ue,{title:t,children:e("span",{...n,children:c})})},aa=()=>e(ee,{size:"small",itemLayout:"horizontal",dataSource:[{title:"张三 评论了你",desc:"评论内容评论内容评论内容",createTime:"2023-04-06 15:39:00"},{title:"您有3个订单待支付",desc:"订单1,订单2,订单3",createTime:"2023-04-05 15:39:00"},{title:"张三 的请假申请需要您的审批",desc:"",createTime:"2023-04-01 12:08:00"},{title:"本周周报待填写",createTime:"2023-03-02 10:55:00",desc:"说明"}],renderItem:n=>e(ee.Item,{children:e(ee.Item.Meta,{avatar:e(Ie,{size:48,icon:e(Je,{})}),title:e("a",{href:"https://ant.design",children:n.title}),description:y("div",{children:[n.desc,n.desc&&e("br",{}),e(L.Text,{children:e(na,{style:{fontSize:12},time:n.createTime})})]})})})}),ra=()=>e(ee,{size:"small",itemLayout:"horizontal",dataSource:[{title:"您有一封新的邮件",type:"mail"},{title:"您有3个订单待支付",type:"payment"},{title:"张三 的请假申请需要您的审批",type:"workflow"},{title:"本周周报待填写",type:"common"}],renderItem:n=>e(ee.Item,{children:e(ee.Item.Meta,{avatar:e(E,{style:{fontSize:30},type:`icon-${n.type}`}),title:e("a",{href:"https://ant.design",children:n.title}),description:"3天前"})})}),oa=()=>y(O,{children:[e(Ge,{centered:!0,style:{width:300},defaultActiveKey:"notify",items:[{key:"notify",label:"通知(3)",children:e(ra,{})},{key:"message",label:"消息(4)",children:e(aa,{})}],onChange:void 0,tabBarExtraContent:e(S,{type:"link",style:{marginRight:10},children:"清空"})}),e(z,{style:{margin:"8px 0"}}),y($,{split:e(z,{type:"vertical"}),style:{width:"100%",justifyContent:"center",marginBottom:0},children:[e(S,{type:"link",children:"全部已读"}),e(S,{type:"link",children:"查看更多"})]})]}),sa=t=>e(Ce,{count:98,children:e(It,{arrow:!1,content:e(oa,{}),placement:"bottomRight",trigger:"click",children:e(E,{title:"通知提醒",type:"icon-notify",className:"action-icon"})})}),la=()=>e(E,{title:"搜索",type:"icon-search",className:"action-icon"}),ia=()=>{const{settings:{theme:t},setSetting:n}=s.useContext(K),a=()=>{n({followSystemTheme:!1,theme:t==="light"?"dark":"light"})};return t==="dark"?e(E,{onClick:a,title:"主题-深色模式",type:"icon-theme-dark",className:"action-icon"}):e(E,{onClick:a,title:"主题-明亮模式",type:"icon-theme-light",className:"action-icon"})};const ca=t=>{const n=["#1890ff","#722ed1","#eb2f96","#00b96b","#52c41a","#13c2c2","#1677ff","#f5222d","#fa8c16","#faad14"],{onChange:a,presetColors:r=n,defaultSelectedColor:o=""}=t,{value:l=o}=t,[c,d]=s.useState(l),m=h=>{d(h),a==null||a(h)};return e("div",{className:"theme-color-wrap",children:r.map(h=>e("div",{onClick:()=>m(h),className:"theme-color-item",style:{backgroundColor:h},title:h,children:c===h&&e(Mt,{className:"checked-icon"})},h))})},da=t=>{const{open:n,onClose:a=G}=t,{settings:r,setSetting:o}=s.useContext(K),[l]=k.useForm(),[c]=at(),d=s.useMemo(()=>({...r,theme:r.followSystemTheme?"followSystem":r.theme}),[r]),m=(h,i)=>{const v={...h},{theme:u,fixedMenu:f,fixedHeader:b}=v;u&&(console.log("themeee",u),v.followSystemTheme=!1,u==="followSystem"&&(v.followSystemTheme=!0,v.theme=c)),f&&(v.fixedHeader=!0),b===!1&&(v.fixedMenu=!1),o(v),console.log("chage",h,i)};return te(()=>{l==null||l.setFieldsValue(d)},[d]),e(wt,{title:"偏好设置",onClose:a,open:n,children:y(k,{name:"basic",labelCol:{span:5},wrapperCol:{span:19},initialValues:{...d},autoComplete:"off",onValuesChange:m,form:l,children:[e(k.Item,{label:"外观",name:"theme",children:y(_.Group,{buttonStyle:"solid",children:[y(_.Button,{value:"light",children:[e(E,{type:"icon-theme-light"})," 浅色"]}),y(_.Button,{value:"dark",children:[e(E,{type:"icon-theme-dark"})," 深色"]}),y(_.Button,{value:"followSystem",children:[e(E,{type:"icon-followSystem"})," 跟随系统"]})]})}),e(k.Item,{label:"紧凑模式",valuePropName:"checked",name:"compactMode",children:e(oe,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(k.Item,{label:"主题色",name:"primaryColor",children:e(ca,{defaultSelectedColor:r.primaryColor})}),e(z,{children:"布局"}),e(k.Item,{label:"多标签页",valuePropName:"checked",name:"multitabMode",children:e(oe,{checkedChildren:"启用",unCheckedChildren:"关闭"})}),e(k.Item,{label:"固定头部",valuePropName:"checked",name:"fixedHeader",children:e(oe,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(k.Item,{help:"固定菜单启用时, 头部也会同步固定",label:"固定菜单",valuePropName:"checked",name:"fixedMenu",children:e(oe,{checkedChildren:"开启",unCheckedChildren:"关闭"})}),e(k.Item,{valuePropName:"checked",label:"显示底部",name:"showFooter",children:e(oe,{checkedChildren:"开启",unCheckedChildren:"关闭"})})]})})},ua=t=>{const[n,a]=s.useState(!1);return y("div",{children:[e(da,{open:n,onClose:()=>{a(!1)}}),e(E,{onClick:()=>{a(!0)},title:"设置",type:"icon-setting",className:"action-icon"})]})},ma=()=>{const{userInfo:t,setUserInfo:n,setIsLogin:a}=s.useContext(W),{menuCollapsed:r,setMenuCollapsed:o}=s.useContext(q),{token:{colorBgContainer:l}}=Q.useToken(),c=Z(),d=()=>y("div",{className:"left",children:[y("div",{className:"logo",children:[e(E,{type:"icon-react",className:"logo-img"}),e("span",{className:"logo-text",children:"React Admin Template"})]}),e("div",{children:B.createElement(r?_t:Pt,{onClick:()=>o(!r)})})]}),m=()=>{const h=()=>y(O,{children:[e(la,{}),e(sa,{}),e(Zn,{}),e(Xn,{}),e(ia,{}),e(ua,{})]}),i=[{label:e("a",{children:"个人中心"}),icon:e(Je,{}),key:"userCenter"},{label:e("a",{children:"修改资料"}),key:"update",icon:e(Qe,{})},{type:"divider"},{label:"退出",icon:e(Nt,{}),key:"logout",onClick:()=>{In().then(()=>{D.removeToken(),a(!1),n(null),c("/login")})}}];return e("div",{className:"right",children:y($,{size:"middle",children:[h(),e(Lt,{menu:{items:i},children:y($,{className:"pointer",children:[e("span",{children:t==null?void 0:t.nickname}),e(Ie,{src:t==null?void 0:t.avatar})]})})]})})};return e(A.Header,{className:"header",style:{background:l},children:y(O,{children:[d(),m()]})})},dt=B.memo(ma),ha=()=>{const t=Z(),{pathname:n}=ae(),[a,r]=s.useState(),{menuList:o,mapPathToMenu:l}=s.useContext(q);let c="/dashboard",d=[],m=!1;const[h]=le();te(()=>{let u=l.get(n);if(!u){let f="";l.forEach(({path:b})=>{n.startsWith(b)&&b.length>f.length&&(f=b)}),f&&(u=l.get(f))}u&&(u!=null&&u.hideInMenu?r([u.parent]):r([n]))},[n]);const i=u=>{const f=l.get(u.key);if(console.log("clicked menu",u,f),!f){console.warn("未获取到菜单信息");return}if(f.path!==n){if((f==null?void 0:f.type)==="url"){window.open(f.path,"_blank");return}if(document.title=`${j.pageTitlePrefix} - ${f.label}`,(f==null?void 0:f.type)==="iframe"){console.log("打开iframe页面"),t(lt(f.path));return}t(f.path)}},v=s.useMemo(()=>{const u=b=>b.badge?b.badge==="dot"?e(Ce,{className:"menu-item-badge",offset:[6,0],dot:!0,children:b.label}):e(Ce,{className:"menu-item-badge",offset:[15,0],count:b.badge,children:b.label}):b.label,f=(b,T)=>{const p=[];return!m&&T&&d.push(T.key),b.map(g=>{if(ge(g)&&(g.parent&&n.indexOf(g.path)===0&&(console.log("ccccccccccccccccccccc",g.parent),c=g.parent,m=!0),g.type==="iframe"&&(h.get("url")||"")===g.path&&(m=!0,c=g.key),g.hideInMenu))return;let C;if(Dn(g))C={...g};else if(be(g))C={...g},g.children&&g.children.length>0&&(C.children=f(g.children));else if(pe(g)||st(g)){let{icon:x}=g;typeof x=="string"&&x.includes("icon-")&&(x=e(E,{type:x})),C={key:"",...g,icon:x,label:u(g),children:pe(g)?f(g.children,g):void 0},!m&&g.path===n&&(c=g.key,m=!0)}C&&(C.key=C.key,p.push(C))}),!m&&d.pop(),p};return f(o)},[o]);return e(At,{style:{height:"100%"},onClick:i,mode:"inline",defaultSelectedKeys:[c],selectedKeys:a,items:v,defaultOpenKeys:d})},pa=B.memo(ha);const ut=()=>{const{menuCollapsed:t}=s.useContext(q),{colorBgContainer:n}=ne();return e(A.Sider,{style:{background:n},trigger:null,className:"left-sider",collapsible:!0,collapsed:t,children:e(pa,{})})};const ga=()=>{console.log("MultitabLayout render...");const{menuCollapsed:t}=s.useContext(q);return e(zn,{children:y(A,{className:"multitab-layout","data-menu-collapsed":t?1:0,children:[e(dt,{}),y(A,{children:[e(ut,{}),y(A,{className:"content-layout",children:[e(Qn,{}),e(ct,{})]})]})]})})},fa=B.memo(ga);const ya=({children:t})=>e(A.Content,{className:"content",children:t}),ba=B.memo(ya);const va=()=>{console.log("SingleLaylut render...");const{menuCollapsed:t}=s.useContext(q);return y(A,{className:"single-tab-layout","data-menu-collapsed":t?1:0,children:[e(dt,{}),y(A,{children:[e(ut,{}),y(A,{className:"content-layout",children:[e(it,{}),e(ba,{children:e(Rt,{})}),e(ct,{})]})]})]})};const ka=()=>{const[t,n]=s.useState(!0),{setIsLogin:a,setUserInfo:r}=s.useContext(W),{colorBgContainer:o}=ne(),{settings:{multitabMode:l,fixedMenu:c,fixedHeader:d,theme:m}}=s.useContext(K),h=Z(),[i]=le();return console.log("global layout render..."),s.useEffect(()=>{if(!Ue()){h("/login");return}Tn().then(v=>{if(n(!1),a(!0),r(v),i.has("ghpage")){const u=decodeURIComponent(i.get("ghpage"));h(u);return}}).catch(v=>{v instanceof Ft&&qe.error({message:"网络错误",description:"获取用户信息失败, 无法打开页面",duration:null,closeIcon:null})})},[]),te(()=>{Ue()||(H.error("登录状态已失效, 即将跳转到登录页面..."),setTimeout(()=>{h("/login")},500))}),t?e(Le,{title:"页面加载中",loading:t}):e(Hn,{children:y("div",{"data-fixed-menu":c?1:0,"data-fixed-header":d?1:0,style:{background:o},className:`global-layout theme-${m}`,children:[l?e(fa,{}):e(va,{}),e($n,{})]})})},Ca=B.memo(ka),De=()=>e("span",{children:"UserCenterPage"}),xa=()=>e("span",{children:"UserCenterUpdatePage"});const mt=s.forwardRef(({state:t},n)=>{const[a]=k.useForm(),r=s.useRef(null);return s.useImperativeHandle(n,()=>({form:a,input:r.current}),[a,r]),e("div",{children:y(k,{form:a,labelCol:{span:3},name:"userForm",initialValues:t||void 0,children:[e(k.Item,{name:"username",label:"账号",rules:[{required:!0,message:"请输入账号"}],children:e(w,{placeholder:"请输入账号",ref:r})}),e(k.Item,{name:"password",label:"密码",rules:[{required:!t,message:"请输入密码"}],children:e(w.Password,{placeholder:t?"不修改密码请留空!":"请输入密码"})}),e(k.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入昵称"}],children:e(w,{placeholder:"请输入昵称"})}),e(k.Item,{name:"gender",label:"性别",children:y(_.Group,{children:[e(_,{value:1,children:"男"}),e(_,{value:2,children:"女"})]})}),e(k.Item,{name:"mobile",label:"手机号",children:e(w,{placeholder:"请输入手机号"})}),e(k.Item,{name:"email",label:"邮箱",children:e(w,{placeholder:"请输入邮箱"})})]})})}),Sa=({refreshList:t})=>{const[n,a]=s.useState(!1),{run:r,loading:o}=R(wn,{manual:!0,debounceWait:100,onSuccess:()=>{var d;a(!1),(d=l.current)==null||d.form.resetFields(),t==null||t()}}),l=s.useRef(null);return y("div",{children:[e(S,{type:"primary",icon:e(fe,{}),onClick:()=>{a(!0),setTimeout(()=>{var d,m;(m=(d=l.current)==null?void 0:d.input)==null||m.focus()},100)},children:"新增用户"}),e(Ze,{open:n,title:"添加用户",okText:"添加",cancelText:"取消",confirmLoading:o,onCancel:()=>a(!1),onOk:()=>{var d;(d=l.current)==null||d.form.validateFields().then(m=>{r(m)}).catch(m=>console.log(m))},children:e(mt,{ref:l})})]})},Ta=(t,n)=>{const a=Et(t,n),{tableProps:r}=a,o={...r.pagination,showTotal:(d,m)=>`第${m[0]}-${m[1]} 条/共 ${d} 条`,hideOnSinglePage:!0};r.pagination=o;const l=r.onChange,c=(...d)=>{var T;let[m,h,i,v]=d,u=m,f,b;Object.keys(i).length>0&&(Array.isArray(i)?(b={},i.map(p=>{var g;b[(g=p.column)==null?void 0:g.dataIndex]=p.order})):b={[(T=i.column)==null?void 0:T.dataIndex]:i.order}),Object.keys(h).length>0&&(f=h,console.log("filterrrrrrrrrrrrr",h)),l(u,f,b)};return r.onChange=c,a.tableProps.size="small",a},Ia=({state:t,refreshList:n})=>{const[a,r]=s.useState(!1),{runAsync:o,loading:l}=R(_n,{manual:!0,debounceWait:100}),c=s.useRef(null);return y(O,{children:[e(S,{icon:e(Qe,{}),size:"small",onClick:()=>{r(!0),setTimeout(()=>{var m,h;(h=(m=c.current)==null?void 0:m.input)==null||h.focus()},100)},children:"编辑"}),e(Ze,{open:a,title:"更新用户信息",okText:"保存",cancelText:"取消",confirmLoading:l,onCancel:()=>r(!1),onOk:()=>{var m;(m=c.current)==null||m.form.validateFields().then(h=>{o({...h,id:t.id}).then(()=>{var i;r(!1),(i=c.current)==null||i.form.resetFields(),n==null||n()}).catch(G)}).catch(h=>console.log(h))},children:e(mt,{ref:c,state:t})})]})};const J=t=>{const{children:n,className:a="",style:r={},...o}=t,{colorBgContainer:l}=ne(),c="content-box",d={backgroundColor:l};return e("div",{className:`${c} ${a}`,style:{...d,...r},...o,children:n})},Ma=t=>{const{search:n,form:a,onSearch:r,onReset:o,fields:l,title:c="搜索",...d}=t,m=s.useCallback((b,T,p)=>{switch(typeof T=="string"&&["input","number","select"].includes(b)&&(p.placeholder=(p==null?void 0:p.placeholder)||T),b){case"input":return e(w,{...p});case"number":return e(Ut,{...p});case"select":return e(we,{...p});case"radio":return e(_.Group,{...p});case"date":return e(Ne,{...p});case"dateRange":return e(Ne.RangePicker,{...p});case"checkbox":return e(Me.Group,{...p});case"cascader":return e($t,{...p});case"treeSelect":return e(ye,{...p});default:return e(O,{})}},[]),h=async()=>{await a.validateFields().catch(b=>console.warn(b)),r==null||r(a),n.submit()},i=()=>{o==null||o(a),n.reset()},v={labelCol:{span:5},style:{paddingTop:16}},u=({type:b,name:T,label:p,fieldProps:g={},itemProps:C={}})=>e(he,{span:6,children:e(k.Item,{name:T,label:p,...C,children:m(b,p,g)})},`${T}-${p}`),f=()=>{const b=n.type==="simple"?0:18-l.length%4*6;return y(he,{span:6,offset:b,style:{textAlign:"right"},children:[e(S,{onClick:i,children:"重置"}),e(S,{style:{margin:"0 8px"},type:"primary",onClick:h,children:"查询"}),l.length>3&&y("a",{style:{fontSize:12},onClick:n.changeType,children:[n.type==="advance"?e(Ot,{}):e(Dt,{}),n.type==="advance"?"收起":"展开"]})]})};return l.length===0?null:y(J,{children:[e("div",{children:e(L.Title,{level:5,children:c})}),e(k,{form:a,...v,...d,children:y(Xe,{gutter:24,children:[n.type==="advance"?l.map(u):l.slice(0,3).map(u),f()]})})]})},wa=()=>{var p;console.log("render ExampleUserListPage");const[t]=k.useForm(),[n,a]=s.useState([]),r=s.useRef();s.useEffect(()=>{r.current=new Map},[]);const{runAsync:o,loading:l}=R(Pn,{manual:!0,debounceWait:100}),{refresh:c,tableProps:d,search:m}=Ta(Mn,{form:t}),h=()=>{m.reset(),m.submit()},i=g=>{var C;typeof g=="number"&&((C=r==null?void 0:r.current)==null||C.set(g,!0)),o({id:g}).then(()=>{typeof g=="object"&&a([]),c()}).finally(()=>{var x;return typeof g=="number"&&((x=r==null?void 0:r.current)==null?void 0:x.delete(g))})},v=s.useMemo(()=>[{title:"ID",dataIndex:"id"},{title:"账号",dataIndex:"username",render:(g,{avatar:C,username:x})=>y(O,{children:[" ",e(Ie,{src:C})," ",x]})},{title:"昵称",dataIndex:"nickname"},{title:"性别",dataIndex:"gender",render:g=>g===rt.male?e(Ae,{color:"blue",children:"男"}):e(Ae,{color:"error",children:"女"})},{title:"邮箱",dataIndex:"email"},{title:"手机号",dataIndex:"mobile",sorter:!0},{title:"注册时间",dataIndex:"create_time",sorter:!0},{title:"操作",key:"operation",fixed:"right",render:(g,C)=>{var P;const{id:x}=C;return y($,{children:[e(Re,{title:"确认要删除这条数据吗?",onConfirm:()=>i(x),children:e(S,{loading:(P=r==null?void 0:r.current)==null?void 0:P.has(x),icon:e(Bt,{}),size:"small",danger:!0,children:"删除"})}),e(Ia,{state:C,refreshList:c})]})}}],[]),f={selectedRowKeys:n,onChange:g=>{console.log("selectedRowKeys changed: ",g),a(g)}},b=n.length>0;return y(O,{children:[e(Ma,{form:t,search:m,fields:[{type:"input",label:"账号",name:"username"},{type:"input",label:"手机号",name:"mobile"},{type:"input",label:"邮箱",name:"email"},{type:"select",label:"性别",name:"gender",fieldProps:{options:[{label:"男",value:"1"},{label:"女",value:"2"}]}}]}),e("br",{}),y(J,{children:[y("div",{className:"table-header",children:[e("div",{className:"left",children:e(L.Title,{level:5,children:"用户列表"})}),e("div",{className:"right",children:y($,{size:"middle",children:[e(Re,{title:`确定要删除这${n.length}条数据吗?`,onConfirm:()=>i(n),children:e(S,{type:"primary",danger:!0,disabled:!b,loading:l&&((p=r.current)==null?void 0:p.size)===0,children:"批量删除"})}),e(Sa,{refreshList:h}),e(S,{type:"link",title:"点击刷新",onClick:c,icon:e(Ht,{})})]})})]}),e(Vt,{rowKey:"id",rowSelection:f,columns:v,...d})]})]})},de=({title:t="空白页"})=>{const[n,a]=s.useState(0);return le(),console.log("BlankPage: 被调用"),s.useEffect(()=>(console.log("BlankPage: 初次渲染"),()=>{console.log("BlankPage: 被卸载了")}),[]),y(J,{style:{height:"500px"},children:[e(L.Title,{level:4,children:t}),y(L.Text,{children:["Count: ",n]}),e("br",{}),e(S,{onClick:r=>a(o=>o+1),children:"add"})]})},_a=()=>{const{pathname:t}=ae();return e(zt,{status:"404",title:"404",subTitle:`页面不存在, 当前路由: ${t}`,extra:e(S,{type:"primary",children:e(ke,{to:"/",children:"返回首页"})})})};const Pa=s.forwardRef((t,n)=>{const a="MdEditorDraft",r=s.useRef(null),o=s.useRef(),{height:l=600,value:c="",onChange:d=G,contentType:m="markdown"}=t,{settings:{theme:h}}=s.useContext(K);s.useImperativeHandle(n,()=>({editor:o.current,container:r.current||void 0,getMarkdown:()=>{var u;return((u=o.current)==null?void 0:u.getMarkdown())||""},getHTML:()=>{var u;return((u=o.current)==null?void 0:u.getHTML())||""},clearDraft:()=>{localStorage.removeItem(a)},setMarkdown:u=>{var f;(f=o.current)==null||f.setMarkdown(u)}}),[o.current,r.current]),te(()=>{console.log("is forucs",o.current.getSelection())},[c]);const i=()=>new jt({initialValue:c,height:`${l}px`,initialEditType:"markdown",previewStyle:"vertical",plugins:[qt],language:"zh-CN",previewHighlight:!0,frontMatter:!0,extendedAutolinks:!0,el:r.current,hideModeSwitch:!0,theme:h==="dark"?"dark":void 0}),v=bn(u=>{var T,p;const b=m==="markdown"?((T=o.current)==null?void 0:T.getMarkdown())||"":((p=o.current)==null?void 0:p.getHTML())||"";d(b,u)},500);return s.useEffect(()=>{var b;o.current=i(),o.current.addHook("addImageBlobHook",(T,p,g)=>{const C=document.getElementById("toastuiAltTextInput"),x=(C==null?void 0:C.value)||"image",P=new FileReader;P.onload=U=>{var re;const N=(re=U.target)==null?void 0:re.result;console.log("Base64 encoded string:",N),p(N,x)},P.readAsDataURL(T)}),o.current.eventEmitter.listen("change",v);let u=setInterval(()=>{if(!o.current)return;const T=o.current.getMarkdown();localStorage.setItem(a,T),console.log("已保存到草稿箱!")},15*1e3);const f=localStorage.getItem(a);return f&&((b=o.current)==null||b.setMarkdown(f),console.log("已从草稿箱加载数据!")),()=>{u&&clearInterval(u)}},[]),te(()=>{var f,b;const u=(f=o.current)==null?void 0:f.getMarkdown();(b=o.current)==null||b.destroy(),o.current=i(),o.current.setMarkdown(u||"")},[h]),te(()=>{var u;(u=o.current)==null||u.setMarkdown(c)},[c]),e("div",{style:{backgroundColor:"#fff"},ref:r})}),ht=B.memo(Pa,(t,n)=>{var a,r;return((a=t.value)==null?void 0:a.length)!==((r=n.value)==null?void 0:r.length)||t.value!==n.value}),La=()=>{const[t]=k.useForm(),n=s.useRef(null),a=Z(),r="articleDraft",{loading:o,run:l}=R(Nn,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{var i;(i=n.current)==null||i.clearDraft(),a("/article/list")},200)}),{data:c,loading:d}=R(Pe);s.useEffect(()=>{const i=D.getObject(r)||{},v={status:200,comment_control:[1,2],description:"",source:"",author:"醉丶春风",sort_value:100};t.setFieldsValue({...v,...i})},[]);const m=async(i=!1)=>{var u;const v=await t.validateFields();v.content=((u=n.current)==null?void 0:u.getHTML())||"",v.is_draft=i?1:0,console.log("formData",v),l(v)},h=i=>(console.log("Upload event:",i),Array.isArray(i)?i:i&&i.fileList);return y(J,{children:[e(L.Title,{level:3,children:"发布文章"}),e(z,{}),y(k,{form:t,name:"createForm",labelCol:{span:2},children:[e(k.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(w,{})}),e(k.Item,{label:"封面",name:"cover",getValueFromEvent:h,valuePropName:"fileList",children:e(et,{maxCount:1,listType:"picture-card",accept:"image/*",children:y("div",{children:[e(fe,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(k.Item,{label:"标签",name:"tags",children:e(we,{mode:"tags",placeholder:"文章标签",style:{width:400}})}),e(k.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(w,{style:{width:200}})}),e(k.Item,{label:"简介",name:"description",children:e(w.TextArea,{rows:3})}),e(k.Item,{label:"内容",name:"markdown_content",children:e(ht,{ref:n})}),e(k.Item,{name:"category_id",label:"分类",rules:[{required:!0,message:"请选择分类!"}],children:e(ye,{dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"请选择分类",fieldNames:{label:"name",value:"id"},allowClear:!0,treeDefaultExpandAll:!0,loading:d,treeData:c})}),e(k.Item,{name:"status",label:"状态",initialValue:200,children:y(_.Group,{children:[e(_,{value:200,children:"显示"}),e(_,{value:900,children:"不显示"})]})}),e(k.Item,{name:"comment_control",label:"评论控制",initialValue:[1,2],children:e(Me.Group,{options:[{label:"显示评论",value:1},{label:"允许评论",value:2}]})}),e(k.Item,{label:"来源",name:"source",children:e(w,{style:{width:200}})}),e(k.Item,{label:"排序",name:"sort_value",children:e(w,{style:{width:200}})}),e(k.Item,{wrapperCol:{offset:3},children:y($,{children:[e(S,{icon:e(tt,{}),onClick:()=>m(),loading:o,type:"primary",children:"发布文章"}),e(S,{icon:e(_e,{}),loading:o,onClick:()=>m(!0),children:"保存为草稿"})]})})]})]})},Na=()=>{const[t]=k.useForm(),n=s.useRef(null),a=Z(),r=Kt();console.log("routeParams",r);const{loading:o,run:l}=R(An,{manual:!0,debounceWait:200,onSuccess:()=>setTimeout(()=>{var u;(u=n.current)==null||u.clearDraft(),a("/article/list")},200)}),{data:c,loading:d}=R(()=>Ln({id:Number(r.id)}),{onSuccess:u=>{var C;const{content:f,comment_control:b,cover:T,...p}=u,g=[];[1,2].map(x=>b&x?g.push(x):void 0),p.markdown_content=f.markdown_content,t.setFieldsValue({...p,comment_control:g}),(C=n.current)==null||C.setMarkdown(f.markdown_content)}}),{data:m,loading:h}=R(Pe),i=async(u=!1)=>{var b;const f=await t.validateFields();f.content=((b=n.current)==null?void 0:b.getHTML())||"",f.is_draft=u?1:0,f.id=c.id,console.log("formData",f),l(f)},v=u=>(console.log("Upload event:",u),Array.isArray(u)?u:u&&u.fileList);return y(J,{children:[e(L.Title,{level:3,children:"发布文章"}),e(z,{}),y(k,{form:t,name:"createForm",labelCol:{span:2},children:[e(k.Item,{name:"title",label:"文章标题",rules:[{required:!0,message:"请输入标题"}],children:e(w,{})}),e(k.Item,{label:"封面",name:"cover",getValueFromEvent:v,valuePropName:"fileList",children:e(et,{maxCount:1,listType:"picture-card",accept:"image/*",children:y("div",{children:[e(fe,{}),e("div",{style:{marginTop:8},children:"选择图片"})]})})}),e(k.Item,{label:"标签",name:"tags",children:e(we,{mode:"tags",placeholder:"文章标签",style:{width:400}})}),e(k.Item,{label:"作者",name:"author",rules:[{required:!0,message:"请输入作者"}],children:e(w,{style:{width:200}})}),e(k.Item,{label:"简介",name:"description",children:e(w.TextArea,{rows:3})}),e(k.Item,{label:"内容",name:"markdown_content",children:e(ht,{ref:n})}),e(k.Item,{name:"category_id",label:"分类",rules:[{required:!0,message:"请选择分类!"}],children:e(ye,{dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"请选择分类",fieldNames:{label:"name",value:"id"},allowClear:!0,treeDefaultExpandAll:!0,loading:h,treeData:m})}),e(k.Item,{name:"status",label:"状态",initialValue:200,children:y(_.Group,{children:[e(_,{value:200,children:"显示"}),e(_,{value:900,children:"不显示"})]})}),e(k.Item,{name:"comment_control",label:"评论控制",initialValue:[1,2],children:e(Me.Group,{options:[{label:"显示评论",value:1},{label:"允许评论",value:2}]})}),e(k.Item,{label:"来源",name:"source",children:e(w,{style:{width:200}})}),e(k.Item,{label:"排序",name:"sort_value",children:e(w,{style:{width:200}})}),e(k.Item,{wrapperCol:{offset:3},children:y($,{children:[e(S,{icon:e(tt,{}),onClick:()=>i(),loading:o,type:"primary",children:"更新"}),e(S,{icon:e(_e,{}),loading:o,onClick:()=>i(!0),children:"保存为草稿"})]})})]})]})},Aa=()=>{const{data:t,loading:n,refresh:a}=R(Pe),[r]=k.useForm(),[o,l]=s.useState(),{loading:c,run:d}=R(Rn,{manual:!0,onSuccess:()=>a()}),{loading:m,run:h}=R(Fn,{manual:!0,onSuccess:()=>a()}),i=(f,b)=>{const T=b.node;l(T),r.setFieldsValue(T)},v=async()=>{const f=await r.validateFields();d(f)},u=async()=>{const f=await r.validateFields();h({...f,id:o.id})};return y(J,{children:[e(L.Title,{level:3,children:"分类管理"}),e(z,{}),e(je,{spinning:n,tip:"正在加载分类数据, 请稍后...",children:y(Xe,{gutter:24,children:[e(he,{span:8,children:e(Gt,{blockNode:!0,defaultExpandAll:!0,onSelect:i,fieldNames:{title:"name",key:"id",children:"children"},treeData:t})}),e(he,{span:16,children:y(k,{name:"categoryForm",form:r,labelCol:{span:4},initialValues:{sort_value:100},children:[e(k.Item,{label:"所属分类",name:"parent_id",rules:[{required:!0,message:"清选择所属分类"}],children:e(ye,{fieldNames:{label:"name",value:"id"},treeData:[{name:"一级分类",id:0},...t||[]],dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"请选择所属分类",allowClear:!0})}),e(k.Item,{label:"分类名称",name:"name",rules:[{required:!0,message:"请输入分类名称"}],children:e(w,{style:{width:200},placeholder:"请输入分类名称"})}),e(k.Item,{label:"排序",name:"sort_value",children:e(w,{type:"number",style:{width:200}})}),e(k.Item,{name:"status",label:"状态",initialValue:200,children:y(_.Group,{children:[e(_,{value:200,children:"显示"}),e(_,{value:900,children:"不显示"})]})}),e(k.Item,{wrapperCol:{offset:3},children:y($,{children:[e(S,{icon:e(_e,{}),disabled:o===void 0,onClick:u,loading:m,type:"primary",children:"保存修改"}),e(S,{icon:e(fe,{}),loading:c,onClick:v,children:"添加为新分类"})]})})]})})]})})]})},Ra=()=>{const{userInfo:t,setUserInfo:n}=s.useContext(W),a=r=>{n({...t,roles:[r]})};return y(J,{children:[y(L.Text,{children:["当前权限: ",JSON.stringify(t==null?void 0:t.roles)]}),e(z,{}),y(S.Group,{children:[e(S,{type:"primary",onClick:()=>a("admin"),children:"切换为 Admin"}),e(S,{onClick:()=>a("guest"),children:"切换为 Guest"})]})]})},Be=({children:t,role:n})=>{const{userInfo:a}=s.useContext(W);return ot(n,a)?e(O,{children:t}):null},Fa=()=>{const{userInfo:t,setUserInfo:n}=s.useContext(W),a=r=>{n({...t,roles:[r]})};return y(J,{children:[y(L.Text,{children:["当前权限: ",JSON.stringify(t==null?void 0:t.roles)]}),e(z,{}),y(S.Group,{children:[e(S,{type:"primary",onClick:()=>a("admin"),children:"切换为 Admin"}),e(S,{onClick:()=>a("guest"),children:"切换为 Guest"})]}),e(z,{}),y($,{children:[e(Be,{role:"admin",children:e(S,{type:"primary",children:"Admin menu"})}),e(Be,{role:"guest",children:e(S,{children:"Guest menu"})})]})]})},Ea=s.lazy(()=>ie(()=>import("./index-0c265803.js"),["assets/index-0c265803.js","assets/vendor-f85b10b9.js","assets/vendor-79dc8b22.css"])),He=s.lazy(()=>ie(()=>import("./index-a1409f2e.js"),["assets/index-a1409f2e.js","assets/vendor-f85b10b9.js","assets/vendor-79dc8b22.css"])),$a=s.lazy(()=>ie(()=>import("./index-731cbbaa.js"),["assets/index-731cbbaa.js","assets/vendor-f85b10b9.js","assets/vendor-79dc8b22.css","assets/index-5c0cb4e1.css"])),Ua=s.lazy(()=>ie(()=>import("./index-6ce982c0.js"),["assets/index-6ce982c0.js","assets/vendor-f85b10b9.js","assets/vendor-79dc8b22.css","assets/index-19ead691.css"])),Oa=s.lazy(()=>ie(()=>import("./index-0003da04.js"),["assets/index-0003da04.js","assets/vendor-f85b10b9.js","assets/vendor-79dc8b22.css","assets/index-c11d3a46.css"])),X=({children:t})=>e(B.Suspense,{fallback:e(Le,{}),children:t});function Da(){return[{path:"/login",element:e(X,{children:e($a,{})})},{path:"/",element:e(Ca,{}),children:[{path:"/",element:e(fn,{to:"/dashboard"})},{path:"/dashboard",element:e(X,{children:e(Ua,{})})},{path:"/user",children:[{index:!0,element:e(De,{})},{path:"/user/center/index",element:e(De,{})},{path:"/user/center/update",element:e(xa,{})}]},{path:"/example",children:[{path:"/example/userList",element:e(wa,{})},{path:"/example/tabs/manage",element:e(X,{children:e(Ea,{})})},{path:"/example/permission",children:[{path:"/example/permission/menu",element:e(Ra,{})},{path:"/example/permission/button",element:e(Fa,{})}]}]},{path:"/article",children:[{index:!0,element:e(X,{children:e(He,{})})},{path:"/article/list",element:e(X,{children:e(He,{})})},{path:"/article/category",element:e(Aa,{})},{path:"/article/create",element:e(La,{})},{path:"/article/update/:id",element:e(Na,{})}]},{path:"/blank",element:e(de,{})},{path:"/badge/dot",element:e(de,{title:"红点徽标"})},{path:"/badge/count",element:e(de,{title:"数字徽标"})},{path:V,element:e(X,{children:e(Oa,{})})},{path:"/multilevel/menu/2/3",element:e(de,{title:"三级菜单"})},{path:"*",element:e(_a,{})}]}]}const Ba=Yt(Da(),{basename:"/react-admin-template/"});function Ha(){return s.useEffect(()=>{},[]),e(hn,{children:e(Wt,{router:Ba})})}function Ve(t){const n=JSON.stringify({type:"JWT",alg:"HS256"}),a=Number((new Date().getTime()/1e3).toFixed(0)),r=JSON.stringify({iss:"github.com/xstnet",sub:"react-admin",iat:a,exp:a+86400*14,data:t}),o="H_97UyQUOmURnZdDwI0khuAt4Cmg";return`${Fe(n)}.${Fe(r)}.${o}`}I.mock(/api\/login/,"post",({body:t})=>{const{username:n,password:a}=JSON.parse(t);return n==="admin"?a!=="123456"?{code:-1,message:"密码错误"}:{code:0,message:"登录成功",data:{token:Ve({uid:1})}}:{code:0,message:"登录成功",data:{token:Ve({uid:F.Random.natural(2,1e4)})}}});I.setup({timeout:100});I.mock(/api\/user\/info/,"get",t=>({code:0,message:"ok",data:{id:1,username:"admin",nickname:"醉丶春风",avatar:"https://www.xstnet.com/static/images/head.gif",password:"",gender:F.Random.natural(1,2),email:"shantongxu@qq.com",mobile:"133xxxx3333",roles:["admin"]}}));I.mock(/api\/user\/logout/,"post",t=>({code:0,message:"退出成功"}));I.mock(/api\/user\/list/,"get",t=>{const n=new URLSearchParams(t.url);let a=Number(n.has("pageSize")?n.get("pageSize"):10);const r={code:0,message:"ok",data:{total:100,[`list|${a}`]:[{"id|+1":a,username:"@first@last",nickname:"@cname",avatar:()=>F.Random.dataImage("200x200"),email:"@email",mobile:()=>I.mock(/^1[3456789]\d{9}$/).replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"),"gender|1-2":0,create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return I.mock(r)});I.mock(/api\/user\/create/,"post",t=>({code:0,message:"创建成功",data:{id:F.Random.natural(100,9999)}}));I.mock(/api\/user\/update/,"post",t=>({code:0,message:"更新成功"}));I.mock(/api\/user\/delete/,"post",t=>({code:0,message:"删除成功"}));I.setup({timeout:100});I.mock(/api\/article\/detail/,"get",t=>(console.log("🚀 ~ file: article.ts:7 ~ Mock.mock ~ options:",t),{code:0,message:"ok",data:{id:1,title:"主题",description:"醉丶春风",author:"醉丶春风",tags:[1,2],content:{markdown_content:`# 内容标题\r
 正文`},sort_value:100,comment_control:3,create_time:F.Random.datetime()}}));I.mock(/api\/article\/list/,"get",t=>{const n=new URLSearchParams(t.url);let a=Number(n.has("pageSize")?n.get("pageSize"):10);const r={code:0,message:"ok",data:{total:100,[`list|${a}`]:[{"id|+1":a,author:"@first@last",title:()=>I.Random.ctitle(5,20),description:"@cname",cover:()=>F.Random.dataImage("480x270","封面"),content:"@email",create_time:"@date(yyyy-MM-dd HH:MM:ss)"}]}};return I.mock(r)});I.mock(/api\/article\/create/,"post",t=>({code:0,message:"创建成功",data:{id:F.Random.natural(100,9999)}}));I.mock(/api\/article\/update/,"post",t=>({code:0,message:"更新成功"}));I.mock(/api\/article\/delete/,"post",t=>({code:0,message:"删除成功"}));I.setup({timeout:100});I.mock(/api\/todo\/list/,"get",t=>{const n={code:0,message:"",data:{total:3,list:[{id:$e(100,1e9),name:"全局搜索",status:se.incomplete,create_time:"2023-04-20",update_time:"2023-04-20"},{id:$e(100,1e9),name:"多tab布局支持",status:se.completed,create_time:"2023-04-15",update_time:"2023-04-215"},{id:1,name:"这是一个todo例子",status:se.completed,create_time:"2023-04-10",update_time:"2023-04-10"}]}};return I.mock(n)});I.mock(/api\/todo\/create/,"post",t=>{const n=JSON.parse(t.body);return{code:0,message:"",data:{id:F.Random.natural(100,9999),name:n.name,status:se.incomplete,create_time:F.Random.now(),update_time:F.Random.now()}}});I.mock(/api\/todo\/update/,t=>({code:0,message:""}));I.mock(/api\/todo\/changeStatus/,"post",t=>({code:0,message:""}));I.mock(/api\/todo\/delete/,"post",t=>({code:0,message:""}));I.setup({timeout:100});I.mock(/api\/category\/treeList/,"get",t=>(console.log("🚀 ~ file: article.ts:7 ~ Mock.mock ~ options:",t),{code:0,message:"ok",data:[{id:82,name:"PHP",parent_id:0,sort_value:10,status:10,children:[{id:79,name:"Yii2.0",parent_id:82,sort_value:11,status:10},{id:95,name:"Yii1.1",parent_id:82,sort_value:12,status:10},{id:93,name:"函数",parent_id:82,sort_value:15,status:10}]},{id:84,name:"数据库",parent_id:0,sort_value:20,status:10,children:[{id:85,name:"mysql",parent_id:84,sort_value:21,status:10},{id:92,name:"redis",parent_id:84,sort_value:22,status:10}]},{id:86,name:"Linux",parent_id:0,sort_value:30,status:10},{id:81,name:"Javascript",parent_id:0,sort_value:40,status:10},{id:91,name:"Golang笔记",parent_id:0,sort_value:45,status:10},{id:100,name:"C语言",parent_id:0,sort_value:46,status:10},{id:94,name:"数据结构与算法",parent_id:0,sort_value:47,status:10,children:[{id:99,name:"算法",parent_id:94,sort_value:45,status:10},{id:96,name:"链表",parent_id:94,sort_value:47,status:10},{id:97,name:"hash",parent_id:94,sort_value:48,status:10},{id:98,name:"二叉树",parent_id:94,sort_value:49,status:10}]},{id:101,name:"正则表达式",parent_id:0,sort_value:48,status:10},{id:80,name:"资源分享",parent_id:0,sort_value:50,status:10,children:[{id:89,name:"软件教程",parent_id:80,sort_value:52,status:10},{id:90,name:"文章分享",parent_id:80,sort_value:53,status:10}]},{id:88,name:"其他",parent_id:0,sort_value:60,status:10}]}));I.mock(/api\/category\/create/,"post",t=>({code:0,message:"创建分类成功",data:{id:F.Random.natural(100,9999)}}));I.mock(/api\/category\/update/,"post",t=>({code:0,message:"更新分类成功"}));Jt.createRoot(document.getElementById("root")).render(e(Ha,{}));export{J as C,yn as D,O as F,ve as M,na as R,K as S,se as T,e as a,Ma as b,j as c,D as d,za as e,Ja as f,ja as g,ne as h,Ga as i,y as j,Wa as k,Ya as l,Ka as m,G as n,q as o,qa as p,$e as r,Ta as u,Ue as v};
